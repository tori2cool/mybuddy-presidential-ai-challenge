2026-01-18 04:26:31 | INFO     | uvicorn.error | Started server process [50064]
2026-01-18 04:26:31 | INFO     | uvicorn.error | Waiting for application startup.
2026-01-18 04:26:31 | INFO     | sqlalchemy.engine.Engine | select pg_catalog.version()
2026-01-18 04:26:31 | INFO     | sqlalchemy.engine.Engine | [raw sql] ()
2026-01-18 04:26:31 | INFO     | sqlalchemy.engine.Engine | select current_schema()
2026-01-18 04:26:31 | INFO     | sqlalchemy.engine.Engine | [raw sql] ()
2026-01-18 04:26:31 | INFO     | sqlalchemy.engine.Engine | show standard_conforming_strings
2026-01-18 04:26:31 | INFO     | sqlalchemy.engine.Engine | [raw sql] ()
2026-01-18 04:26:31 | INFO     | sqlalchemy.engine.Engine | BEGIN (implicit)
2026-01-18 04:26:31 | INFO     | sqlalchemy.engine.Engine | SELECT 1 FROM pg_extension WHERE extname='pgcrypto'
2026-01-18 04:26:31 | INFO     | sqlalchemy.engine.Engine | [generated in 0.00028s] ()
2026-01-18 04:26:31 | INFO     | sqlalchemy.engine.Engine | COMMIT
2026-01-18 04:26:31 | INFO     | sqlalchemy.engine.Engine | BEGIN (implicit)
2026-01-18 04:26:31 | INFO     | sqlalchemy.engine.Engine | SELECT gen_random_uuid();
2026-01-18 04:26:31 | INFO     | sqlalchemy.engine.Engine | [generated in 0.00024s] ()
2026-01-18 04:26:31 | INFO     | sqlalchemy.engine.Engine | COMMIT
2026-01-18 04:26:31 | INFO     | sqlalchemy.engine.Engine | BEGIN (implicit)
2026-01-18 04:26:31 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code, subjects.name 
FROM subjects ORDER BY subjects.name
2026-01-18 04:26:31 | INFO     | sqlalchemy.engine.Engine | [generated in 0.00037s] ()
2026-01-18 04:26:31 | INFO     | sqlalchemy.engine.Engine | SELECT age_ranges.code, age_ranges.name, age_ranges.min_age, age_ranges.max_age 
FROM age_ranges ORDER BY age_ranges.min_age
2026-01-18 04:26:31 | INFO     | sqlalchemy.engine.Engine | [generated in 0.00028s] ()
2026-01-18 04:26:31 | INFO     | sqlalchemy.engine.Engine | COMMIT
2026-01-18 04:26:31 | INFO     | sqlalchemy.engine.Engine | BEGIN (implicit)
2026-01-18 04:26:31 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code, subjects.name, age_ranges.code AS code_1, age_ranges.name AS name_1, age_ranges.min_age, age_ranges.max_age 
FROM subject_age_ranges JOIN subjects ON subjects.id = subject_age_ranges.subject_id JOIN age_ranges ON age_ranges.id = subject_age_ranges.age_range_id
2026-01-18 04:26:31 | INFO     | sqlalchemy.engine.Engine | [generated in 0.00027s] ()
2026-01-18 04:26:31 | INFO     | sqlalchemy.engine.Engine | COMMIT
2026-01-18 04:26:31 | INFO     | app.services.ai_flashcard_generator | [AI Flashcard Generator] configured: api_key_set=True api_base_set=True model=gpt-5.2
2026-01-18 04:26:31 | INFO     | app.flashcard_seed | Seed out_path selected: subject_code=history path=/home/sukitfup/mybuddy/backend/app/seed_data/flashcards/history.json exists=True
2026-01-18 04:26:31 | INFO     | app.flashcard_seed | Loaded existing seed JSON: subject_code=history rows=20 age_range_counts={'Early Elementary': 5, 'High School': 5, 'Middle School': 5, 'Upper Elementary': 5}
2026-01-18 04:26:31 | INFO     | app.flashcard_seed | Seed skip: History/Early Elementary difficulty=easy existing=5 generated=0 final=5
2026-01-18 04:26:31 | INFO     | app.flashcard_seed | Seed out_path selected: subject_code=history path=/home/sukitfup/mybuddy/backend/app/seed_data/flashcards/history.json exists=True
2026-01-18 04:26:31 | INFO     | app.flashcard_seed | Loaded existing seed JSON: subject_code=history rows=20 age_range_counts={'Early Elementary': 5, 'High School': 5, 'Middle School': 5, 'Upper Elementary': 5}
2026-01-18 04:26:31 | INFO     | app.flashcard_seed | Seed skip: History/Upper Elementary difficulty=easy existing=5 generated=0 final=5
2026-01-18 04:26:31 | INFO     | app.flashcard_seed | Seed out_path selected: subject_code=history path=/home/sukitfup/mybuddy/backend/app/seed_data/flashcards/history.json exists=True
2026-01-18 04:26:31 | INFO     | app.flashcard_seed | Loaded existing seed JSON: subject_code=history rows=20 age_range_counts={'Early Elementary': 5, 'High School': 5, 'Middle School': 5, 'Upper Elementary': 5}
2026-01-18 04:26:31 | INFO     | app.flashcard_seed | Seed skip: History/Middle School difficulty=easy existing=5 generated=0 final=5
2026-01-18 04:26:31 | INFO     | app.flashcard_seed | Seed out_path selected: subject_code=history path=/home/sukitfup/mybuddy/backend/app/seed_data/flashcards/history.json exists=True
2026-01-18 04:26:31 | INFO     | app.flashcard_seed | Loaded existing seed JSON: subject_code=history rows=20 age_range_counts={'Early Elementary': 5, 'High School': 5, 'Middle School': 5, 'Upper Elementary': 5}
2026-01-18 04:26:31 | INFO     | app.flashcard_seed | Seed skip: History/High School difficulty=easy existing=5 generated=0 final=5
2026-01-18 04:26:31 | INFO     | app.flashcard_seed | Seed out_path selected: subject_code=math path=/home/sukitfup/mybuddy/backend/app/seed_data/flashcards/math.json exists=True
2026-01-18 04:26:31 | INFO     | app.flashcard_seed | Loaded existing seed JSON: subject_code=math rows=25 age_range_counts={'Early Elementary': 5, 'High School': 5, 'Middle School': 5, 'Preschool': 5, 'Upper Elementary': 5}
2026-01-18 04:26:31 | INFO     | app.flashcard_seed | Seed skip: Math/Preschool difficulty=easy existing=5 generated=0 final=5
2026-01-18 04:26:31 | INFO     | app.flashcard_seed | Seed out_path selected: subject_code=math path=/home/sukitfup/mybuddy/backend/app/seed_data/flashcards/math.json exists=True
2026-01-18 04:26:31 | INFO     | app.flashcard_seed | Loaded existing seed JSON: subject_code=math rows=25 age_range_counts={'Early Elementary': 5, 'High School': 5, 'Middle School': 5, 'Preschool': 5, 'Upper Elementary': 5}
2026-01-18 04:26:31 | INFO     | app.flashcard_seed | Seed skip: Math/Early Elementary difficulty=easy existing=5 generated=0 final=5
2026-01-18 04:26:31 | INFO     | app.flashcard_seed | Seed out_path selected: subject_code=math path=/home/sukitfup/mybuddy/backend/app/seed_data/flashcards/math.json exists=True
2026-01-18 04:26:31 | INFO     | app.flashcard_seed | Loaded existing seed JSON: subject_code=math rows=25 age_range_counts={'Early Elementary': 5, 'High School': 5, 'Middle School': 5, 'Preschool': 5, 'Upper Elementary': 5}
2026-01-18 04:26:31 | INFO     | app.flashcard_seed | Seed skip: Math/Upper Elementary difficulty=easy existing=5 generated=0 final=5
2026-01-18 04:26:31 | INFO     | app.flashcard_seed | Seed out_path selected: subject_code=math path=/home/sukitfup/mybuddy/backend/app/seed_data/flashcards/math.json exists=True
2026-01-18 04:26:31 | INFO     | app.flashcard_seed | Loaded existing seed JSON: subject_code=math rows=25 age_range_counts={'Early Elementary': 5, 'High School': 5, 'Middle School': 5, 'Preschool': 5, 'Upper Elementary': 5}
2026-01-18 04:26:31 | INFO     | app.flashcard_seed | Seed skip: Math/Middle School difficulty=easy existing=5 generated=0 final=5
2026-01-18 04:26:31 | INFO     | app.flashcard_seed | Seed out_path selected: subject_code=math path=/home/sukitfup/mybuddy/backend/app/seed_data/flashcards/math.json exists=True
2026-01-18 04:26:31 | INFO     | app.flashcard_seed | Loaded existing seed JSON: subject_code=math rows=25 age_range_counts={'Early Elementary': 5, 'High School': 5, 'Middle School': 5, 'Preschool': 5, 'Upper Elementary': 5}
2026-01-18 04:26:31 | INFO     | app.flashcard_seed | Seed skip: Math/High School difficulty=easy existing=5 generated=0 final=5
2026-01-18 04:26:31 | INFO     | app.flashcard_seed | Seed out_path selected: subject_code=reading path=/home/sukitfup/mybuddy/backend/app/seed_data/flashcards/reading.json exists=True
2026-01-18 04:26:31 | INFO     | app.flashcard_seed | Loaded existing seed JSON: subject_code=reading rows=20 age_range_counts={'Early Elementary': 5, 'High School': 5, 'Middle School': 5, 'Upper Elementary': 5}
2026-01-18 04:26:31 | INFO     | app.flashcard_seed | Seed skip: Reading/Early Elementary difficulty=easy existing=5 generated=0 final=5
2026-01-18 04:26:31 | INFO     | app.flashcard_seed | Seed out_path selected: subject_code=reading path=/home/sukitfup/mybuddy/backend/app/seed_data/flashcards/reading.json exists=True
2026-01-18 04:26:31 | INFO     | app.flashcard_seed | Loaded existing seed JSON: subject_code=reading rows=20 age_range_counts={'Early Elementary': 5, 'High School': 5, 'Middle School': 5, 'Upper Elementary': 5}
2026-01-18 04:26:31 | INFO     | app.flashcard_seed | Seed skip: Reading/Upper Elementary difficulty=easy existing=5 generated=0 final=5
2026-01-18 04:26:31 | INFO     | app.flashcard_seed | Seed out_path selected: subject_code=reading path=/home/sukitfup/mybuddy/backend/app/seed_data/flashcards/reading.json exists=True
2026-01-18 04:26:31 | INFO     | app.flashcard_seed | Loaded existing seed JSON: subject_code=reading rows=20 age_range_counts={'Early Elementary': 5, 'High School': 5, 'Middle School': 5, 'Upper Elementary': 5}
2026-01-18 04:26:31 | INFO     | app.flashcard_seed | Seed skip: Reading/Middle School difficulty=easy existing=5 generated=0 final=5
2026-01-18 04:26:31 | INFO     | app.flashcard_seed | Seed out_path selected: subject_code=reading path=/home/sukitfup/mybuddy/backend/app/seed_data/flashcards/reading.json exists=True
2026-01-18 04:26:31 | INFO     | app.flashcard_seed | Loaded existing seed JSON: subject_code=reading rows=20 age_range_counts={'Early Elementary': 5, 'High School': 5, 'Middle School': 5, 'Upper Elementary': 5}
2026-01-18 04:26:31 | INFO     | app.flashcard_seed | Seed skip: Reading/High School difficulty=easy existing=5 generated=0 final=5
2026-01-18 04:26:31 | INFO     | app.flashcard_seed | Seed out_path selected: subject_code=science path=/home/sukitfup/mybuddy/backend/app/seed_data/flashcards/science.json exists=True
2026-01-18 04:26:31 | INFO     | app.flashcard_seed | Loaded existing seed JSON: subject_code=science rows=25 age_range_counts={'Early Elementary': 5, 'High School': 5, 'Middle School': 5, 'Preschool': 5, 'Upper Elementary': 5}
2026-01-18 04:26:31 | INFO     | app.flashcard_seed | Seed skip: Science/Preschool difficulty=easy existing=5 generated=0 final=5
2026-01-18 04:26:31 | INFO     | app.flashcard_seed | Seed out_path selected: subject_code=science path=/home/sukitfup/mybuddy/backend/app/seed_data/flashcards/science.json exists=True
2026-01-18 04:26:31 | INFO     | app.flashcard_seed | Loaded existing seed JSON: subject_code=science rows=25 age_range_counts={'Early Elementary': 5, 'High School': 5, 'Middle School': 5, 'Preschool': 5, 'Upper Elementary': 5}
2026-01-18 04:26:31 | INFO     | app.flashcard_seed | Seed skip: Science/Early Elementary difficulty=easy existing=5 generated=0 final=5
2026-01-18 04:26:31 | INFO     | app.flashcard_seed | Seed out_path selected: subject_code=science path=/home/sukitfup/mybuddy/backend/app/seed_data/flashcards/science.json exists=True
2026-01-18 04:26:31 | INFO     | app.flashcard_seed | Loaded existing seed JSON: subject_code=science rows=25 age_range_counts={'Early Elementary': 5, 'High School': 5, 'Middle School': 5, 'Preschool': 5, 'Upper Elementary': 5}
2026-01-18 04:26:31 | INFO     | app.flashcard_seed | Seed skip: Science/Upper Elementary difficulty=easy existing=5 generated=0 final=5
2026-01-18 04:26:31 | INFO     | app.flashcard_seed | Seed out_path selected: subject_code=science path=/home/sukitfup/mybuddy/backend/app/seed_data/flashcards/science.json exists=True
2026-01-18 04:26:31 | INFO     | app.flashcard_seed | Loaded existing seed JSON: subject_code=science rows=25 age_range_counts={'Early Elementary': 5, 'High School': 5, 'Middle School': 5, 'Preschool': 5, 'Upper Elementary': 5}
2026-01-18 04:26:31 | INFO     | app.flashcard_seed | Seed skip: Science/Middle School difficulty=easy existing=5 generated=0 final=5
2026-01-18 04:26:31 | INFO     | app.flashcard_seed | Seed out_path selected: subject_code=science path=/home/sukitfup/mybuddy/backend/app/seed_data/flashcards/science.json exists=True
2026-01-18 04:26:31 | INFO     | app.flashcard_seed | Loaded existing seed JSON: subject_code=science rows=25 age_range_counts={'Early Elementary': 5, 'High School': 5, 'Middle School': 5, 'Preschool': 5, 'Upper Elementary': 5}
2026-01-18 04:26:31 | INFO     | app.flashcard_seed | Seed skip: Science/High School difficulty=easy existing=5 generated=0 final=5
2026-01-18 04:26:31 | INFO     | app.flashcard_seed | generate_all_easy_flashcards: all 18 workers completed successfully
2026-01-18 04:26:31 | INFO     | app.flashcard_seed | No seed files to write (nothing generated; results_by_subject_code empty).
2026-01-18 04:26:31 | INFO     | app.flashcard_seed | Done. Seed files updated under: /home/sukitfup/mybuddy/backend/app/seed_data/flashcards
2026-01-18 04:26:31 | INFO     | sqlalchemy.engine.Engine | BEGIN (implicit)
2026-01-18 04:26:31 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.name, subjects.id 
FROM subjects
2026-01-18 04:26:31 | INFO     | sqlalchemy.engine.Engine | [generated in 0.00029s] ()
2026-01-18 04:26:31 | INFO     | sqlalchemy.engine.Engine | SELECT age_ranges.name, age_ranges.id 
FROM age_ranges
2026-01-18 04:26:31 | INFO     | sqlalchemy.engine.Engine | [generated in 0.00024s] ()
2026-01-18 04:26:31 | INFO     | sqlalchemy.engine.Engine | INSERT INTO flashcards (subject_id, question, choices, explanations, correct_index, difficulty_code, tags, age_range_id) VALUES ($1::UUID, $2::VARCHAR, $3::JSONB, $4::JSONB, $5::INTEGER, $6::VARCHAR, $7::JSONB, $8::UUID), ($9::UUID, $10::VARCHAR, $11::JSONB, $12::JSONB, $13::INTEGER, $14::VARCHAR, $15::JSONB, $16::UUID), ($17::UUID, $18::VARCHAR, $19::JSONB, $20::JSONB, $21::INTEGER, $22::VARCHAR, $23::JSONB, $24::UUID), ($25::UUID, $26::VARCHAR, $27::JSONB, $28::JSONB, $29::INTEGER, $30::VARCHAR, $31::JSONB, $32::UUID), ($33::UUID, $34::VARCHAR, $35::JSONB, $36::JSONB, $37::INTEGER, $38::VARCHAR, $39::JSONB, $40::UUID), ($41::UUID, $42::VARCHAR, $43::JSONB, $44::JSONB, $45::INTEGER, $46::VARCHAR, $47::JSONB, $48::UUID), ($49::UUID, $50::VARCHAR, $51::JSONB, $52::JSONB, $53::INTEGER, $54::VARCHAR, $55::JSONB, $56::UUID), ($57::UUID, $58::VARCHAR, $59::JSONB, $60::JSONB, $61::INTEGER, $62::VARCHAR, $63::JSONB, $64::UUID), ($65::UUID, $66::VARCHAR, $67::JSONB, $68::JSONB, $69::INTEGER, $70::VARCHAR, $71::JSONB, $72::UUID), ($73::UUID, $74::VARCHAR, $75::JSONB, $76::JSONB, $77::INTEGER, $78::VARCHAR, $79::JSONB, $80::UUID), ($81::UUID, $82::VARCHAR, $83::JSONB, $84::JSONB, $85::INTEGER, $86::VARCHAR, $87::JSONB, $88::UUID), ($89::UUID, $90::VARCHAR, $91::JSONB, $92::JSONB, $93::INTEGER, $94::VARCHAR, $95::JSONB, $96::UUID), ($97::UUID, $98::VARCHAR, $99::JSONB, $100::JSONB, $101::INTEGER, $102::VARCHAR, $103::JSONB, $104::UUID), ($105::UUID, $106::VARCHAR, $107::JSONB, $108::JSONB, $109::INTEGER, $110::VARCHAR, $111::JSONB, $112::UUID), ($113::UUID, $114::VARCHAR, $115::JSONB, $116::JSONB, $117::INTEGER, $118::VARCHAR, $119::JSONB, $120::UUID), ($121::UUID, $122::VARCHAR, $123::JSONB, $124::JSONB, $125::INTEGER, $126::VARCHAR, $127::JSONB, $128::UUID), ($129::UUID, $130::VARCHAR, $131::JSONB, $132::JSONB, $133::INTEGER, $134::VARCHAR, $135::JSONB, $136::UUID), ($137::UUID, $138::VARCHAR, $139::JSONB, $140::JSONB, $141::INTEGER, $142::VARCHAR, $143::JSONB, $144::UUID), ($145::UUID, $146::VARCHAR, $147::JSONB, $148::JSONB, $149::INTEGER, $150::VARCHAR, $151::JSONB, $152::UUID), ($153::UUID, $154::VARCHAR, $155::JSONB, $156::JSONB, $157::INTEGER, $158::VARCHAR, $159::JSONB, $160::UUID), ($161::UUID, $162::VARCHAR, $163::JSONB, $164::JSONB, $165::INTEGER, $166::VARCHAR, $167::JSONB, $168::UUID), ($169::UUID, $170::VARCHAR, $171::JSONB, $172::JSONB, $173::INTEGER, $174::VARCHAR, $175::JSONB, $176::UUID), ($177::UUID, $178::VARCHAR, $179::JSONB, $180::JSONB, $181::INTEGER, $182::VARCHAR, $183::JSONB, $184::UUID), ($185::UUID, $186::VARCHAR, $187::JSONB, $188::JSONB, $189::INTEGER, $190::VARCHAR, $191::JSONB, $192::UUID), ($193::UUID, $194::VARCHAR, $195::JSONB, $196::JSONB, $197::INTEGER, $198::VARCHAR, $199::JSONB, $200::UUID), ($201::UUID, $202::VARCHAR, $203::JSONB, $204::JSONB, $205::INTEGER, $206::VARCHAR, $207::JSONB, $208::UUID), ($209::UUID, $210::VARCHAR, $211::JSONB, $212::JSONB, $213::INTEGER, $214::VARCHAR, $215::JSONB, $216::UUID), ($217::UUID, $218::VARCHAR, $219::JSONB, $220::JSONB, $221::INTEGER, $222::VARCHAR, $223::JSONB, $224::UUID), ($225::UUID, $226::VARCHAR, $227::JSONB, $228::JSONB, $229::INTEGER, $230::VARCHAR, $231::JSONB, $232::UUID), ($233::UUID, $234::VARCHAR, $235::JSONB, $236::JSONB, $237::INTEGER, $238::VARCHAR, $239::JSONB, $240::UUID), ($241::UUID, $242::VARCHAR, $243::JSONB, $244::JSONB, $245::INTEGER, $246::VARCHAR, $247::JSONB, $248::UUID), ($249::UUID, $250::VARCHAR, $251::JSONB, $252::JSONB, $253::INTEGER, $254::VARCHAR, $255::JSONB, $256::UUID), ($257::UUID, $258::VARCHAR, $259::JSONB, $260::JSONB, $261::INTEGER, $262::VARCHAR, $263::JSONB, $264::UUID), ($265::UUID, $266::VARCHAR, $267::JSONB, $268::JSONB, $269::INTEGER, $270::VARCHAR, $271::JSONB, $272::UUID), ($273::UUID, $274::VARCHAR, $275::JSONB, $276::JSONB, $277::INTEGER, $278::VARCHAR, $279::JSONB, $280::UUID), ($281::UUID, $282::VARCHAR, $283::JSONB, $284::JSONB, $285::INTEGER, $286::VARCHAR, $287::JSONB, $288::UUID), ($289::UUID, $290::VARCHAR, $291::JSONB, $292::JSONB, $293::INTEGER, $294::VARCHAR, $295::JSONB, $296::UUID), ($297::UUID, $298::VARCHAR, $299::JSONB, $300::JSONB, $301::INTEGER, $302::VARCHAR, $303::JSONB, $304::UUID), ($305::UUID, $306::VARCHAR, $307::JSONB, $308::JSONB, $309::INTEGER, $310::VARCHAR, $311::JSONB, $312::UUID), ($313::UUID, $314::VARCHAR, $315::JSONB, $316::JSONB, $317::INTEGER, $318::VARCHAR, $319::JSONB, $320::UUID), ($321::UUID, $322::VARCHAR, $323::JSONB, $324::JSONB, $325::INTEGER, $326::VARCHAR, $327::JSONB, $328::UUID), ($329::UUID, $330::VARCHAR, $331::JSONB, $332::JSONB, $333::INTEGER, $334::VARCHAR, $335::JSONB, $336::UUID), ($337::UUID, $338::VARCHAR, $339::JSONB, $340::JSONB, $341::INTEGER, $342::VARCHAR, $343::JSONB, $344::UUID), ($345::UUID, $346::VARCHAR, $347::JSONB, $348::JSONB, $349::INTEGER, $350::VARCHAR, $351::JSONB, $352::UUID), ($353::UUID, $354::VARCHAR, $355::JSONB, $356::JSONB, $357::INTEGER, $358::VARCHAR, $359::JSONB, $360::UUID), ($361::UUID, $362::VARCHAR, $363::JSONB, $364::JSONB, $365::INTEGER, $366::VARCHAR, $367::JSONB, $368::UUID), ($369::UUID, $370::VARCHAR, $371::JSONB, $372::JSONB, $373::INTEGER, $374::VARCHAR, $375::JSONB, $376::UUID), ($377::UUID, $378::VARCHAR, $379::JSONB, $380::JSONB, $381::INTEGER, $382::VARCHAR, $383::JSONB, $384::UUID), ($385::UUID, $386::VARCHAR, $387::JSONB, $388::JSONB, $389::INTEGER, $390::VARCHAR, $391::JSONB, $392::UUID), ($393::UUID, $394::VARCHAR, $395::JSONB, $396::JSONB, $397::INTEGER, $398::VARCHAR, $399::JSONB, $400::UUID), ($401::UUID, $402::VARCHAR, $403::JSONB, $404::JSONB, $405::INTEGER, $406::VARCHAR, $407::JSONB, $408::UUID), ($409::UUID, $410::VARCHAR, $411::JSONB, $412::JSONB, $413::INTEGER, $414::VARCHAR, $415::JSONB, $416::UUID), ($417::UUID, $418::VARCHAR, $419::JSONB, $420::JSONB, $421::INTEGER, $422::VARCHAR, $423::JSONB, $424::UUID), ($425::UUID, $426::VARCHAR, $427::JSONB, $428::JSONB, $429::INTEGER, $430::VARCHAR, $431::JSONB, $432::UUID), ($433::UUID, $434::VARCHAR, $435::JSONB, $436::JSONB, $437::INTEGER, $438::VARCHAR, $439::JSONB, $440::UUID), ($441::UUID, $442::VARCHAR, $443::JSONB, $444::JSONB, $445::INTEGER, $446::VARCHAR, $447::JSONB, $448::UUID), ($449::UUID, $450::VARCHAR, $451::JSONB, $452::JSONB, $453::INTEGER, $454::VARCHAR, $455::JSONB, $456::UUID), ($457::UUID, $458::VARCHAR, $459::JSONB, $460::JSONB, $461::INTEGER, $462::VARCHAR, $463::JSONB, $464::UUID), ($465::UUID, $466::VARCHAR, $467::JSONB, $468::JSONB, $469::INTEGER, $470::VARCHAR, $471::JSONB, $472::UUID), ($473::UUID, $474::VARCHAR, $475::JSONB, $476::JSONB, $477::INTEGER, $478::VARCHAR, $479::JSONB, $480::UUID), ($481::UUID, $482::VARCHAR, $483::JSONB, $484::JSONB, $485::INTEGER, $486::VARCHAR, $487::JSONB, $488::UUID), ($489::UUID, $490::VARCHAR, $491::JSONB, $492::JSONB, $493::INTEGER, $494::VARCHAR, $495::JSONB, $496::UUID), ($497::UUID, $498::VARCHAR, $499::JSONB, $500::JSONB, $501::INTEGER, $502::VARCHAR, $503::JSONB, $504::UUID), ($505::UUID, $506::VARCHAR, $507::JSONB, $508::JSONB, $509::INTEGER, $510::VARCHAR, $511::JSONB, $512::UUID), ($513::UUID, $514::VARCHAR, $515::JSONB, $516::JSONB, $517::INTEGER, $518::VARCHAR, $519::JSONB, $520::UUID), ($521::UUID, $522::VARCHAR, $523::JSONB, $524::JSONB, $525::INTEGER, $526::VARCHAR, $527::JSONB, $528::UUID), ($529::UUID, $530::VARCHAR, $531::JSONB, $532::JSONB, $533::INTEGER, $534::VARCHAR, $535::JSONB, $536::UUID), ($537::UUID, $538::VARCHAR, $539::JSONB, $540::JSONB, $541::INTEGER, $542::VARCHAR, $543::JSONB, $544::UUID), ($545::UUID, $546::VARCHAR, $547::JSONB, $548::JSONB, $549::INTEGER, $550::VARCHAR, $551::JSONB, $552::UUID), ($553::UUID, $554::VARCHAR, $555::JSONB, $556::JSONB, $557::INTEGER, $558::VARCHAR, $559::JSONB, $560::UUID), ($561::UUID, $562::VARCHAR, $563::JSONB, $564::JSONB, $565::INTEGER, $566::VARCHAR, $567::JSONB, $568::UUID), ($569::UUID, $570::VARCHAR, $571::JSONB, $572::JSONB, $573::INTEGER, $574::VARCHAR, $575::JSONB, $576::UUID), ($577::UUID, $578::VARCHAR, $579::JSONB, $580::JSONB, $581::INTEGER, $582::VARCHAR, $583::JSONB, $584::UUID), ($585::UUID, $586::VARCHAR, $587::JSONB, $588::JSONB, $589::INTEGER, $590::VARCHAR, $591::JSONB, $592::UUID), ($593::UUID, $594::VARCHAR, $595::JSONB, $596::JSONB, $597::INTEGER, $598::VARCHAR, $599::JSONB, $600::UUID), ($601::UUID, $602::VARCHAR, $603::JSONB, $604::JSONB, $605::INTEGER, $606::VARCHAR, $607::JSONB, $608::UUID), ($609::UUID, $610::VARCHAR, $611::JSONB, $612::JSONB, $613::INTEGER, $614::VARCHAR, $615::JSONB, $616::UUID), ($617::UUID, $618::VARCHAR, $619::JSONB, $620::JSONB, $621::INTEGER, $622::VARCHAR, $623::JSONB, $624::UUID), ($625::UUID, $626::VARCHAR, $627::JSONB, $628::JSONB, $629::INTEGER, $630::VARCHAR, $631::JSONB, $632::UUID), ($633::UUID, $634::VARCHAR, $635::JSONB, $636::JSONB, $637::INTEGER, $638::VARCHAR, $639::JSONB, $640::UUID), ($641::UUID, $642::VARCHAR, $643::JSONB, $644::JSONB, $645::INTEGER, $646::VARCHAR, $647::JSONB, $648::UUID), ($649::UUID, $650::VARCHAR, $651::JSONB, $652::JSONB, $653::INTEGER, $654::VARCHAR, $655::JSONB, $656::UUID), ($657::UUID, $658::VARCHAR, $659::JSONB, $660::JSONB, $661::INTEGER, $662::VARCHAR, $663::JSONB, $664::UUID), ($665::UUID, $666::VARCHAR, $667::JSONB, $668::JSONB, $669::INTEGER, $670::VARCHAR, $671::JSONB, $672::UUID), ($673::UUID, $674::VARCHAR, $675::JSONB, $676::JSONB, $677::INTEGER, $678::VARCHAR, $679::JSONB, $680::UUID), ($681::UUID, $682::VARCHAR, $683::JSONB, $684::JSONB, $685::INTEGER, $686::VARCHAR, $687::JSONB, $688::UUID), ($689::UUID, $690::VARCHAR, $691::JSONB, $692::JSONB, $693::INTEGER, $694::VARCHAR, $695::JSONB, $696::UUID), ($697::UUID, $698::VARCHAR, $699::JSONB, $700::JSONB, $701::INTEGER, $702::VARCHAR, $703::JSONB, $704::UUID), ($705::UUID, $706::VARCHAR, $707::JSONB, $708::JSONB, $709::INTEGER, $710::VARCHAR, $711::JSONB, $712::UUID), ($713::UUID, $714::VARCHAR, $715::JSONB, $716::JSONB, $717::INTEGER, $718::VARCHAR, $719::JSONB, $720::UUID) ON CONFLICT (subject_id, question, difficulty_code, age_range_id) DO NOTHING
2026-01-18 04:26:31 | INFO     | sqlalchemy.engine.Engine | [no key 0.00447s] (UUID('76685f75-86ff-43b0-9d9c-e8a2a5ff8f49'), 'Long ago, people did not have cars. How did many people travel instead?', '["By submarine", "On horseback", "By airplane", "By rocket"]', '["Submarines travel underwater, not on land.", "Correct! People often traveled on horseback long ago.", "Airplanes did not exist yet.", "Rockets are used for space travel, not everyday travel."]', 1, 'easy', '["daily_life"]', UUID('8cbe2db5-8cec-4738-923f-571c5ce61de8'), UUID('76685f75-86ff-43b0-9d9c-e8a2a5ff8f49'), 'Why did many ancient civilizations build cities near rivers?', '["Rivers stopped all enemies", "Rivers provided water and fertile land", "Rivers kept cities hidden", "Rivers were fun places to swim"]', '["Rivers alone could not stop enemies.", "Correct! Rivers gave fresh water and helped crops grow.", "Rivers did not hide cities.", "Swimming was not the main reason cities formed."]', 1, 'easy', '["ancient_civilizations"]', UUID('1aea8d41-8a9a-4631-a8d7-b8ef59d74bfc'), UUID('76685f75-86ff-43b0-9d9c-e8a2a5ff8f49'), 'What was feudalism during the Middle Ages?', '["A type of medieval religion", "A system where land was exchanged for loyalty and service", "A method of long-distance trade", "A system of voting for kings"]', '["Feudalism was a social system, not a religion.", "Correct! Feudalism was based on land, loyalty, and service.", "Trade existed, but feudalism was about land and power.", "Kings were not elected through voting."]', 1, 'easy', '["government", "middle_ages"]', UUID('58b3d542-7c37-417b-b71e-aa3bae481682'), UUID('76685f75-86ff-43b0-9d9c-e8a2a5ff8f49'), 'What is the main purpose of the Bill of Rights?', '["To explain how presidents are elected", "To list all U.S. states", "To protect individual freedoms from government power", "To describe how laws are enforced"]', '["Elections are explained elsewhere in the Constitution.", "States are not listed in the Bill of Rights.", "Correct! The Bill of Rights protects individual freedoms.", "Law enforcement is not its main focus."]', 2, 'easy', '["government", "us_history"]', UUID('3e389a51-8a7c-47a1-a50d-ef16d158e47f'), UUID('76685f75-86ff-43b0-9d9c-e8a2a5ff8f49'), 'What does Independence Day celebrate?', '["The first U.S. president was elected", "The U.S. declared independence in 1776", "The Constitution was written", "The Civil War ended"]', '["That event happened later and is not what July 4 celebrates.", "Correct: July 4 marks when the colonies said they were free from Great Britain.", "The Constitution was written in 1787, and it has its own history.", "The Civil War ended in 1865, not on Independence Day."]', 1, 'easy', '["national_holidays_history_meaning"]', UUID('8cbe2db5-8cec-4738-923f-571c5ce61de8'), UUID('76685f75-86ff-43b0-9d9c-e8a2a5ff8f49'), 'Which holiday honors people who served in the military?', '["Presidents Day", "Independence Day", "Veterans Day", "Memorial Day"]', '["Presidents Day is used to honor U.S. presidents.", "Independence Day celebrates the U.S. declaring independence.", "Correct: Veterans Day thanks people who served in the U.S. military.", "Memorial Day remembers soldiers who died while serving."]', 2, 'easy', '["national_holidays_history_meaning"]', UUID('8cbe2db5-8cec-4738-923f-571c5ce61de8'), UUID('76685f75-86ff-43b0-9d9c-e8a2a5ff8f49'), 'Which is an example of transportation used long ago?' ... 620 parameters truncated ... '["electromagnetic_spectrum_order"]', UUID('3e389a51-8a7c-47a1-a50d-ef16d158e47f'), UUID('3689795f-21cf-48d5-83db-11a01bbf2bb5'), 'Which particle has a positive charge and is found in the nucleus?', '["Electron", "Neutron", "Photon", "Proton"]', '["Electrons are negatively charged and found outside the nucleus.", "Neutrons are in the nucleus but have no charge.", "Photons are light particles, not parts of an atom\\u2019s nucleus.", "Protons are positively charged and located in the nucleus."]', 3, 'easy', '["atom_structure_protons_neutrons_electrons"]', UUID('3e389a51-8a7c-47a1-a50d-ef16d158e47f'), UUID('3689795f-21cf-48d5-83db-11a01bbf2bb5'), 'In a closed container, the total mass before and after a chemical reaction is how changed?', '["It becomes zero", "It always decreases", "It stays the same", "It always increases"]', '["Mass does not vanish during a reaction; matter remains present.", "Mass doesn\\u2019t decrease in a closed container because no matter escapes.", " ... (30 characters truncated) ... rearranged but not created or destroyed, so mass is conserved.", "Mass doesn\\u2019t increase in a closed container because no extra matter enters."]', 2, 'easy', '["conservation_of_mass_chemical_reactions"]', UUID('3e389a51-8a7c-47a1-a50d-ef16d158e47f'), UUID('3689795f-21cf-48d5-83db-11a01bbf2bb5'), 'Which tool measures temperature?', '["Barometer", "Thermometer", "Rain gauge", "Wind vane"]', '["A barometer measures air pressure, not temperature.", "A thermometer measures temperature, how hot or cold something is.", "A rain gauge measures how much rain falls, not temperature.", "A wind vane shows wind direction, not temperature."]', 1, 'easy', '["simple_weather_instruments"]', UUID('1aea8d41-8a9a-4631-a8d7-b8ef59d74bfc'), UUID('3689795f-21cf-48d5-83db-11a01bbf2bb5'), 'A seesaw is an example of a what simple machine?', '["Wedge", "Lever", "Pulley", "Screw"]', '["A wedge is used to split or cut, like an axe blade.", "A lever is a bar that pivots on a fulcrum, like a seesaw.", "A pulley uses a wheel and rope to lift, not a seesaw.", "A screw is an inclined plane wrapped around, like a jar lid thread."]', 1, 'easy', '["simple_machines_lever"]', UUID('1aea8d41-8a9a-4631-a8d7-b8ef59d74bfc'), UUID('3689795f-21cf-48d5-83db-11a01bbf2bb5'), 'Which sequence lists Earthâ€™s layers from outside to inside?', '["Crust, outer core, mantle, inner core", "Crust, mantle, outer core, inner core", "Outer core, inner core, mantle, crust", "Mantle, crust, inner core, outer core"]', '["The mantle is between crust and core, so it cannot be after outer core.", "Earth goes from crust to mantle, then outer core, then inner core.", "The crust is the outermost layer, so it cannot be listed last.", "The crust is the outside layer, so it cannot come after the mantle."]', 1, 'easy', '["earth_layers_crust_mantle_core"]', UUID('1aea8d41-8a9a-4631-a8d7-b8ef59d74bfc'), UUID('3689795f-21cf-48d5-83db-11a01bbf2bb5'), 'Breathing in brings which gas into the lungs?', '["Helium", "Carbon dioxide", "Oxygen", "Smoke"]', '["Helium is not needed for breathing and is not in most air.", "Carbon dioxide is a waste gas the body breathes out more of.", "Oxygen is the gas your body needs to help get energy from food.", "Smoke is not a gas your body needs and can harm lungs."]', 2, 'easy', '["human_body_respiratory_system_basic"]', UUID('1aea8d41-8a9a-4631-a8d7-b8ef59d74bfc'))
2026-01-18 04:26:31 | INFO     | app.flashcard_seed | Flashcards: attempted 90 inserts (ON CONFLICT DO NOTHING).
2026-01-18 04:26:31 | INFO     | sqlalchemy.engine.Engine | COMMIT
2026-01-18 04:26:31 | INFO     | uvicorn.error | Application startup complete.
2026-01-18 04:29:51 | WARNING  | mybuddy.api | Request potential issue
2026-01-18 04:29:51 | INFO     | uvicorn.access | 10.3.6.1:0 - "POST /v1/children/767166ac-39ef-4412-b0f5-72998235b319/events/flashcard HTTP/1.1" 401
2026-01-18 04:29:51 | INFO     | sqlalchemy.engine.Engine | BEGIN (implicit)
2026-01-18 04:29:51 | INFO     | sqlalchemy.engine.Engine | SELECT children.created_at, children.updated_at, children.id, children.owner_sub, children.name, children.birthday, children.interests, children.avatar_id 
FROM children 
WHERE children.id = $1::UUID AND children.owner_sub = $2::VARCHAR
2026-01-18 04:29:51 | INFO     | sqlalchemy.engine.Engine | [generated in 0.00082s] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), '3a26e22b-005d-4dc6-ac5f-bc66f95d8748')
2026-01-18 04:29:51 | INFO     | mybuddy.api | event_flashcard: start child_id=767166ac-39ef-4412-b0f5-72998235b319 flashcardId=7e1ab5ed-80f5-4625-9a08-7327a3868184 correct=True
2026-01-18 04:29:51 | INFO     | sqlalchemy.engine.Engine | SELECT points_values.id, points_values.code, points_values.name, points_values.points, points_values.is_active 
FROM points_values 
WHERE points_values.is_active = true
2026-01-18 04:29:51 | INFO     | sqlalchemy.engine.Engine | [generated in 0.00063s] ()
2026-01-18 04:29:51 | INFO     | sqlalchemy.engine.Engine | SELECT flashcards.id, flashcards.subject_id, flashcards.question, flashcards.choices, flashcards.explanations, flashcards.correct_index, flashcards.difficulty_code, flashcards.tags, flashcards.age_range_id 
FROM flashcards 
WHERE flashcards.id = $1::UUID
2026-01-18 04:29:51 | INFO     | sqlalchemy.engine.Engine | [generated in 0.00065s] (UUID('7e1ab5ed-80f5-4625-9a08-7327a3868184'),)
2026-01-18 04:29:51 | INFO     | mybuddy.api | event_flashcard: validated child_id=767166ac-39ef-4412-b0f5-72998235b319 flashcardId=7e1ab5ed-80f5-4625-9a08-7327a3868184 subject_id=73c23c39-1a46-4a0a-9f0d-6b8f44a61635 points=10
2026-01-18 04:29:51 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.id, subjects.code, subjects.name, subjects.icon, subjects.color 
FROM subjects 
WHERE subjects.id = $1::UUID
2026-01-18 04:29:51 | INFO     | sqlalchemy.engine.Engine | [generated in 0.00059s] (UUID('73c23c39-1a46-4a0a-9f0d-6b8f44a61635'),)
2026-01-18 04:29:51 | INFO     | sqlalchemy.engine.Engine | SAVEPOINT sa_savepoint_1
2026-01-18 04:29:51 | INFO     | sqlalchemy.engine.Engine | [no key 0.00054s] ()
2026-01-18 04:29:51 | INFO     | sqlalchemy.engine.Engine | INSERT INTO child_activity_events (child_id, kind, subject_id, flashcard_id, chore_id, outdoor_activity_id, affirmation_id, points, correct, answer, meta) VALUES ($1::UUID, $2::VARCHAR, $3::UUID, $4::UUID, $5::UUID, $6::UUID, $7::UUID, $8::INTEGER, $9::BOOLEAN, $10::VARCHAR, $11::JSONB) RETURNING child_activity_events.id, child_activity_events.created_at
2026-01-18 04:29:51 | INFO     | sqlalchemy.engine.Engine | [generated in 0.00094s] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), 'flashcard', UUID('73c23c39-1a46-4a0a-9f0d-6b8f44a61635'), UUID('7e1ab5ed-80f5-4625-9a08-7327a3868184'), None, None, None, 10, True, '450', '{"dedupeKey": "flashcard:7e1ab5ed-80f5-4625-9a08-7327a3868184", "flashcardId": "7e1ab5ed-80f5-4625-9a08-7327a3868184", "subjectId": "73c23c39-1a46-4a0a-9f0d-6b8f44a61635", "correct": true, "answer": "450", "points": 10}')
2026-01-18 04:29:52 | INFO     | sqlalchemy.engine.Engine | RELEASE SAVEPOINT sa_savepoint_1
2026-01-18 04:29:52 | INFO     | sqlalchemy.engine.Engine | [no key 0.00064s] ()
2026-01-18 04:29:52 | INFO     | mybuddy.api | event_flashcard: inserted_event child_id=767166ac-39ef-4412-b0f5-72998235b319
2026-01-18 04:29:52 | INFO     | sqlalchemy.engine.Engine | SELECT difficulty_thresholds.id, difficulty_thresholds.code, difficulty_thresholds.name, difficulty_thresholds.label, difficulty_thresholds.icon, difficulty_thresholds.color, difficulty_thresholds.threshold, difficulty_thresholds.is_active 
FROM difficulty_thresholds 
WHERE difficulty_thresholds.is_active = true
2026-01-18 04:29:52 | INFO     | sqlalchemy.engine.Engine | [generated in 0.00062s] ()
2026-01-18 04:29:52 | INFO     | sqlalchemy.engine.Engine | SELECT child_subject_difficulty.child_id, child_subject_difficulty.subject_id, child_subject_difficulty.difficulty_code, child_subject_difficulty.last_updated 
FROM child_subject_difficulty 
WHERE child_subject_difficulty.child_id = $1::UUID AND child_subject_difficulty.subject_id = $2::UUID
2026-01-18 04:29:52 | INFO     | sqlalchemy.engine.Engine | [generated in 0.00067s] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), UUID('73c23c39-1a46-4a0a-9f0d-6b8f44a61635'))
2026-01-18 04:29:52 | INFO     | sqlalchemy.engine.Engine | SELECT child_subject_streaks.child_id, child_subject_streaks.subject_id, child_subject_streaks.current_streak, child_subject_streaks.longest_streak, child_subject_streaks.last_updated 
FROM child_subject_streaks 
WHERE child_subject_streaks.child_id = $1::UUID AND child_subject_streaks.subject_id = $2::UUID
2026-01-18 04:29:52 | INFO     | sqlalchemy.engine.Engine | [generated in 0.00065s] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), UUID('73c23c39-1a46-4a0a-9f0d-6b8f44a61635'))
2026-01-18 04:29:52 | INFO     | sqlalchemy.engine.Engine | UPDATE child_subject_streaks SET current_streak=$1::INTEGER, last_updated=$2::TIMESTAMP WITH TIME ZONE WHERE child_subject_streaks.child_id = $3::UUID AND child_subject_streaks.subject_id = $4::UUID
2026-01-18 04:29:52 | INFO     | sqlalchemy.engine.Engine | [generated in 0.00068s] (1, datetime.datetime(2026, 1, 18, 4, 29, 52, 43617, tzinfo=datetime.timezone.utc), UUID('767166ac-39ef-4412-b0f5-72998235b319'), UUID('73c23c39-1a46-4a0a-9f0d-6b8f44a61635'))
2026-01-18 04:29:52 | INFO     | sqlalchemy.engine.Engine | SELECT child_balanced_progress_counters.id, child_balanced_progress_counters.child_id, child_balanced_progress_counters.subject_code, child_balanced_progress_counters.correct_count, child_balanced_progress_counters.updated_at 
FROM child_balanced_progress_counters 
WHERE child_balanced_progress_counters.child_id = $1::UUID AND child_balanced_progress_counters.subject_code = $2::VARCHAR
2026-01-18 04:29:52 | INFO     | sqlalchemy.engine.Engine | [generated in 0.00075s] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), 'math')
2026-01-18 04:29:52 | INFO     | sqlalchemy.engine.Engine | UPDATE child_balanced_progress_counters SET correct_count=$1::INTEGER, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE child_balanced_progress_counters.id = $3::UUID
2026-01-18 04:29:52 | INFO     | sqlalchemy.engine.Engine | [generated in 0.00066s] (15, datetime.datetime(2026, 1, 18, 4, 29, 52, 65539, tzinfo=datetime.timezone.utc), UUID('4cdd2f9d-ec9b-4704-8505-26aabc45a383'))
2026-01-18 04:29:52 | INFO     | sqlalchemy.engine.Engine | SELECT child_flashcard_performance.created_at, child_flashcard_performance.updated_at, child_flashcard_performance.child_id, child_flashcard_performance.flashcard_id, child_flashcard_performance.correct_count, child_flashcard_performance.incorrect_count, child_flashcard_performance.last_seen_at 
FROM child_flashcard_performance 
WHERE child_flashcard_performance.child_id = $1::UUID AND child_flashcard_performance.flashcard_id = $2::UUID
2026-01-18 04:29:52 | INFO     | sqlalchemy.engine.Engine | [generated in 0.00062s] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), UUID('7e1ab5ed-80f5-4625-9a08-7327a3868184'))
2026-01-18 04:29:52 | INFO     | mybuddy.api | event_flashcard: create_perf child_id=767166ac-39ef-4412-b0f5-72998235b319 flashcardId=7e1ab5ed-80f5-4625-9a08-7327a3868184 correct=True
2026-01-18 04:29:52 | INFO     | sqlalchemy.engine.Engine | INSERT INTO child_flashcard_performance (child_id, flashcard_id, correct_count, incorrect_count, last_seen_at) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::INTEGER, $5::TIMESTAMP WITH TIME ZONE) RETURNING child_flashcard_performance.created_at, child_flashcard_performance.updated_at
2026-01-18 04:29:52 | INFO     | sqlalchemy.engine.Engine | [generated in 0.00064s] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), UUID('7e1ab5ed-80f5-4625-9a08-7327a3868184'), 1, 0, datetime.datetime(2026, 1, 18, 4, 29, 52, 83654, tzinfo=datetime.timezone.utc))
2026-01-18 04:29:52 | INFO     | sqlalchemy.engine.Engine | SELECT children.created_at, children.updated_at, children.id, children.owner_sub, children.name, children.birthday, children.interests, children.avatar_id 
FROM children 
WHERE children.id = $1::UUID
2026-01-18 04:29:52 | INFO     | sqlalchemy.engine.Engine | [generated in 0.00064s] (UUID('767166ac-39ef-4412-b0f5-72998235b319'),)
2026-01-18 04:29:52 | INFO     | sqlalchemy.engine.Engine | SELECT age_ranges.id, age_ranges.code, age_ranges.name, age_ranges.min_age, age_ranges.max_age, age_ranges.is_active 
FROM age_ranges 
WHERE age_ranges.min_age <= $1::INTEGER AND (age_ranges.max_age IS NULL OR age_ranges.max_age >= $2::INTEGER) AND age_ranges.is_active = true
2026-01-18 04:29:52 | INFO     | sqlalchemy.engine.Engine | [generated in 0.00060s] (8, 8)
2026-01-18 04:29:52 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code 
FROM subjects JOIN subject_age_ranges ON subjects.id = subject_age_ranges.subject_id 
WHERE subject_age_ranges.age_range_id = $1::UUID ORDER BY subjects.code
2026-01-18 04:29:52 | INFO     | sqlalchemy.engine.Engine | [generated in 0.00057s] (UUID('1aea8d41-8a9a-4631-a8d7-b8ef59d74bfc'),)
2026-01-18 04:29:52 | INFO     | sqlalchemy.engine.Engine | SELECT child_progress.child_id, child_progress.total_points, child_progress.total_flashcards, child_progress.total_chores, child_progress.total_outdoor, child_progress.total_affirmations, child_progress.current_streak, child_progress.longest_streak, child_progress.last_active_date, child_progress.last_seen_at, child_progress.current_level, child_progress.subject_counts 
FROM child_progress 
WHERE child_progress.child_id = $1::UUID
2026-01-18 04:29:52 | INFO     | sqlalchemy.engine.Engine | [generated in 0.00052s] (UUID('767166ac-39ef-4412-b0f5-72998235b319'),)
2026-01-18 04:29:52 | INFO     | sqlalchemy.engine.Engine | SELECT level_thresholds.id, level_thresholds.name, level_thresholds.threshold, level_thresholds.icon, level_thresholds.color, level_thresholds.is_active 
FROM level_thresholds 
WHERE level_thresholds.is_active = true
2026-01-18 04:29:52 | INFO     | sqlalchemy.engine.Engine | [generated in 0.00050s] ()
2026-01-18 04:29:52 | INFO     | sqlalchemy.engine.Engine | SELECT child_balanced_progress_counters.id, child_balanced_progress_counters.child_id, child_balanced_progress_counters.subject_code, child_balanced_progress_counters.correct_count, child_balanced_progress_counters.updated_at 
FROM child_balanced_progress_counters 
WHERE child_balanced_progress_counters.child_id = $1::UUID AND child_balanced_progress_counters.subject_code IN ($2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR)
2026-01-18 04:29:52 | INFO     | sqlalchemy.engine.Engine | [generated in 0.00077s] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), 'history', 'math', 'reading', 'science')
2026-01-18 04:29:52 | INFO     | sqlalchemy.engine.Engine | SELECT child_activity_events.kind, count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID GROUP BY child_activity_events.kind
2026-01-18 04:29:52 | INFO     | sqlalchemy.engine.Engine | [generated in 0.00046s] (UUID('767166ac-39ef-4412-b0f5-72998235b319'),)
2026-01-18 04:29:52 | INFO     | sqlalchemy.engine.Engine | SELECT coalesce(sum(child_activity_events.points), $1::INTEGER) AS coalesce_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $2::UUID
2026-01-18 04:29:52 | INFO     | sqlalchemy.engine.Engine | [generated in 0.00068s] (0, UUID('767166ac-39ef-4412-b0f5-72998235b319'))
2026-01-18 04:29:52 | INFO     | mybuddy.api | progress_totals: child_id=767166ac-39ef-4412-b0f5-72998235b319 totalPoints=398 counts={'affirmation': 2, 'flashcard': 46}
2026-01-18 04:29:52 | INFO     | sqlalchemy.engine.Engine | SELECT child_activity_events.kind, count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.created_at >= $2::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $3::TIMESTAMP WITH TIME ZONE GROUP BY child_activity_events.kind
2026-01-18 04:29:52 | INFO     | sqlalchemy.engine.Engine | [generated in 0.00046s] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:29:52 | INFO     | sqlalchemy.engine.Engine | SELECT coalesce(sum(child_activity_events.points), $1::INTEGER) AS coalesce_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $2::UUID AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE
2026-01-18 04:29:52 | INFO     | sqlalchemy.engine.Engine | [generated in 0.00054s] (0, UUID('767166ac-39ef-4412-b0f5-72998235b319'), datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:29:52 | INFO     | sqlalchemy.engine.Engine | SELECT count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.kind = $2::VARCHAR AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE AND child_activity_events.correct = true
2026-01-18 04:29:52 | INFO     | sqlalchemy.engine.Engine | [generated in 0.00046s] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), 'flashcard', datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:29:52 | INFO     | mybuddy.api | progress_today: child_id=767166ac-39ef-4412-b0f5-72998235b319 date=2026-01-17 counts={'affirmation': 2, 'flashcard': 46} flash_correct=37 totalPoints=398
2026-01-18 04:29:52 | INFO     | sqlalchemy.engine.Engine | SELECT difficulty_thresholds.code, difficulty_thresholds.threshold 
FROM difficulty_thresholds 
WHERE difficulty_thresholds.is_active = true
2026-01-18 04:29:52 | INFO     | sqlalchemy.engine.Engine | [generated in 0.00043s] ()
2026-01-18 04:29:52 | INFO     | mybuddy.api | difficulty_thresholds: child_id=767166ac-39ef-4412-b0f5-72998235b319 thresholds={'easy': 0, 'medium': 25, 'hard': 50, 'impossible': 100}
2026-01-18 04:29:52 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code AS subject_code, count(child_activity_events.id) AS completed, coalesce(sum(CASE WHEN (child_activity_events.correct = true) THEN $1::INTEGER ELSE $2::INTEGER END), $3::INTEGER) AS correct 
FROM child_activity_events JOIN subjects ON subjects.id = child_activity_events.subject_id 
WHERE child_activity_events.child_id = $4::UUID AND child_activity_events.kind = $5::VARCHAR GROUP BY subjects.code
2026-01-18 04:29:52 | INFO     | sqlalchemy.engine.Engine | [generated in 0.00049s] (1, 0, 0, UUID('767166ac-39ef-4412-b0f5-72998235b319'), 'flashcard')
2026-01-18 04:29:52 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code, child_subject_streaks.current_streak, child_subject_streaks.longest_streak 
FROM child_subject_streaks JOIN subjects ON subjects.id = child_subject_streaks.subject_id 
WHERE child_subject_streaks.child_id = $1::UUID
2026-01-18 04:29:52 | INFO     | sqlalchemy.engine.Engine | [generated in 0.00048s] (UUID('767166ac-39ef-4412-b0f5-72998235b319'),)
2026-01-18 04:29:52 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code, child_subject_difficulty.difficulty_code 
FROM child_subject_difficulty JOIN subjects ON subjects.id = child_subject_difficulty.subject_id 
WHERE child_subject_difficulty.child_id = $1::UUID
2026-01-18 04:29:52 | INFO     | sqlalchemy.engine.Engine | [generated in 0.00041s] (UUID('767166ac-39ef-4412-b0f5-72998235b319'),)
2026-01-18 04:29:52 | INFO     | mybuddy.api | subject_difficulty_map: child_id=767166ac-39ef-4412-b0f5-72998235b319 diff_map={'math': 'easy', 'science': 'easy', 'reading': 'easy', 'history': 'easy'}
2026-01-18 04:29:52 | INFO     | mybuddy.api | dashboard_flashcards_by_subject: child_id=767166ac-39ef-4412-b0f5-72998235b319 by_subject={'history': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 12, 'longestStreak': 18}, 'math': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 1, 'longestStreak': 6}, 'reading': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 0, 'longestStreak': 0}, 'science': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 2, 'longestStreak': 4}}
2026-01-18 04:29:52 | INFO     | sqlalchemy.engine.Engine | SELECT DISTINCT ((child_activity_events.created_at AT TIME ZONE 'America/New_York')::date) AS d 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.created_at >= $2::TIMESTAMP WITH TIME ZONE ORDER BY d DESC
2026-01-18 04:29:52 | INFO     | sqlalchemy.engine.Engine | [generated in 0.00049s] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), datetime.datetime(2025, 7, 21, 4, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:29:52 | INFO     | sqlalchemy.engine.Engine | SELECT achievements.created_at, achievements.updated_at, achievements.id, achievements.code, achievements.title, achievements.description, achievements.icon, achievements.achievement_type, achievements.points_threshold, achievements.streak_days_threshold, achievements.flashcards_count_threshold, achievements.chores_count_threshold, achievements.outdoor_count_threshold, achievements.is_active 
FROM achievements
2026-01-18 04:29:52 | INFO     | sqlalchemy.engine.Engine | [generated in 0.00039s] ()
2026-01-18 04:29:52 | INFO     | sqlalchemy.engine.Engine | SELECT achievements.code 
FROM achievements JOIN child_achievements ON child_achievements.achievement_id = achievements.id 
WHERE child_achievements.child_id = $1::UUID
2026-01-18 04:29:52 | INFO     | sqlalchemy.engine.Engine | [generated in 0.00049s] (UUID('767166ac-39ef-4412-b0f5-72998235b319'),)
2026-01-18 04:29:52 | INFO     | mybuddy.api | event_flashcard: commit child_id=767166ac-39ef-4412-b0f5-72998235b319 points=10 newAchievementCodes=[]
2026-01-18 04:29:52 | INFO     | sqlalchemy.engine.Engine | COMMIT
2026-01-18 04:29:52 | INFO     | mybuddy.api | event_flashcard: success child_id=767166ac-39ef-4412-b0f5-72998235b319
2026-01-18 04:29:52 | INFO     | uvicorn.access | 10.3.6.1:0 - "POST /v1/children/767166ac-39ef-4412-b0f5-72998235b319/events/flashcard HTTP/1.1" 200
2026-01-18 04:29:53 | INFO     | sqlalchemy.engine.Engine | BEGIN (implicit)
2026-01-18 04:29:53 | INFO     | sqlalchemy.engine.Engine | SELECT children.created_at, children.updated_at, children.id, children.owner_sub, children.name, children.birthday, children.interests, children.avatar_id 
FROM children 
WHERE children.id = $1::UUID AND children.owner_sub = $2::VARCHAR
2026-01-18 04:29:53 | INFO     | sqlalchemy.engine.Engine | [cached since 1.92s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), '3a26e22b-005d-4dc6-ac5f-bc66f95d8748')
2026-01-18 04:29:53 | INFO     | mybuddy.api | build_dashboard: start child_id=767166ac-39ef-4412-b0f5-72998235b319
2026-01-18 04:29:53 | INFO     | sqlalchemy.engine.Engine | SELECT child_activity_events.kind, count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID GROUP BY child_activity_events.kind
2026-01-18 04:29:53 | INFO     | sqlalchemy.engine.Engine | [cached since 1.722s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'),)
2026-01-18 04:29:53 | INFO     | sqlalchemy.engine.Engine | SELECT coalesce(sum(child_activity_events.points), $1::INTEGER) AS coalesce_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $2::UUID
2026-01-18 04:29:53 | INFO     | sqlalchemy.engine.Engine | [cached since 1.717s ago] (0, UUID('767166ac-39ef-4412-b0f5-72998235b319'))
2026-01-18 04:29:53 | INFO     | mybuddy.api | progress_totals: child_id=767166ac-39ef-4412-b0f5-72998235b319 totalPoints=398 counts={'affirmation': 2, 'flashcard': 46}
2026-01-18 04:29:53 | INFO     | sqlalchemy.engine.Engine | SELECT child_activity_events.kind, count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.created_at >= $2::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $3::TIMESTAMP WITH TIME ZONE GROUP BY child_activity_events.kind
2026-01-18 04:29:53 | INFO     | sqlalchemy.engine.Engine | [cached since 1.714s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:29:53 | INFO     | sqlalchemy.engine.Engine | SELECT coalesce(sum(child_activity_events.points), $1::INTEGER) AS coalesce_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $2::UUID AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE
2026-01-18 04:29:53 | INFO     | sqlalchemy.engine.Engine | [cached since 1.712s ago] (0, UUID('767166ac-39ef-4412-b0f5-72998235b319'), datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:29:53 | INFO     | sqlalchemy.engine.Engine | SELECT count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.kind = $2::VARCHAR AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE AND child_activity_events.correct = true
2026-01-18 04:29:53 | INFO     | sqlalchemy.engine.Engine | [cached since 1.709s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), 'flashcard', datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:29:53 | INFO     | mybuddy.api | progress_today: child_id=767166ac-39ef-4412-b0f5-72998235b319 date=2026-01-17 counts={'affirmation': 2, 'flashcard': 46} flash_correct=37 totalPoints=398
2026-01-18 04:29:53 | INFO     | sqlalchemy.engine.Engine | SELECT coalesce(sum(child_activity_events.points), $1::INTEGER) AS coalesce_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $2::UUID AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE
2026-01-18 04:29:53 | INFO     | sqlalchemy.engine.Engine | [cached since 1.722s ago] (0, UUID('767166ac-39ef-4412-b0f5-72998235b319'), datetime.datetime(2026, 1, 11, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:29:53 | INFO     | sqlalchemy.engine.Engine | SELECT count(DISTINCT ((child_activity_events.created_at AT TIME ZONE 'America/New_York')::date)) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.created_at >= $2::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $3::TIMESTAMP WITH TIME ZONE
2026-01-18 04:29:53 | INFO     | sqlalchemy.engine.Engine | [generated in 0.00070s] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), datetime.datetime(2026, 1, 11, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:29:53 | INFO     | sqlalchemy.engine.Engine | SELECT child_activity_events.kind, count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.created_at >= $2::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $3::TIMESTAMP WITH TIME ZONE GROUP BY child_activity_events.kind
2026-01-18 04:29:53 | INFO     | sqlalchemy.engine.Engine | [cached since 1.743s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), datetime.datetime(2026, 1, 11, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:29:53 | INFO     | sqlalchemy.engine.Engine | SELECT count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.kind = $2::VARCHAR AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE AND child_activity_events.correct = true
2026-01-18 04:29:53 | INFO     | sqlalchemy.engine.Engine | [cached since 1.733s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), 'flashcard', datetime.datetime(2026, 1, 11, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:29:53 | INFO     | mybuddy.api | progress_week: child_id=767166ac-39ef-4412-b0f5-72998235b319 weekStart=2026-01-11 counts={'affirmation': 2, 'flashcard': 46} flash_correct=37 accuracyPct=80 totalPoints=398 daysActive=1
2026-01-18 04:29:53 | INFO     | sqlalchemy.engine.Engine | SELECT DISTINCT child_activity_events.chore_id 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.kind = $2::VARCHAR AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE AND child_activity_events.chore_id IS NOT NULL
2026-01-18 04:29:53 | INFO     | sqlalchemy.engine.Engine | [generated in 0.00069s] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), 'chore', datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:29:53 | INFO     | sqlalchemy.engine.Engine | SELECT DISTINCT child_activity_events.outdoor_activity_id 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.kind = $2::VARCHAR AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE AND child_activity_events.outdoor_activity_id IS NOT NULL
2026-01-18 04:29:53 | INFO     | sqlalchemy.engine.Engine | [generated in 0.00072s] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), 'outdoor', datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:29:53 | INFO     | sqlalchemy.engine.Engine | SELECT children.created_at, children.updated_at, children.id, children.owner_sub, children.name, children.birthday, children.interests, children.avatar_id 
FROM children 
WHERE children.id = $1::UUID
2026-01-18 04:29:53 | INFO     | sqlalchemy.engine.Engine | [cached since 1.844s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'),)
2026-01-18 04:29:53 | INFO     | sqlalchemy.engine.Engine | SELECT age_ranges.id, age_ranges.code, age_ranges.name, age_ranges.min_age, age_ranges.max_age, age_ranges.is_active 
FROM age_ranges 
WHERE age_ranges.min_age <= $1::INTEGER AND (age_ranges.max_age IS NULL OR age_ranges.max_age >= $2::INTEGER) AND age_ranges.is_active = true
2026-01-18 04:29:53 | INFO     | sqlalchemy.engine.Engine | [cached since 1.839s ago] (8, 8)
2026-01-18 04:29:53 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code 
FROM subjects JOIN subject_age_ranges ON subjects.id = subject_age_ranges.subject_id 
WHERE subject_age_ranges.age_range_id = $1::UUID ORDER BY subjects.code
2026-01-18 04:29:53 | INFO     | sqlalchemy.engine.Engine | [cached since 1.836s ago] (UUID('1aea8d41-8a9a-4631-a8d7-b8ef59d74bfc'),)
2026-01-18 04:29:53 | INFO     | sqlalchemy.engine.Engine | SELECT difficulty_thresholds.code, difficulty_thresholds.threshold 
FROM difficulty_thresholds 
WHERE difficulty_thresholds.is_active = true
2026-01-18 04:29:53 | INFO     | sqlalchemy.engine.Engine | [cached since 1.763s ago] ()
2026-01-18 04:29:53 | INFO     | mybuddy.api | difficulty_thresholds: child_id=767166ac-39ef-4412-b0f5-72998235b319 thresholds={'easy': 0, 'medium': 25, 'hard': 50, 'impossible': 100}
2026-01-18 04:29:53 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code AS subject_code, count(child_activity_events.id) AS completed, coalesce(sum(CASE WHEN (child_activity_events.correct = true) THEN $1::INTEGER ELSE $2::INTEGER END), $3::INTEGER) AS correct 
FROM child_activity_events JOIN subjects ON subjects.id = child_activity_events.subject_id 
WHERE child_activity_events.child_id = $4::UUID AND child_activity_events.kind = $5::VARCHAR GROUP BY subjects.code
2026-01-18 04:29:53 | INFO     | sqlalchemy.engine.Engine | [cached since 1.759s ago] (1, 0, 0, UUID('767166ac-39ef-4412-b0f5-72998235b319'), 'flashcard')
2026-01-18 04:29:53 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code, child_subject_streaks.current_streak, child_subject_streaks.longest_streak 
FROM child_subject_streaks JOIN subjects ON subjects.id = child_subject_streaks.subject_id 
WHERE child_subject_streaks.child_id = $1::UUID
2026-01-18 04:29:53 | INFO     | sqlalchemy.engine.Engine | [cached since 1.757s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'),)
2026-01-18 04:29:53 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code, child_subject_difficulty.difficulty_code 
FROM child_subject_difficulty JOIN subjects ON subjects.id = child_subject_difficulty.subject_id 
WHERE child_subject_difficulty.child_id = $1::UUID
2026-01-18 04:29:53 | INFO     | sqlalchemy.engine.Engine | [cached since 1.755s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'),)
2026-01-18 04:29:53 | INFO     | mybuddy.api | subject_difficulty_map: child_id=767166ac-39ef-4412-b0f5-72998235b319 diff_map={'math': 'easy', 'science': 'easy', 'reading': 'easy', 'history': 'easy'}
2026-01-18 04:29:53 | INFO     | mybuddy.api | dashboard_flashcards_by_subject: child_id=767166ac-39ef-4412-b0f5-72998235b319 by_subject={'history': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 12, 'longestStreak': 18}, 'math': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 1, 'longestStreak': 6}, 'reading': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 0, 'longestStreak': 0}, 'science': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 2, 'longestStreak': 4}}
2026-01-18 04:29:53 | INFO     | sqlalchemy.engine.Engine | SELECT DISTINCT ((child_activity_events.created_at AT TIME ZONE 'America/New_York')::date) AS d 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.created_at >= $2::TIMESTAMP WITH TIME ZONE ORDER BY d DESC
2026-01-18 04:29:53 | INFO     | sqlalchemy.engine.Engine | [cached since 1.752s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), datetime.datetime(2025, 7, 21, 4, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:29:53 | INFO     | sqlalchemy.engine.Engine | SELECT level_thresholds.id, level_thresholds.name, level_thresholds.threshold, level_thresholds.icon, level_thresholds.color, level_thresholds.is_active 
FROM level_thresholds 
WHERE level_thresholds.is_active = true
2026-01-18 04:29:53 | INFO     | sqlalchemy.engine.Engine | [cached since 1.848s ago] ()
2026-01-18 04:29:53 | INFO     | mybuddy.api | build_dashboard: loaded child_id=767166ac-39ef-4412-b0f5-72998235b319 core_subjects=['history', 'math', 'reading', 'science'] by_subject_keys=['history', 'math', 'reading', 'science'] totalPoints=398
2026-01-18 04:29:53 | INFO     | sqlalchemy.engine.Engine | SELECT child_balanced_progress_counters.id, child_balanced_progress_counters.child_id, child_balanced_progress_counters.subject_code, child_balanced_progress_counters.correct_count, child_balanced_progress_counters.updated_at 
FROM child_balanced_progress_counters 
WHERE child_balanced_progress_counters.child_id = $1::UUID
2026-01-18 04:29:53 | INFO     | sqlalchemy.engine.Engine | [generated in 0.00055s] (UUID('767166ac-39ef-4412-b0f5-72998235b319'),)
2026-01-18 04:29:53 | INFO     | sqlalchemy.engine.Engine | SELECT child_progress.child_id, child_progress.total_points, child_progress.total_flashcards, child_progress.total_chores, child_progress.total_outdoor, child_progress.total_affirmations, child_progress.current_streak, child_progress.longest_streak, child_progress.last_active_date, child_progress.last_seen_at, child_progress.current_level, child_progress.subject_counts 
FROM child_progress 
WHERE child_progress.child_id = $1::UUID
2026-01-18 04:29:53 | INFO     | sqlalchemy.engine.Engine | [cached since 1.867s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'),)
2026-01-18 04:29:53 | INFO     | sqlalchemy.engine.Engine | SELECT achievements.code, child_achievements.unlocked_at 
FROM achievements JOIN child_achievements ON child_achievements.achievement_id = achievements.id 
WHERE child_achievements.child_id = $1::UUID
2026-01-18 04:29:53 | INFO     | sqlalchemy.engine.Engine | [generated in 0.00053s] (UUID('767166ac-39ef-4412-b0f5-72998235b319'),)
2026-01-18 04:29:53 | INFO     | sqlalchemy.engine.Engine | SELECT achievements.created_at, achievements.updated_at, achievements.id, achievements.code, achievements.title, achievements.description, achievements.icon, achievements.achievement_type, achievements.points_threshold, achievements.streak_days_threshold, achievements.flashcards_count_threshold, achievements.chores_count_threshold, achievements.outdoor_count_threshold, achievements.is_active 
FROM achievements
2026-01-18 04:29:53 | INFO     | sqlalchemy.engine.Engine | [cached since 1.769s ago] ()
2026-01-18 04:29:54 | INFO     | mybuddy.api | build_dashboard: end child_id=767166ac-39ef-4412-b0f5-72998235b319 unlocked=3 locked=17
2026-01-18 04:29:54 | INFO     | uvicorn.access | 10.3.6.1:0 - "GET /v1/children/767166ac-39ef-4412-b0f5-72998235b319/dashboard HTTP/1.1" 200
2026-01-18 04:29:54 | INFO     | sqlalchemy.engine.Engine | ROLLBACK
2026-01-18 04:30:02 | INFO     | sqlalchemy.engine.Engine | BEGIN (implicit)
2026-01-18 04:30:02 | INFO     | sqlalchemy.engine.Engine | SELECT children.created_at, children.updated_at, children.id, children.owner_sub, children.name, children.birthday, children.interests, children.avatar_id 
FROM children 
WHERE children.id = $1::UUID AND children.owner_sub = $2::VARCHAR
2026-01-18 04:30:02 | INFO     | sqlalchemy.engine.Engine | [cached since 10.33s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), '3a26e22b-005d-4dc6-ac5f-bc66f95d8748')
2026-01-18 04:30:02 | INFO     | mybuddy.api | event_flashcard: start child_id=767166ac-39ef-4412-b0f5-72998235b319 flashcardId=5dad17a5-3d63-4cde-9708-1ffef4c7b63a correct=True
2026-01-18 04:30:02 | INFO     | sqlalchemy.engine.Engine | SELECT points_values.id, points_values.code, points_values.name, points_values.points, points_values.is_active 
FROM points_values 
WHERE points_values.is_active = true
2026-01-18 04:30:02 | INFO     | sqlalchemy.engine.Engine | [cached since 10.32s ago] ()
2026-01-18 04:30:02 | INFO     | sqlalchemy.engine.Engine | SELECT flashcards.id, flashcards.subject_id, flashcards.question, flashcards.choices, flashcards.explanations, flashcards.correct_index, flashcards.difficulty_code, flashcards.tags, flashcards.age_range_id 
FROM flashcards 
WHERE flashcards.id = $1::UUID
2026-01-18 04:30:02 | INFO     | sqlalchemy.engine.Engine | [cached since 10.31s ago] (UUID('5dad17a5-3d63-4cde-9708-1ffef4c7b63a'),)
2026-01-18 04:30:02 | INFO     | mybuddy.api | event_flashcard: validated child_id=767166ac-39ef-4412-b0f5-72998235b319 flashcardId=5dad17a5-3d63-4cde-9708-1ffef4c7b63a subject_id=73c23c39-1a46-4a0a-9f0d-6b8f44a61635 points=10
2026-01-18 04:30:02 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.id, subjects.code, subjects.name, subjects.icon, subjects.color 
FROM subjects 
WHERE subjects.id = $1::UUID
2026-01-18 04:30:02 | INFO     | sqlalchemy.engine.Engine | [cached since 10.31s ago] (UUID('73c23c39-1a46-4a0a-9f0d-6b8f44a61635'),)
2026-01-18 04:30:02 | INFO     | sqlalchemy.engine.Engine | SAVEPOINT sa_savepoint_1
2026-01-18 04:30:02 | INFO     | sqlalchemy.engine.Engine | [no key 0.00054s] ()
2026-01-18 04:30:02 | INFO     | sqlalchemy.engine.Engine | INSERT INTO child_activity_events (child_id, kind, subject_id, flashcard_id, chore_id, outdoor_activity_id, affirmation_id, points, correct, answer, meta) VALUES ($1::UUID, $2::VARCHAR, $3::UUID, $4::UUID, $5::UUID, $6::UUID, $7::UUID, $8::INTEGER, $9::BOOLEAN, $10::VARCHAR, $11::JSONB) RETURNING child_activity_events.id, child_activity_events.created_at
2026-01-18 04:30:02 | INFO     | sqlalchemy.engine.Engine | [cached since 10.3s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), 'flashcard', UUID('73c23c39-1a46-4a0a-9f0d-6b8f44a61635'), UUID('5dad17a5-3d63-4cde-9708-1ffef4c7b63a'), None, None, None, 10, True, '6,500', '{"dedupeKey": "flashcard:5dad17a5-3d63-4cde-9708-1ffef4c7b63a", "flashcardId": "5dad17a5-3d63-4cde-9708-1ffef4c7b63a", "subjectId": "73c23c39-1a46-4a0a-9f0d-6b8f44a61635", "correct": true, "answer": "6,500", "points": 10}')
2026-01-18 04:30:02 | INFO     | sqlalchemy.engine.Engine | RELEASE SAVEPOINT sa_savepoint_1
2026-01-18 04:30:02 | INFO     | sqlalchemy.engine.Engine | [no key 0.00060s] ()
2026-01-18 04:30:02 | INFO     | mybuddy.api | event_flashcard: inserted_event child_id=767166ac-39ef-4412-b0f5-72998235b319
2026-01-18 04:30:02 | INFO     | sqlalchemy.engine.Engine | SELECT difficulty_thresholds.id, difficulty_thresholds.code, difficulty_thresholds.name, difficulty_thresholds.label, difficulty_thresholds.icon, difficulty_thresholds.color, difficulty_thresholds.threshold, difficulty_thresholds.is_active 
FROM difficulty_thresholds 
WHERE difficulty_thresholds.is_active = true
2026-01-18 04:30:02 | INFO     | sqlalchemy.engine.Engine | [cached since 10.28s ago] ()
2026-01-18 04:30:02 | INFO     | sqlalchemy.engine.Engine | SELECT child_subject_difficulty.child_id, child_subject_difficulty.subject_id, child_subject_difficulty.difficulty_code, child_subject_difficulty.last_updated 
FROM child_subject_difficulty 
WHERE child_subject_difficulty.child_id = $1::UUID AND child_subject_difficulty.subject_id = $2::UUID
2026-01-18 04:30:02 | INFO     | sqlalchemy.engine.Engine | [cached since 10.28s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), UUID('73c23c39-1a46-4a0a-9f0d-6b8f44a61635'))
2026-01-18 04:30:02 | INFO     | sqlalchemy.engine.Engine | SELECT child_subject_streaks.child_id, child_subject_streaks.subject_id, child_subject_streaks.current_streak, child_subject_streaks.longest_streak, child_subject_streaks.last_updated 
FROM child_subject_streaks 
WHERE child_subject_streaks.child_id = $1::UUID AND child_subject_streaks.subject_id = $2::UUID
2026-01-18 04:30:02 | INFO     | sqlalchemy.engine.Engine | [cached since 10.27s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), UUID('73c23c39-1a46-4a0a-9f0d-6b8f44a61635'))
2026-01-18 04:30:02 | INFO     | sqlalchemy.engine.Engine | UPDATE child_subject_streaks SET current_streak=$1::INTEGER, last_updated=$2::TIMESTAMP WITH TIME ZONE WHERE child_subject_streaks.child_id = $3::UUID AND child_subject_streaks.subject_id = $4::UUID
2026-01-18 04:30:02 | INFO     | sqlalchemy.engine.Engine | [cached since 10.27s ago] (2, datetime.datetime(2026, 1, 18, 4, 30, 2, 312629, tzinfo=datetime.timezone.utc), UUID('767166ac-39ef-4412-b0f5-72998235b319'), UUID('73c23c39-1a46-4a0a-9f0d-6b8f44a61635'))
2026-01-18 04:30:02 | INFO     | sqlalchemy.engine.Engine | SELECT child_balanced_progress_counters.id, child_balanced_progress_counters.child_id, child_balanced_progress_counters.subject_code, child_balanced_progress_counters.correct_count, child_balanced_progress_counters.updated_at 
FROM child_balanced_progress_counters 
WHERE child_balanced_progress_counters.child_id = $1::UUID AND child_balanced_progress_counters.subject_code = $2::VARCHAR
2026-01-18 04:30:02 | INFO     | sqlalchemy.engine.Engine | [cached since 10.26s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), 'math')
2026-01-18 04:30:02 | INFO     | sqlalchemy.engine.Engine | UPDATE child_balanced_progress_counters SET correct_count=$1::INTEGER, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE child_balanced_progress_counters.id = $3::UUID
2026-01-18 04:30:02 | INFO     | sqlalchemy.engine.Engine | [cached since 10.25s ago] (16, datetime.datetime(2026, 1, 18, 4, 30, 2, 321111, tzinfo=datetime.timezone.utc), UUID('4cdd2f9d-ec9b-4704-8505-26aabc45a383'))
2026-01-18 04:30:02 | INFO     | sqlalchemy.engine.Engine | SELECT child_flashcard_performance.created_at, child_flashcard_performance.updated_at, child_flashcard_performance.child_id, child_flashcard_performance.flashcard_id, child_flashcard_performance.correct_count, child_flashcard_performance.incorrect_count, child_flashcard_performance.last_seen_at 
FROM child_flashcard_performance 
WHERE child_flashcard_performance.child_id = $1::UUID AND child_flashcard_performance.flashcard_id = $2::UUID
2026-01-18 04:30:02 | INFO     | sqlalchemy.engine.Engine | [cached since 10.25s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), UUID('5dad17a5-3d63-4cde-9708-1ffef4c7b63a'))
2026-01-18 04:30:02 | INFO     | mybuddy.api | event_flashcard: create_perf child_id=767166ac-39ef-4412-b0f5-72998235b319 flashcardId=5dad17a5-3d63-4cde-9708-1ffef4c7b63a correct=True
2026-01-18 04:30:02 | INFO     | sqlalchemy.engine.Engine | INSERT INTO child_flashcard_performance (child_id, flashcard_id, correct_count, incorrect_count, last_seen_at) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::INTEGER, $5::TIMESTAMP WITH TIME ZONE) RETURNING child_flashcard_performance.created_at, child_flashcard_performance.updated_at
2026-01-18 04:30:02 | INFO     | sqlalchemy.engine.Engine | [cached since 10.24s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), UUID('5dad17a5-3d63-4cde-9708-1ffef4c7b63a'), 1, 0, datetime.datetime(2026, 1, 18, 4, 30, 2, 329647, tzinfo=datetime.timezone.utc))
2026-01-18 04:30:02 | INFO     | sqlalchemy.engine.Engine | SELECT children.created_at, children.updated_at, children.id, children.owner_sub, children.name, children.birthday, children.interests, children.avatar_id 
FROM children 
WHERE children.id = $1::UUID
2026-01-18 04:30:02 | INFO     | sqlalchemy.engine.Engine | [cached since 10.24s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'),)
2026-01-18 04:30:02 | INFO     | sqlalchemy.engine.Engine | SELECT age_ranges.id, age_ranges.code, age_ranges.name, age_ranges.min_age, age_ranges.max_age, age_ranges.is_active 
FROM age_ranges 
WHERE age_ranges.min_age <= $1::INTEGER AND (age_ranges.max_age IS NULL OR age_ranges.max_age >= $2::INTEGER) AND age_ranges.is_active = true
2026-01-18 04:30:02 | INFO     | sqlalchemy.engine.Engine | [cached since 10.24s ago] (8, 8)
2026-01-18 04:30:02 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code 
FROM subjects JOIN subject_age_ranges ON subjects.id = subject_age_ranges.subject_id 
WHERE subject_age_ranges.age_range_id = $1::UUID ORDER BY subjects.code
2026-01-18 04:30:02 | INFO     | sqlalchemy.engine.Engine | [cached since 10.23s ago] (UUID('1aea8d41-8a9a-4631-a8d7-b8ef59d74bfc'),)
2026-01-18 04:30:02 | INFO     | sqlalchemy.engine.Engine | SELECT child_progress.child_id, child_progress.total_points, child_progress.total_flashcards, child_progress.total_chores, child_progress.total_outdoor, child_progress.total_affirmations, child_progress.current_streak, child_progress.longest_streak, child_progress.last_active_date, child_progress.last_seen_at, child_progress.current_level, child_progress.subject_counts 
FROM child_progress 
WHERE child_progress.child_id = $1::UUID
2026-01-18 04:30:02 | INFO     | sqlalchemy.engine.Engine | [cached since 10.23s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'),)
2026-01-18 04:30:02 | INFO     | sqlalchemy.engine.Engine | SELECT level_thresholds.id, level_thresholds.name, level_thresholds.threshold, level_thresholds.icon, level_thresholds.color, level_thresholds.is_active 
FROM level_thresholds 
WHERE level_thresholds.is_active = true
2026-01-18 04:30:02 | INFO     | sqlalchemy.engine.Engine | [cached since 10.22s ago] ()
2026-01-18 04:30:02 | INFO     | sqlalchemy.engine.Engine | SELECT child_balanced_progress_counters.id, child_balanced_progress_counters.child_id, child_balanced_progress_counters.subject_code, child_balanced_progress_counters.correct_count, child_balanced_progress_counters.updated_at 
FROM child_balanced_progress_counters 
WHERE child_balanced_progress_counters.child_id = $1::UUID AND child_balanced_progress_counters.subject_code IN ($2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR)
2026-01-18 04:30:02 | INFO     | sqlalchemy.engine.Engine | [cached since 10.22s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), 'history', 'math', 'reading', 'science')
2026-01-18 04:30:02 | INFO     | sqlalchemy.engine.Engine | SELECT child_activity_events.kind, count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID GROUP BY child_activity_events.kind
2026-01-18 04:30:02 | INFO     | sqlalchemy.engine.Engine | [cached since 10.21s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'),)
2026-01-18 04:30:02 | INFO     | sqlalchemy.engine.Engine | SELECT coalesce(sum(child_activity_events.points), $1::INTEGER) AS coalesce_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $2::UUID
2026-01-18 04:30:02 | INFO     | sqlalchemy.engine.Engine | [cached since 10.21s ago] (0, UUID('767166ac-39ef-4412-b0f5-72998235b319'))
2026-01-18 04:30:02 | INFO     | mybuddy.api | progress_totals: child_id=767166ac-39ef-4412-b0f5-72998235b319 totalPoints=408 counts={'affirmation': 2, 'flashcard': 47}
2026-01-18 04:30:02 | INFO     | sqlalchemy.engine.Engine | SELECT child_activity_events.kind, count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.created_at >= $2::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $3::TIMESTAMP WITH TIME ZONE GROUP BY child_activity_events.kind
2026-01-18 04:30:02 | INFO     | sqlalchemy.engine.Engine | [cached since 10.21s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:30:02 | INFO     | sqlalchemy.engine.Engine | SELECT coalesce(sum(child_activity_events.points), $1::INTEGER) AS coalesce_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $2::UUID AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE
2026-01-18 04:30:02 | INFO     | sqlalchemy.engine.Engine | [cached since 10.2s ago] (0, UUID('767166ac-39ef-4412-b0f5-72998235b319'), datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:30:02 | INFO     | sqlalchemy.engine.Engine | SELECT count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.kind = $2::VARCHAR AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE AND child_activity_events.correct = true
2026-01-18 04:30:02 | INFO     | sqlalchemy.engine.Engine | [cached since 10.2s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), 'flashcard', datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:30:02 | INFO     | mybuddy.api | progress_today: child_id=767166ac-39ef-4412-b0f5-72998235b319 date=2026-01-17 counts={'affirmation': 2, 'flashcard': 47} flash_correct=38 totalPoints=408
2026-01-18 04:30:02 | INFO     | sqlalchemy.engine.Engine | SELECT difficulty_thresholds.code, difficulty_thresholds.threshold 
FROM difficulty_thresholds 
WHERE difficulty_thresholds.is_active = true
2026-01-18 04:30:02 | INFO     | sqlalchemy.engine.Engine | [cached since 10.2s ago] ()
2026-01-18 04:30:02 | INFO     | mybuddy.api | difficulty_thresholds: child_id=767166ac-39ef-4412-b0f5-72998235b319 thresholds={'easy': 0, 'medium': 25, 'hard': 50, 'impossible': 100}
2026-01-18 04:30:02 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code AS subject_code, count(child_activity_events.id) AS completed, coalesce(sum(CASE WHEN (child_activity_events.correct = true) THEN $1::INTEGER ELSE $2::INTEGER END), $3::INTEGER) AS correct 
FROM child_activity_events JOIN subjects ON subjects.id = child_activity_events.subject_id 
WHERE child_activity_events.child_id = $4::UUID AND child_activity_events.kind = $5::VARCHAR GROUP BY subjects.code
2026-01-18 04:30:02 | INFO     | sqlalchemy.engine.Engine | [cached since 10.19s ago] (1, 0, 0, UUID('767166ac-39ef-4412-b0f5-72998235b319'), 'flashcard')
2026-01-18 04:30:02 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code, child_subject_streaks.current_streak, child_subject_streaks.longest_streak 
FROM child_subject_streaks JOIN subjects ON subjects.id = child_subject_streaks.subject_id 
WHERE child_subject_streaks.child_id = $1::UUID
2026-01-18 04:30:02 | INFO     | sqlalchemy.engine.Engine | [cached since 10.19s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'),)
2026-01-18 04:30:02 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code, child_subject_difficulty.difficulty_code 
FROM child_subject_difficulty JOIN subjects ON subjects.id = child_subject_difficulty.subject_id 
WHERE child_subject_difficulty.child_id = $1::UUID
2026-01-18 04:30:02 | INFO     | sqlalchemy.engine.Engine | [cached since 10.19s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'),)
2026-01-18 04:30:02 | INFO     | mybuddy.api | subject_difficulty_map: child_id=767166ac-39ef-4412-b0f5-72998235b319 diff_map={'math': 'easy', 'science': 'easy', 'reading': 'easy', 'history': 'easy'}
2026-01-18 04:30:02 | INFO     | mybuddy.api | dashboard_flashcards_by_subject: child_id=767166ac-39ef-4412-b0f5-72998235b319 by_subject={'history': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 12, 'longestStreak': 18}, 'math': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 2, 'longestStreak': 6}, 'reading': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 0, 'longestStreak': 0}, 'science': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 2, 'longestStreak': 4}}
2026-01-18 04:30:02 | INFO     | sqlalchemy.engine.Engine | SELECT DISTINCT ((child_activity_events.created_at AT TIME ZONE 'America/New_York')::date) AS d 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.created_at >= $2::TIMESTAMP WITH TIME ZONE ORDER BY d DESC
2026-01-18 04:30:02 | INFO     | sqlalchemy.engine.Engine | [cached since 10.19s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), datetime.datetime(2025, 7, 21, 4, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:30:02 | INFO     | sqlalchemy.engine.Engine | SELECT achievements.created_at, achievements.updated_at, achievements.id, achievements.code, achievements.title, achievements.description, achievements.icon, achievements.achievement_type, achievements.points_threshold, achievements.streak_days_threshold, achievements.flashcards_count_threshold, achievements.chores_count_threshold, achievements.outdoor_count_threshold, achievements.is_active 
FROM achievements
2026-01-18 04:30:02 | INFO     | sqlalchemy.engine.Engine | [cached since 10.18s ago] ()
2026-01-18 04:30:02 | INFO     | sqlalchemy.engine.Engine | SELECT achievements.code 
FROM achievements JOIN child_achievements ON child_achievements.achievement_id = achievements.id 
WHERE child_achievements.child_id = $1::UUID
2026-01-18 04:30:02 | INFO     | sqlalchemy.engine.Engine | [cached since 10.17s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'),)
2026-01-18 04:30:02 | INFO     | mybuddy.api | event_flashcard: commit child_id=767166ac-39ef-4412-b0f5-72998235b319 points=10 newAchievementCodes=[]
2026-01-18 04:30:02 | INFO     | sqlalchemy.engine.Engine | COMMIT
2026-01-18 04:30:02 | INFO     | mybuddy.api | event_flashcard: success child_id=767166ac-39ef-4412-b0f5-72998235b319
2026-01-18 04:30:02 | INFO     | uvicorn.access | 10.3.6.1:0 - "POST /v1/children/767166ac-39ef-4412-b0f5-72998235b319/events/flashcard HTTP/1.1" 200
2026-01-18 04:30:04 | INFO     | sqlalchemy.engine.Engine | BEGIN (implicit)
2026-01-18 04:30:04 | INFO     | sqlalchemy.engine.Engine | SELECT children.created_at, children.updated_at, children.id, children.owner_sub, children.name, children.birthday, children.interests, children.avatar_id 
FROM children 
WHERE children.id = $1::UUID AND children.owner_sub = $2::VARCHAR
2026-01-18 04:30:04 | INFO     | sqlalchemy.engine.Engine | [cached since 12.1s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), '3a26e22b-005d-4dc6-ac5f-bc66f95d8748')
2026-01-18 04:30:04 | INFO     | mybuddy.api | build_dashboard: start child_id=767166ac-39ef-4412-b0f5-72998235b319
2026-01-18 04:30:04 | INFO     | sqlalchemy.engine.Engine | SELECT child_activity_events.kind, count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID GROUP BY child_activity_events.kind
2026-01-18 04:30:04 | INFO     | sqlalchemy.engine.Engine | [cached since 11.9s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'),)
2026-01-18 04:30:04 | INFO     | sqlalchemy.engine.Engine | SELECT coalesce(sum(child_activity_events.points), $1::INTEGER) AS coalesce_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $2::UUID
2026-01-18 04:30:04 | INFO     | sqlalchemy.engine.Engine | [cached since 11.9s ago] (0, UUID('767166ac-39ef-4412-b0f5-72998235b319'))
2026-01-18 04:30:04 | INFO     | mybuddy.api | progress_totals: child_id=767166ac-39ef-4412-b0f5-72998235b319 totalPoints=408 counts={'affirmation': 2, 'flashcard': 47}
2026-01-18 04:30:04 | INFO     | sqlalchemy.engine.Engine | SELECT child_activity_events.kind, count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.created_at >= $2::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $3::TIMESTAMP WITH TIME ZONE GROUP BY child_activity_events.kind
2026-01-18 04:30:04 | INFO     | sqlalchemy.engine.Engine | [cached since 11.9s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:30:04 | INFO     | sqlalchemy.engine.Engine | SELECT coalesce(sum(child_activity_events.points), $1::INTEGER) AS coalesce_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $2::UUID AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE
2026-01-18 04:30:04 | INFO     | sqlalchemy.engine.Engine | [cached since 11.89s ago] (0, UUID('767166ac-39ef-4412-b0f5-72998235b319'), datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:30:04 | INFO     | sqlalchemy.engine.Engine | SELECT count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.kind = $2::VARCHAR AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE AND child_activity_events.correct = true
2026-01-18 04:30:04 | INFO     | sqlalchemy.engine.Engine | [cached since 11.89s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), 'flashcard', datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:30:04 | INFO     | mybuddy.api | progress_today: child_id=767166ac-39ef-4412-b0f5-72998235b319 date=2026-01-17 counts={'affirmation': 2, 'flashcard': 47} flash_correct=38 totalPoints=408
2026-01-18 04:30:04 | INFO     | sqlalchemy.engine.Engine | SELECT coalesce(sum(child_activity_events.points), $1::INTEGER) AS coalesce_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $2::UUID AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE
2026-01-18 04:30:04 | INFO     | sqlalchemy.engine.Engine | [cached since 11.9s ago] (0, UUID('767166ac-39ef-4412-b0f5-72998235b319'), datetime.datetime(2026, 1, 11, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:30:04 | INFO     | sqlalchemy.engine.Engine | SELECT count(DISTINCT ((child_activity_events.created_at AT TIME ZONE 'America/New_York')::date)) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.created_at >= $2::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $3::TIMESTAMP WITH TIME ZONE
2026-01-18 04:30:04 | INFO     | sqlalchemy.engine.Engine | [cached since 10.18s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), datetime.datetime(2026, 1, 11, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:30:04 | INFO     | sqlalchemy.engine.Engine | SELECT child_activity_events.kind, count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.created_at >= $2::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $3::TIMESTAMP WITH TIME ZONE GROUP BY child_activity_events.kind
2026-01-18 04:30:04 | INFO     | sqlalchemy.engine.Engine | [cached since 11.92s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), datetime.datetime(2026, 1, 11, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:30:04 | INFO     | sqlalchemy.engine.Engine | SELECT count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.kind = $2::VARCHAR AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE AND child_activity_events.correct = true
2026-01-18 04:30:04 | INFO     | sqlalchemy.engine.Engine | [cached since 11.91s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), 'flashcard', datetime.datetime(2026, 1, 11, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:30:04 | INFO     | mybuddy.api | progress_week: child_id=767166ac-39ef-4412-b0f5-72998235b319 weekStart=2026-01-11 counts={'affirmation': 2, 'flashcard': 47} flash_correct=38 accuracyPct=81 totalPoints=408 daysActive=1
2026-01-18 04:30:04 | INFO     | sqlalchemy.engine.Engine | SELECT DISTINCT child_activity_events.chore_id 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.kind = $2::VARCHAR AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE AND child_activity_events.chore_id IS NOT NULL
2026-01-18 04:30:04 | INFO     | sqlalchemy.engine.Engine | [cached since 10.18s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), 'chore', datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:30:04 | INFO     | sqlalchemy.engine.Engine | SELECT DISTINCT child_activity_events.outdoor_activity_id 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.kind = $2::VARCHAR AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE AND child_activity_events.outdoor_activity_id IS NOT NULL
2026-01-18 04:30:04 | INFO     | sqlalchemy.engine.Engine | [cached since 10.17s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), 'outdoor', datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:30:04 | INFO     | sqlalchemy.engine.Engine | SELECT children.created_at, children.updated_at, children.id, children.owner_sub, children.name, children.birthday, children.interests, children.avatar_id 
FROM children 
WHERE children.id = $1::UUID
2026-01-18 04:30:04 | INFO     | sqlalchemy.engine.Engine | [cached since 12.02s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'),)
2026-01-18 04:30:04 | INFO     | sqlalchemy.engine.Engine | SELECT age_ranges.id, age_ranges.code, age_ranges.name, age_ranges.min_age, age_ranges.max_age, age_ranges.is_active 
FROM age_ranges 
WHERE age_ranges.min_age <= $1::INTEGER AND (age_ranges.max_age IS NULL OR age_ranges.max_age >= $2::INTEGER) AND age_ranges.is_active = true
2026-01-18 04:30:04 | INFO     | sqlalchemy.engine.Engine | [cached since 12.01s ago] (8, 8)
2026-01-18 04:30:04 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code 
FROM subjects JOIN subject_age_ranges ON subjects.id = subject_age_ranges.subject_id 
WHERE subject_age_ranges.age_range_id = $1::UUID ORDER BY subjects.code
2026-01-18 04:30:04 | INFO     | sqlalchemy.engine.Engine | [cached since 12.01s ago] (UUID('1aea8d41-8a9a-4631-a8d7-b8ef59d74bfc'),)
2026-01-18 04:30:04 | INFO     | sqlalchemy.engine.Engine | SELECT difficulty_thresholds.code, difficulty_thresholds.threshold 
FROM difficulty_thresholds 
WHERE difficulty_thresholds.is_active = true
2026-01-18 04:30:04 | INFO     | sqlalchemy.engine.Engine | [cached since 11.94s ago] ()
2026-01-18 04:30:04 | INFO     | mybuddy.api | difficulty_thresholds: child_id=767166ac-39ef-4412-b0f5-72998235b319 thresholds={'easy': 0, 'medium': 25, 'hard': 50, 'impossible': 100}
2026-01-18 04:30:04 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code AS subject_code, count(child_activity_events.id) AS completed, coalesce(sum(CASE WHEN (child_activity_events.correct = true) THEN $1::INTEGER ELSE $2::INTEGER END), $3::INTEGER) AS correct 
FROM child_activity_events JOIN subjects ON subjects.id = child_activity_events.subject_id 
WHERE child_activity_events.child_id = $4::UUID AND child_activity_events.kind = $5::VARCHAR GROUP BY subjects.code
2026-01-18 04:30:04 | INFO     | sqlalchemy.engine.Engine | [cached since 11.93s ago] (1, 0, 0, UUID('767166ac-39ef-4412-b0f5-72998235b319'), 'flashcard')
2026-01-18 04:30:04 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code, child_subject_streaks.current_streak, child_subject_streaks.longest_streak 
FROM child_subject_streaks JOIN subjects ON subjects.id = child_subject_streaks.subject_id 
WHERE child_subject_streaks.child_id = $1::UUID
2026-01-18 04:30:04 | INFO     | sqlalchemy.engine.Engine | [cached since 11.93s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'),)
2026-01-18 04:30:04 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code, child_subject_difficulty.difficulty_code 
FROM child_subject_difficulty JOIN subjects ON subjects.id = child_subject_difficulty.subject_id 
WHERE child_subject_difficulty.child_id = $1::UUID
2026-01-18 04:30:04 | INFO     | sqlalchemy.engine.Engine | [cached since 11.93s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'),)
2026-01-18 04:30:04 | INFO     | mybuddy.api | subject_difficulty_map: child_id=767166ac-39ef-4412-b0f5-72998235b319 diff_map={'math': 'easy', 'science': 'easy', 'reading': 'easy', 'history': 'easy'}
2026-01-18 04:30:04 | INFO     | mybuddy.api | dashboard_flashcards_by_subject: child_id=767166ac-39ef-4412-b0f5-72998235b319 by_subject={'history': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 12, 'longestStreak': 18}, 'math': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 2, 'longestStreak': 6}, 'reading': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 0, 'longestStreak': 0}, 'science': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 2, 'longestStreak': 4}}
2026-01-18 04:30:04 | INFO     | sqlalchemy.engine.Engine | SELECT DISTINCT ((child_activity_events.created_at AT TIME ZONE 'America/New_York')::date) AS d 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.created_at >= $2::TIMESTAMP WITH TIME ZONE ORDER BY d DESC
2026-01-18 04:30:04 | INFO     | sqlalchemy.engine.Engine | [cached since 11.92s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), datetime.datetime(2025, 7, 21, 4, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:30:04 | INFO     | sqlalchemy.engine.Engine | SELECT level_thresholds.id, level_thresholds.name, level_thresholds.threshold, level_thresholds.icon, level_thresholds.color, level_thresholds.is_active 
FROM level_thresholds 
WHERE level_thresholds.is_active = true
2026-01-18 04:30:04 | INFO     | sqlalchemy.engine.Engine | [cached since 12.02s ago] ()
2026-01-18 04:30:04 | INFO     | mybuddy.api | build_dashboard: loaded child_id=767166ac-39ef-4412-b0f5-72998235b319 core_subjects=['history', 'math', 'reading', 'science'] by_subject_keys=['history', 'math', 'reading', 'science'] totalPoints=408
2026-01-18 04:30:04 | INFO     | sqlalchemy.engine.Engine | SELECT child_balanced_progress_counters.id, child_balanced_progress_counters.child_id, child_balanced_progress_counters.subject_code, child_balanced_progress_counters.correct_count, child_balanced_progress_counters.updated_at 
FROM child_balanced_progress_counters 
WHERE child_balanced_progress_counters.child_id = $1::UUID
2026-01-18 04:30:04 | INFO     | sqlalchemy.engine.Engine | [cached since 10.17s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'),)
2026-01-18 04:30:04 | INFO     | sqlalchemy.engine.Engine | SELECT child_progress.child_id, child_progress.total_points, child_progress.total_flashcards, child_progress.total_chores, child_progress.total_outdoor, child_progress.total_affirmations, child_progress.current_streak, child_progress.longest_streak, child_progress.last_active_date, child_progress.last_seen_at, child_progress.current_level, child_progress.subject_counts 
FROM child_progress 
WHERE child_progress.child_id = $1::UUID
2026-01-18 04:30:04 | INFO     | sqlalchemy.engine.Engine | [cached since 12.03s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'),)
2026-01-18 04:30:04 | INFO     | sqlalchemy.engine.Engine | SELECT achievements.code, child_achievements.unlocked_at 
FROM achievements JOIN child_achievements ON child_achievements.achievement_id = achievements.id 
WHERE child_achievements.child_id = $1::UUID
2026-01-18 04:30:04 | INFO     | sqlalchemy.engine.Engine | [cached since 10.16s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'),)
2026-01-18 04:30:04 | INFO     | sqlalchemy.engine.Engine | SELECT achievements.created_at, achievements.updated_at, achievements.id, achievements.code, achievements.title, achievements.description, achievements.icon, achievements.achievement_type, achievements.points_threshold, achievements.streak_days_threshold, achievements.flashcards_count_threshold, achievements.chores_count_threshold, achievements.outdoor_count_threshold, achievements.is_active 
FROM achievements
2026-01-18 04:30:04 | INFO     | sqlalchemy.engine.Engine | [cached since 11.93s ago] ()
2026-01-18 04:30:04 | INFO     | mybuddy.api | build_dashboard: end child_id=767166ac-39ef-4412-b0f5-72998235b319 unlocked=3 locked=17
2026-01-18 04:30:04 | INFO     | uvicorn.access | 10.3.6.1:0 - "GET /v1/children/767166ac-39ef-4412-b0f5-72998235b319/dashboard HTTP/1.1" 200
2026-01-18 04:30:04 | INFO     | sqlalchemy.engine.Engine | ROLLBACK
2026-01-18 04:31:40 | WARNING  | mybuddy.api | Request potential issue
2026-01-18 04:31:40 | INFO     | uvicorn.access | 10.3.6.1:0 - "GET /v1/outdoor/activities?childId=767166ac-39ef-4412-b0f5-72998235b319 HTTP/1.1" 401
2026-01-18 04:31:41 | INFO     | sqlalchemy.pool.impl.AsyncAdaptedQueuePool | Connection <AdaptedConnection <asyncpg.connection.Connection object at 0x78814a533b60>> exceeded timeout; recycling
2026-01-18 04:31:41 | INFO     | sqlalchemy.engine.Engine | BEGIN (implicit)
2026-01-18 04:31:41 | INFO     | sqlalchemy.engine.Engine | SELECT children.created_at, children.updated_at, children.id, children.owner_sub, children.name, children.birthday, children.interests, children.avatar_id 
FROM children 
WHERE children.id = $1::UUID AND children.owner_sub = $2::VARCHAR
2026-01-18 04:31:41 | INFO     | sqlalchemy.engine.Engine | [cached since 109.9s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), '3a26e22b-005d-4dc6-ac5f-bc66f95d8748')
2026-01-18 04:31:41 | INFO     | sqlalchemy.engine.Engine | SELECT age_ranges.id, age_ranges.code, age_ranges.name, age_ranges.min_age, age_ranges.max_age, age_ranges.is_active 
FROM age_ranges 
WHERE age_ranges.min_age <= $1::INTEGER AND (age_ranges.max_age IS NULL OR age_ranges.max_age >= $2::INTEGER) AND age_ranges.is_active = true
2026-01-18 04:31:41 | INFO     | sqlalchemy.engine.Engine | [cached since 109.8s ago] (8, 8)
2026-01-18 04:31:41 | INFO     | sqlalchemy.engine.Engine | SELECT outdoor_activities.id, outdoor_activities.name, outdoor_activities.category, outdoor_activities.icon, outdoor_activities.time, outdoor_activities.points, outdoor_activities.is_daily, outdoor_activities.tags, outdoor_activities.age_range_id 
FROM outdoor_activities 
WHERE outdoor_activities.age_range_id = $1::UUID ORDER BY CASE WHEN (coalesce(outdoor_activities.tags, '[]'::jsonb) ? $2::VARCHAR) THEN $3::INTEGER WHEN (coalesce(outdoor_activities.tags, '[]'::jsonb) ? $4::VARCHAR) THEN $5::INTEGER WHEN $6::BOOLEAN THEN $7::INTEGER END, random()
2026-01-18 04:31:41 | INFO     | sqlalchemy.engine.Engine | [generated in 0.00038s] (UUID('1aea8d41-8a9a-4631-a8d7-b8ef59d74bfc'), '6ebfd6e5-43e6-497b-8c95-5f15c0e31748', 0, 'e2fa00e3-022b-47b7-a0ed-550719f4e0ef', 0, True, 1)
2026-01-18 04:31:41 | INFO     | uvicorn.access | 10.3.6.1:0 - "GET /v1/outdoor/activities?childId=767166ac-39ef-4412-b0f5-72998235b319 HTTP/1.1" 200
2026-01-18 04:31:41 | INFO     | sqlalchemy.engine.Engine | ROLLBACK
2026-01-18 04:31:43 | INFO     | sqlalchemy.engine.Engine | BEGIN (implicit)
2026-01-18 04:31:43 | INFO     | sqlalchemy.engine.Engine | SELECT children.created_at, children.updated_at, children.id, children.owner_sub, children.name, children.birthday, children.interests, children.avatar_id 
FROM children 
WHERE children.id = $1::UUID AND children.owner_sub = $2::VARCHAR
2026-01-18 04:31:43 | INFO     | sqlalchemy.engine.Engine | [cached since 111.5s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), '3a26e22b-005d-4dc6-ac5f-bc66f95d8748')
2026-01-18 04:31:43 | INFO     | sqlalchemy.engine.Engine | SELECT age_ranges.id, age_ranges.code, age_ranges.name, age_ranges.min_age, age_ranges.max_age, age_ranges.is_active 
FROM age_ranges 
WHERE age_ranges.min_age <= $1::INTEGER AND (age_ranges.max_age IS NULL OR age_ranges.max_age >= $2::INTEGER) AND age_ranges.is_active = true
2026-01-18 04:31:43 | INFO     | sqlalchemy.engine.Engine | [cached since 111.3s ago] (8, 8)
2026-01-18 04:31:43 | INFO     | sqlalchemy.engine.Engine | SELECT chores.id, chores.label, chores.icon, chores.is_extra, chores.tags, chores.age_range_id 
FROM chores 
WHERE chores.is_extra = false AND chores.age_range_id = $1::UUID ORDER BY CASE WHEN (coalesce(chores.tags, '[]'::jsonb) ? $2::VARCHAR) THEN $3::INTEGER WHEN (coalesce(chores.tags, '[]'::jsonb) ? $4::VARCHAR) THEN $5::INTEGER WHEN $6::BOOLEAN THEN $7::INTEGER END, random()
2026-01-18 04:31:43 | INFO     | sqlalchemy.engine.Engine | [generated in 0.00084s] (UUID('1aea8d41-8a9a-4631-a8d7-b8ef59d74bfc'), '6ebfd6e5-43e6-497b-8c95-5f15c0e31748', 0, 'e2fa00e3-022b-47b7-a0ed-550719f4e0ef', 0, True, 1)
2026-01-18 04:31:43 | INFO     | uvicorn.access | 10.3.6.1:0 - "GET /v1/chores/daily?childId=767166ac-39ef-4412-b0f5-72998235b319 HTTP/1.1" 200
2026-01-18 04:31:43 | INFO     | sqlalchemy.engine.Engine | ROLLBACK
2026-01-18 04:32:40 | INFO     | sqlalchemy.engine.Engine | BEGIN (implicit)
2026-01-18 04:32:40 | INFO     | sqlalchemy.engine.Engine | SELECT children.created_at, children.updated_at, children.id, children.owner_sub, children.name, children.birthday, children.interests, children.avatar_id 
FROM children 
WHERE children.id = $1::UUID AND children.owner_sub = $2::VARCHAR
2026-01-18 04:32:40 | INFO     | sqlalchemy.engine.Engine | [cached since 169s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), '3a26e22b-005d-4dc6-ac5f-bc66f95d8748')
2026-01-18 04:32:40 | INFO     | mybuddy.api | event_flashcard: start child_id=767166ac-39ef-4412-b0f5-72998235b319 flashcardId=a8f73cc0-930c-4185-90c8-4eb7da08222d correct=True
2026-01-18 04:32:40 | INFO     | sqlalchemy.engine.Engine | SELECT points_values.id, points_values.code, points_values.name, points_values.points, points_values.is_active 
FROM points_values 
WHERE points_values.is_active = true
2026-01-18 04:32:40 | INFO     | sqlalchemy.engine.Engine | [cached since 169s ago] ()
2026-01-18 04:32:40 | INFO     | sqlalchemy.engine.Engine | SELECT flashcards.id, flashcards.subject_id, flashcards.question, flashcards.choices, flashcards.explanations, flashcards.correct_index, flashcards.difficulty_code, flashcards.tags, flashcards.age_range_id 
FROM flashcards 
WHERE flashcards.id = $1::UUID
2026-01-18 04:32:40 | INFO     | sqlalchemy.engine.Engine | [cached since 169s ago] (UUID('a8f73cc0-930c-4185-90c8-4eb7da08222d'),)
2026-01-18 04:32:40 | INFO     | mybuddy.api | event_flashcard: validated child_id=767166ac-39ef-4412-b0f5-72998235b319 flashcardId=a8f73cc0-930c-4185-90c8-4eb7da08222d subject_id=73c23c39-1a46-4a0a-9f0d-6b8f44a61635 points=10
2026-01-18 04:32:40 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.id, subjects.code, subjects.name, subjects.icon, subjects.color 
FROM subjects 
WHERE subjects.id = $1::UUID
2026-01-18 04:32:40 | INFO     | sqlalchemy.engine.Engine | [cached since 169s ago] (UUID('73c23c39-1a46-4a0a-9f0d-6b8f44a61635'),)
2026-01-18 04:32:40 | INFO     | sqlalchemy.engine.Engine | SAVEPOINT sa_savepoint_1
2026-01-18 04:32:40 | INFO     | sqlalchemy.engine.Engine | [no key 0.00060s] ()
2026-01-18 04:32:40 | INFO     | sqlalchemy.engine.Engine | INSERT INTO child_activity_events (child_id, kind, subject_id, flashcard_id, chore_id, outdoor_activity_id, affirmation_id, points, correct, answer, meta) VALUES ($1::UUID, $2::VARCHAR, $3::UUID, $4::UUID, $5::UUID, $6::UUID, $7::UUID, $8::INTEGER, $9::BOOLEAN, $10::VARCHAR, $11::JSONB) RETURNING child_activity_events.id, child_activity_events.created_at
2026-01-18 04:32:40 | INFO     | sqlalchemy.engine.Engine | [cached since 169s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), 'flashcard', UUID('73c23c39-1a46-4a0a-9f0d-6b8f44a61635'), UUID('a8f73cc0-930c-4185-90c8-4eb7da08222d'), None, None, None, 10, True, '7,397', '{"dedupeKey": "flashcard:a8f73cc0-930c-4185-90c8-4eb7da08222d", "flashcardId": "a8f73cc0-930c-4185-90c8-4eb7da08222d", "subjectId": "73c23c39-1a46-4a0a-9f0d-6b8f44a61635", "correct": true, "answer": "7,397", "points": 10}')
2026-01-18 04:32:40 | INFO     | sqlalchemy.engine.Engine | RELEASE SAVEPOINT sa_savepoint_1
2026-01-18 04:32:40 | INFO     | sqlalchemy.engine.Engine | [no key 0.00058s] ()
2026-01-18 04:32:40 | INFO     | mybuddy.api | event_flashcard: inserted_event child_id=767166ac-39ef-4412-b0f5-72998235b319
2026-01-18 04:32:40 | INFO     | sqlalchemy.engine.Engine | SELECT difficulty_thresholds.id, difficulty_thresholds.code, difficulty_thresholds.name, difficulty_thresholds.label, difficulty_thresholds.icon, difficulty_thresholds.color, difficulty_thresholds.threshold, difficulty_thresholds.is_active 
FROM difficulty_thresholds 
WHERE difficulty_thresholds.is_active = true
2026-01-18 04:32:40 | INFO     | sqlalchemy.engine.Engine | [cached since 169s ago] ()
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | SELECT child_subject_difficulty.child_id, child_subject_difficulty.subject_id, child_subject_difficulty.difficulty_code, child_subject_difficulty.last_updated 
FROM child_subject_difficulty 
WHERE child_subject_difficulty.child_id = $1::UUID AND child_subject_difficulty.subject_id = $2::UUID
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | [cached since 169s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), UUID('73c23c39-1a46-4a0a-9f0d-6b8f44a61635'))
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | SELECT child_subject_streaks.child_id, child_subject_streaks.subject_id, child_subject_streaks.current_streak, child_subject_streaks.longest_streak, child_subject_streaks.last_updated 
FROM child_subject_streaks 
WHERE child_subject_streaks.child_id = $1::UUID AND child_subject_streaks.subject_id = $2::UUID
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | [cached since 169s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), UUID('73c23c39-1a46-4a0a-9f0d-6b8f44a61635'))
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | UPDATE child_subject_streaks SET current_streak=$1::INTEGER, last_updated=$2::TIMESTAMP WITH TIME ZONE WHERE child_subject_streaks.child_id = $3::UUID AND child_subject_streaks.subject_id = $4::UUID
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | [cached since 169s ago] (3, datetime.datetime(2026, 1, 18, 4, 32, 41, 17313, tzinfo=datetime.timezone.utc), UUID('767166ac-39ef-4412-b0f5-72998235b319'), UUID('73c23c39-1a46-4a0a-9f0d-6b8f44a61635'))
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | SELECT child_balanced_progress_counters.id, child_balanced_progress_counters.child_id, child_balanced_progress_counters.subject_code, child_balanced_progress_counters.correct_count, child_balanced_progress_counters.updated_at 
FROM child_balanced_progress_counters 
WHERE child_balanced_progress_counters.child_id = $1::UUID AND child_balanced_progress_counters.subject_code = $2::VARCHAR
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | [cached since 169s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), 'math')
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | UPDATE child_balanced_progress_counters SET correct_count=$1::INTEGER, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE child_balanced_progress_counters.id = $3::UUID
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | [cached since 169s ago] (17, datetime.datetime(2026, 1, 18, 4, 32, 41, 30732, tzinfo=datetime.timezone.utc), UUID('4cdd2f9d-ec9b-4704-8505-26aabc45a383'))
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | SELECT child_flashcard_performance.created_at, child_flashcard_performance.updated_at, child_flashcard_performance.child_id, child_flashcard_performance.flashcard_id, child_flashcard_performance.correct_count, child_flashcard_performance.incorrect_count, child_flashcard_performance.last_seen_at 
FROM child_flashcard_performance 
WHERE child_flashcard_performance.child_id = $1::UUID AND child_flashcard_performance.flashcard_id = $2::UUID
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | [cached since 169s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), UUID('a8f73cc0-930c-4185-90c8-4eb7da08222d'))
2026-01-18 04:32:41 | INFO     | mybuddy.api | event_flashcard: create_perf child_id=767166ac-39ef-4412-b0f5-72998235b319 flashcardId=a8f73cc0-930c-4185-90c8-4eb7da08222d correct=True
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | INSERT INTO child_flashcard_performance (child_id, flashcard_id, correct_count, incorrect_count, last_seen_at) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::INTEGER, $5::TIMESTAMP WITH TIME ZONE) RETURNING child_flashcard_performance.created_at, child_flashcard_performance.updated_at
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | [cached since 169s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), UUID('a8f73cc0-930c-4185-90c8-4eb7da08222d'), 1, 0, datetime.datetime(2026, 1, 18, 4, 32, 41, 42786, tzinfo=datetime.timezone.utc))
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | SELECT children.created_at, children.updated_at, children.id, children.owner_sub, children.name, children.birthday, children.interests, children.avatar_id 
FROM children 
WHERE children.id = $1::UUID
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | [cached since 169s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'),)
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | SELECT age_ranges.id, age_ranges.code, age_ranges.name, age_ranges.min_age, age_ranges.max_age, age_ranges.is_active 
FROM age_ranges 
WHERE age_ranges.min_age <= $1::INTEGER AND (age_ranges.max_age IS NULL OR age_ranges.max_age >= $2::INTEGER) AND age_ranges.is_active = true
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | [cached since 169s ago] (8, 8)
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code 
FROM subjects JOIN subject_age_ranges ON subjects.id = subject_age_ranges.subject_id 
WHERE subject_age_ranges.age_range_id = $1::UUID ORDER BY subjects.code
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | [cached since 169s ago] (UUID('1aea8d41-8a9a-4631-a8d7-b8ef59d74bfc'),)
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | SELECT child_progress.child_id, child_progress.total_points, child_progress.total_flashcards, child_progress.total_chores, child_progress.total_outdoor, child_progress.total_affirmations, child_progress.current_streak, child_progress.longest_streak, child_progress.last_active_date, child_progress.last_seen_at, child_progress.current_level, child_progress.subject_counts 
FROM child_progress 
WHERE child_progress.child_id = $1::UUID
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | [cached since 168.9s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'),)
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | SELECT level_thresholds.id, level_thresholds.name, level_thresholds.threshold, level_thresholds.icon, level_thresholds.color, level_thresholds.is_active 
FROM level_thresholds 
WHERE level_thresholds.is_active = true
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | [cached since 168.9s ago] ()
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | SELECT child_balanced_progress_counters.id, child_balanced_progress_counters.child_id, child_balanced_progress_counters.subject_code, child_balanced_progress_counters.correct_count, child_balanced_progress_counters.updated_at 
FROM child_balanced_progress_counters 
WHERE child_balanced_progress_counters.child_id = $1::UUID AND child_balanced_progress_counters.subject_code IN ($2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR)
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | [cached since 168.9s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), 'history', 'math', 'reading', 'science')
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | SELECT child_activity_events.kind, count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID GROUP BY child_activity_events.kind
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | [cached since 168.9s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'),)
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | SELECT coalesce(sum(child_activity_events.points), $1::INTEGER) AS coalesce_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $2::UUID
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | [cached since 168.9s ago] (0, UUID('767166ac-39ef-4412-b0f5-72998235b319'))
2026-01-18 04:32:41 | INFO     | mybuddy.api | progress_totals: child_id=767166ac-39ef-4412-b0f5-72998235b319 totalPoints=418 counts={'affirmation': 2, 'flashcard': 48}
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | SELECT child_activity_events.kind, count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.created_at >= $2::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $3::TIMESTAMP WITH TIME ZONE GROUP BY child_activity_events.kind
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | [cached since 168.9s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | SELECT coalesce(sum(child_activity_events.points), $1::INTEGER) AS coalesce_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $2::UUID AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | [cached since 168.9s ago] (0, UUID('767166ac-39ef-4412-b0f5-72998235b319'), datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | SELECT count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.kind = $2::VARCHAR AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE AND child_activity_events.correct = true
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | [cached since 168.9s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), 'flashcard', datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:32:41 | INFO     | mybuddy.api | progress_today: child_id=767166ac-39ef-4412-b0f5-72998235b319 date=2026-01-17 counts={'affirmation': 2, 'flashcard': 48} flash_correct=39 totalPoints=418
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | SELECT difficulty_thresholds.code, difficulty_thresholds.threshold 
FROM difficulty_thresholds 
WHERE difficulty_thresholds.is_active = true
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | [cached since 168.9s ago] ()
2026-01-18 04:32:41 | INFO     | mybuddy.api | difficulty_thresholds: child_id=767166ac-39ef-4412-b0f5-72998235b319 thresholds={'easy': 0, 'medium': 25, 'hard': 50, 'impossible': 100}
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code AS subject_code, count(child_activity_events.id) AS completed, coalesce(sum(CASE WHEN (child_activity_events.correct = true) THEN $1::INTEGER ELSE $2::INTEGER END), $3::INTEGER) AS correct 
FROM child_activity_events JOIN subjects ON subjects.id = child_activity_events.subject_id 
WHERE child_activity_events.child_id = $4::UUID AND child_activity_events.kind = $5::VARCHAR GROUP BY subjects.code
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | [cached since 168.9s ago] (1, 0, 0, UUID('767166ac-39ef-4412-b0f5-72998235b319'), 'flashcard')
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code, child_subject_streaks.current_streak, child_subject_streaks.longest_streak 
FROM child_subject_streaks JOIN subjects ON subjects.id = child_subject_streaks.subject_id 
WHERE child_subject_streaks.child_id = $1::UUID
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | [cached since 168.9s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'),)
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code, child_subject_difficulty.difficulty_code 
FROM child_subject_difficulty JOIN subjects ON subjects.id = child_subject_difficulty.subject_id 
WHERE child_subject_difficulty.child_id = $1::UUID
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | [cached since 168.9s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'),)
2026-01-18 04:32:41 | INFO     | uvicorn.access | 10.3.6.1:0 - "OPTIONS /v1/children HTTP/1.1" 200
2026-01-18 04:32:41 | INFO     | mybuddy.api | subject_difficulty_map: child_id=767166ac-39ef-4412-b0f5-72998235b319 diff_map={'math': 'easy', 'science': 'easy', 'reading': 'easy', 'history': 'easy'}
2026-01-18 04:32:41 | INFO     | mybuddy.api | dashboard_flashcards_by_subject: child_id=767166ac-39ef-4412-b0f5-72998235b319 by_subject={'history': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 12, 'longestStreak': 18}, 'math': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 3, 'longestStreak': 6}, 'reading': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 0, 'longestStreak': 0}, 'science': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 2, 'longestStreak': 4}}
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | SELECT DISTINCT ((child_activity_events.created_at AT TIME ZONE 'America/New_York')::date) AS d 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.created_at >= $2::TIMESTAMP WITH TIME ZONE ORDER BY d DESC
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | [cached since 168.9s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), datetime.datetime(2025, 7, 21, 4, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:32:41 | INFO     | uvicorn.access | 10.3.6.1:0 - "OPTIONS /v1/children/b65a73c4-8de3-404d-b875-90fd93cccb11/dashboard HTTP/1.1" 200
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | SELECT achievements.created_at, achievements.updated_at, achievements.id, achievements.code, achievements.title, achievements.description, achievements.icon, achievements.achievement_type, achievements.points_threshold, achievements.streak_days_threshold, achievements.flashcards_count_threshold, achievements.chores_count_threshold, achievements.outdoor_count_threshold, achievements.is_active 
FROM achievements
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | [cached since 168.9s ago] ()
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | BEGIN (implicit)
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | SELECT avatars.id, avatars.name, avatars.image_path, avatars.is_active 
FROM avatars 
WHERE avatars.is_active = true
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | [generated in 0.00024s] ()
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | SELECT achievements.code 
FROM achievements JOIN child_achievements ON child_achievements.achievement_id = achievements.id 
WHERE child_achievements.child_id = $1::UUID
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | [cached since 169s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'),)
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | BEGIN (implicit)
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | SELECT interests.id, interests.name, interests.label, interests.icon, interests.is_active 
FROM interests 
WHERE interests.is_active = true
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | [generated in 0.00025s] ()
2026-01-18 04:32:41 | INFO     | mybuddy.api | event_flashcard: commit child_id=767166ac-39ef-4412-b0f5-72998235b319 points=10 newAchievementCodes=[]
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | COMMIT
2026-01-18 04:32:41 | WARNING  | mybuddy.api | Request potential issue
2026-01-18 04:32:41 | INFO     | uvicorn.access | 10.3.6.1:0 - "GET /v1/children HTTP/1.1" 401
2026-01-18 04:32:41 | WARNING  | mybuddy.api | Request potential issue
2026-01-18 04:32:41 | INFO     | uvicorn.access | 10.3.6.1:0 - "GET /v1/children/b65a73c4-8de3-404d-b875-90fd93cccb11/dashboard HTTP/1.1" 401
2026-01-18 04:32:41 | INFO     | uvicorn.access | 10.3.6.1:0 - "GET /v1/avatars HTTP/1.1" 200
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | ROLLBACK
2026-01-18 04:32:41 | INFO     | mybuddy.api | event_flashcard: success child_id=767166ac-39ef-4412-b0f5-72998235b319
2026-01-18 04:32:41 | INFO     | uvicorn.access | 10.3.6.1:0 - "GET /v1/interests HTTP/1.1" 200
2026-01-18 04:32:41 | INFO     | uvicorn.access | 10.3.6.1:0 - "POST /v1/children/767166ac-39ef-4412-b0f5-72998235b319/events/flashcard HTTP/1.1" 200
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | ROLLBACK
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | BEGIN (implicit)
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | SELECT children.created_at, children.updated_at, children.id, children.owner_sub, children.name, children.birthday, children.interests, children.avatar_id 
FROM children 
WHERE children.owner_sub = $1::VARCHAR ORDER BY children.created_at DESC
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | [generated in 0.00066s] ('fb84a374-66ee-4698-b7ba-f1334bb61d0f',)
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | BEGIN (implicit)
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | SELECT children.created_at, children.updated_at, children.id, children.owner_sub, children.name, children.birthday, children.interests, children.avatar_id 
FROM children 
WHERE children.id = $1::UUID AND children.owner_sub = $2::VARCHAR
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | [cached since 169.6s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), 'fb84a374-66ee-4698-b7ba-f1334bb61d0f')
2026-01-18 04:32:41 | INFO     | uvicorn.access | 10.3.6.1:0 - "GET /v1/children HTTP/1.1" 200
2026-01-18 04:32:41 | INFO     | mybuddy.api | build_dashboard: start child_id=b65a73c4-8de3-404d-b875-90fd93cccb11
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | SELECT child_activity_events.kind, count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID GROUP BY child_activity_events.kind
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | [cached since 169.4s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'),)
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | ROLLBACK
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | SELECT coalesce(sum(child_activity_events.points), $1::INTEGER) AS coalesce_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $2::UUID
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | [cached since 169.4s ago] (0, UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'))
2026-01-18 04:32:41 | INFO     | mybuddy.api | progress_totals: child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 totalPoints=75 counts={'affirmation': 8, 'chore': 1, 'outdoor': 1}
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | SELECT child_activity_events.kind, count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.created_at >= $2::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $3::TIMESTAMP WITH TIME ZONE GROUP BY child_activity_events.kind
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | [cached since 169.4s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | SELECT coalesce(sum(child_activity_events.points), $1::INTEGER) AS coalesce_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $2::UUID AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | [cached since 169.4s ago] (0, UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | SELECT count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.kind = $2::VARCHAR AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE AND child_activity_events.correct = true
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | [cached since 169.4s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), 'flashcard', datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:32:41 | INFO     | mybuddy.api | progress_today: child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 date=2026-01-17 counts={'affirmation': 8, 'chore': 1, 'outdoor': 1} flash_correct=0 totalPoints=75
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | SELECT coalesce(sum(child_activity_events.points), $1::INTEGER) AS coalesce_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $2::UUID AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | [cached since 169.4s ago] (0, UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), datetime.datetime(2026, 1, 11, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | SELECT count(DISTINCT ((child_activity_events.created_at AT TIME ZONE 'America/New_York')::date)) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.created_at >= $2::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $3::TIMESTAMP WITH TIME ZONE
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | [cached since 167.7s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), datetime.datetime(2026, 1, 11, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | SELECT child_activity_events.kind, count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.created_at >= $2::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $3::TIMESTAMP WITH TIME ZONE GROUP BY child_activity_events.kind
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | [cached since 169.4s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), datetime.datetime(2026, 1, 11, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | SELECT count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.kind = $2::VARCHAR AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE AND child_activity_events.correct = true
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | [cached since 169.4s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), 'flashcard', datetime.datetime(2026, 1, 11, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:32:41 | INFO     | mybuddy.api | progress_week: child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 weekStart=2026-01-11 counts={'affirmation': 8, 'chore': 1, 'outdoor': 1} flash_correct=0 accuracyPct=0 totalPoints=75 daysActive=1
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | SELECT DISTINCT child_activity_events.chore_id 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.kind = $2::VARCHAR AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE AND child_activity_events.chore_id IS NOT NULL
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | [cached since 167.7s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), 'chore', datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | SELECT DISTINCT child_activity_events.outdoor_activity_id 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.kind = $2::VARCHAR AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE AND child_activity_events.outdoor_activity_id IS NOT NULL
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | [cached since 167.7s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), 'outdoor', datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | SELECT children.created_at, children.updated_at, children.id, children.owner_sub, children.name, children.birthday, children.interests, children.avatar_id 
FROM children 
WHERE children.id = $1::UUID
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | [cached since 169.5s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'),)
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | SELECT age_ranges.id, age_ranges.code, age_ranges.name, age_ranges.min_age, age_ranges.max_age, age_ranges.is_active 
FROM age_ranges 
WHERE age_ranges.min_age <= $1::INTEGER AND (age_ranges.max_age IS NULL OR age_ranges.max_age >= $2::INTEGER) AND age_ranges.is_active = true
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | [cached since 169.5s ago] (8, 8)
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code 
FROM subjects JOIN subject_age_ranges ON subjects.id = subject_age_ranges.subject_id 
WHERE subject_age_ranges.age_range_id = $1::UUID ORDER BY subjects.code
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | [cached since 169.5s ago] (UUID('1aea8d41-8a9a-4631-a8d7-b8ef59d74bfc'),)
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | SELECT difficulty_thresholds.code, difficulty_thresholds.threshold 
FROM difficulty_thresholds 
WHERE difficulty_thresholds.is_active = true
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | [cached since 169.4s ago] ()
2026-01-18 04:32:41 | INFO     | mybuddy.api | difficulty_thresholds: child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 thresholds={'easy': 0, 'medium': 25, 'hard': 50, 'impossible': 100}
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code AS subject_code, count(child_activity_events.id) AS completed, coalesce(sum(CASE WHEN (child_activity_events.correct = true) THEN $1::INTEGER ELSE $2::INTEGER END), $3::INTEGER) AS correct 
FROM child_activity_events JOIN subjects ON subjects.id = child_activity_events.subject_id 
WHERE child_activity_events.child_id = $4::UUID AND child_activity_events.kind = $5::VARCHAR GROUP BY subjects.code
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | [cached since 169.4s ago] (1, 0, 0, UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), 'flashcard')
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code, child_subject_streaks.current_streak, child_subject_streaks.longest_streak 
FROM child_subject_streaks JOIN subjects ON subjects.id = child_subject_streaks.subject_id 
WHERE child_subject_streaks.child_id = $1::UUID
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | [cached since 169.4s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'),)
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code, child_subject_difficulty.difficulty_code 
FROM child_subject_difficulty JOIN subjects ON subjects.id = child_subject_difficulty.subject_id 
WHERE child_subject_difficulty.child_id = $1::UUID
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | [cached since 169.4s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'),)
2026-01-18 04:32:41 | INFO     | mybuddy.api | subject_difficulty_map: child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 diff_map={'math': 'easy', 'science': 'easy', 'reading': 'easy', 'history': 'easy'}
2026-01-18 04:32:41 | INFO     | mybuddy.api | dashboard_flashcards_by_subject: child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 by_subject={'history': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 0, 'longestStreak': 0}, 'math': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 0, 'longestStreak': 0}, 'reading': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 0, 'longestStreak': 0}, 'science': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 0, 'longestStreak': 0}}
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | SELECT DISTINCT ((child_activity_events.created_at AT TIME ZONE 'America/New_York')::date) AS d 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.created_at >= $2::TIMESTAMP WITH TIME ZONE ORDER BY d DESC
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | [cached since 169.4s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), datetime.datetime(2025, 7, 21, 4, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | SELECT level_thresholds.id, level_thresholds.name, level_thresholds.threshold, level_thresholds.icon, level_thresholds.color, level_thresholds.is_active 
FROM level_thresholds 
WHERE level_thresholds.is_active = true
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | [cached since 169.5s ago] ()
2026-01-18 04:32:41 | INFO     | mybuddy.api | build_dashboard: loaded child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 core_subjects=['history', 'math', 'reading', 'science'] by_subject_keys=['history', 'math', 'reading', 'science'] totalPoints=75
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | SELECT child_balanced_progress_counters.id, child_balanced_progress_counters.child_id, child_balanced_progress_counters.subject_code, child_balanced_progress_counters.correct_count, child_balanced_progress_counters.updated_at 
FROM child_balanced_progress_counters 
WHERE child_balanced_progress_counters.child_id = $1::UUID
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | [cached since 167.7s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'),)
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | SELECT child_progress.child_id, child_progress.total_points, child_progress.total_flashcards, child_progress.total_chores, child_progress.total_outdoor, child_progress.total_affirmations, child_progress.current_streak, child_progress.longest_streak, child_progress.last_active_date, child_progress.last_seen_at, child_progress.current_level, child_progress.subject_counts 
FROM child_progress 
WHERE child_progress.child_id = $1::UUID
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | [cached since 169.6s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'),)
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | SELECT achievements.code, child_achievements.unlocked_at 
FROM achievements JOIN child_achievements ON child_achievements.achievement_id = achievements.id 
WHERE child_achievements.child_id = $1::UUID
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | [cached since 167.7s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'),)
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | SELECT achievements.created_at, achievements.updated_at, achievements.id, achievements.code, achievements.title, achievements.description, achievements.icon, achievements.achievement_type, achievements.points_threshold, achievements.streak_days_threshold, achievements.flashcards_count_threshold, achievements.chores_count_threshold, achievements.outdoor_count_threshold, achievements.is_active 
FROM achievements
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | [cached since 169.5s ago] ()
2026-01-18 04:32:41 | INFO     | mybuddy.api | build_dashboard: end child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 unlocked=2 locked=18
2026-01-18 04:32:41 | INFO     | uvicorn.access | 10.3.6.1:0 - "GET /v1/children/b65a73c4-8de3-404d-b875-90fd93cccb11/dashboard HTTP/1.1" 200
2026-01-18 04:32:41 | INFO     | sqlalchemy.engine.Engine | ROLLBACK
2026-01-18 04:32:42 | INFO     | sqlalchemy.engine.Engine | BEGIN (implicit)
2026-01-18 04:32:42 | INFO     | sqlalchemy.engine.Engine | SELECT children.created_at, children.updated_at, children.id, children.owner_sub, children.name, children.birthday, children.interests, children.avatar_id 
FROM children 
WHERE children.id = $1::UUID AND children.owner_sub = $2::VARCHAR
2026-01-18 04:32:42 | INFO     | sqlalchemy.engine.Engine | [cached since 171s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), '3a26e22b-005d-4dc6-ac5f-bc66f95d8748')
2026-01-18 04:32:42 | INFO     | mybuddy.api | build_dashboard: start child_id=767166ac-39ef-4412-b0f5-72998235b319
2026-01-18 04:32:42 | INFO     | sqlalchemy.engine.Engine | SELECT child_activity_events.kind, count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID GROUP BY child_activity_events.kind
2026-01-18 04:32:42 | INFO     | sqlalchemy.engine.Engine | [cached since 170.8s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'),)
2026-01-18 04:32:42 | INFO     | sqlalchemy.engine.Engine | SELECT coalesce(sum(child_activity_events.points), $1::INTEGER) AS coalesce_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $2::UUID
2026-01-18 04:32:42 | INFO     | sqlalchemy.engine.Engine | [cached since 170.8s ago] (0, UUID('767166ac-39ef-4412-b0f5-72998235b319'))
2026-01-18 04:32:42 | INFO     | mybuddy.api | progress_totals: child_id=767166ac-39ef-4412-b0f5-72998235b319 totalPoints=418 counts={'affirmation': 2, 'flashcard': 48}
2026-01-18 04:32:42 | INFO     | sqlalchemy.engine.Engine | SELECT child_activity_events.kind, count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.created_at >= $2::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $3::TIMESTAMP WITH TIME ZONE GROUP BY child_activity_events.kind
2026-01-18 04:32:42 | INFO     | sqlalchemy.engine.Engine | [cached since 170.8s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:32:42 | INFO     | sqlalchemy.engine.Engine | SELECT coalesce(sum(child_activity_events.points), $1::INTEGER) AS coalesce_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $2::UUID AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE
2026-01-18 04:32:42 | INFO     | sqlalchemy.engine.Engine | [cached since 170.8s ago] (0, UUID('767166ac-39ef-4412-b0f5-72998235b319'), datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:32:42 | INFO     | sqlalchemy.engine.Engine | SELECT count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.kind = $2::VARCHAR AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE AND child_activity_events.correct = true
2026-01-18 04:32:42 | INFO     | sqlalchemy.engine.Engine | [cached since 170.8s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), 'flashcard', datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:32:42 | INFO     | mybuddy.api | progress_today: child_id=767166ac-39ef-4412-b0f5-72998235b319 date=2026-01-17 counts={'affirmation': 2, 'flashcard': 48} flash_correct=39 totalPoints=418
2026-01-18 04:32:42 | INFO     | sqlalchemy.engine.Engine | SELECT coalesce(sum(child_activity_events.points), $1::INTEGER) AS coalesce_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $2::UUID AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE
2026-01-18 04:32:42 | INFO     | sqlalchemy.engine.Engine | [cached since 170.8s ago] (0, UUID('767166ac-39ef-4412-b0f5-72998235b319'), datetime.datetime(2026, 1, 11, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:32:42 | INFO     | sqlalchemy.engine.Engine | SELECT count(DISTINCT ((child_activity_events.created_at AT TIME ZONE 'America/New_York')::date)) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.created_at >= $2::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $3::TIMESTAMP WITH TIME ZONE
2026-01-18 04:32:42 | INFO     | sqlalchemy.engine.Engine | [cached since 169.1s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), datetime.datetime(2026, 1, 11, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:32:42 | INFO     | sqlalchemy.engine.Engine | SELECT child_activity_events.kind, count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.created_at >= $2::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $3::TIMESTAMP WITH TIME ZONE GROUP BY child_activity_events.kind
2026-01-18 04:32:42 | INFO     | sqlalchemy.engine.Engine | [cached since 170.8s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), datetime.datetime(2026, 1, 11, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:32:42 | INFO     | sqlalchemy.engine.Engine | SELECT count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.kind = $2::VARCHAR AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE AND child_activity_events.correct = true
2026-01-18 04:32:42 | INFO     | sqlalchemy.engine.Engine | [cached since 170.8s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), 'flashcard', datetime.datetime(2026, 1, 11, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:32:42 | INFO     | mybuddy.api | progress_week: child_id=767166ac-39ef-4412-b0f5-72998235b319 weekStart=2026-01-11 counts={'affirmation': 2, 'flashcard': 48} flash_correct=39 accuracyPct=81 totalPoints=418 daysActive=1
2026-01-18 04:32:42 | INFO     | sqlalchemy.engine.Engine | SELECT DISTINCT child_activity_events.chore_id 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.kind = $2::VARCHAR AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE AND child_activity_events.chore_id IS NOT NULL
2026-01-18 04:32:42 | INFO     | sqlalchemy.engine.Engine | [cached since 169.1s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), 'chore', datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:32:42 | INFO     | sqlalchemy.engine.Engine | SELECT DISTINCT child_activity_events.outdoor_activity_id 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.kind = $2::VARCHAR AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE AND child_activity_events.outdoor_activity_id IS NOT NULL
2026-01-18 04:32:42 | INFO     | sqlalchemy.engine.Engine | [cached since 169.1s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), 'outdoor', datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:32:43 | INFO     | sqlalchemy.engine.Engine | SELECT children.created_at, children.updated_at, children.id, children.owner_sub, children.name, children.birthday, children.interests, children.avatar_id 
FROM children 
WHERE children.id = $1::UUID
2026-01-18 04:32:43 | INFO     | sqlalchemy.engine.Engine | [cached since 170.9s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'),)
2026-01-18 04:32:43 | INFO     | sqlalchemy.engine.Engine | SELECT age_ranges.id, age_ranges.code, age_ranges.name, age_ranges.min_age, age_ranges.max_age, age_ranges.is_active 
FROM age_ranges 
WHERE age_ranges.min_age <= $1::INTEGER AND (age_ranges.max_age IS NULL OR age_ranges.max_age >= $2::INTEGER) AND age_ranges.is_active = true
2026-01-18 04:32:43 | INFO     | sqlalchemy.engine.Engine | [cached since 170.9s ago] (8, 8)
2026-01-18 04:32:43 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code 
FROM subjects JOIN subject_age_ranges ON subjects.id = subject_age_ranges.subject_id 
WHERE subject_age_ranges.age_range_id = $1::UUID ORDER BY subjects.code
2026-01-18 04:32:43 | INFO     | sqlalchemy.engine.Engine | [cached since 170.9s ago] (UUID('1aea8d41-8a9a-4631-a8d7-b8ef59d74bfc'),)
2026-01-18 04:32:43 | INFO     | sqlalchemy.engine.Engine | SELECT difficulty_thresholds.code, difficulty_thresholds.threshold 
FROM difficulty_thresholds 
WHERE difficulty_thresholds.is_active = true
2026-01-18 04:32:43 | INFO     | sqlalchemy.engine.Engine | [cached since 170.8s ago] ()
2026-01-18 04:32:43 | INFO     | mybuddy.api | difficulty_thresholds: child_id=767166ac-39ef-4412-b0f5-72998235b319 thresholds={'easy': 0, 'medium': 25, 'hard': 50, 'impossible': 100}
2026-01-18 04:32:43 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code AS subject_code, count(child_activity_events.id) AS completed, coalesce(sum(CASE WHEN (child_activity_events.correct = true) THEN $1::INTEGER ELSE $2::INTEGER END), $3::INTEGER) AS correct 
FROM child_activity_events JOIN subjects ON subjects.id = child_activity_events.subject_id 
WHERE child_activity_events.child_id = $4::UUID AND child_activity_events.kind = $5::VARCHAR GROUP BY subjects.code
2026-01-18 04:32:43 | INFO     | sqlalchemy.engine.Engine | [cached since 170.8s ago] (1, 0, 0, UUID('767166ac-39ef-4412-b0f5-72998235b319'), 'flashcard')
2026-01-18 04:32:43 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code, child_subject_streaks.current_streak, child_subject_streaks.longest_streak 
FROM child_subject_streaks JOIN subjects ON subjects.id = child_subject_streaks.subject_id 
WHERE child_subject_streaks.child_id = $1::UUID
2026-01-18 04:32:43 | INFO     | sqlalchemy.engine.Engine | [cached since 170.8s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'),)
2026-01-18 04:32:43 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code, child_subject_difficulty.difficulty_code 
FROM child_subject_difficulty JOIN subjects ON subjects.id = child_subject_difficulty.subject_id 
WHERE child_subject_difficulty.child_id = $1::UUID
2026-01-18 04:32:43 | INFO     | sqlalchemy.engine.Engine | [cached since 170.8s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'),)
2026-01-18 04:32:43 | INFO     | mybuddy.api | subject_difficulty_map: child_id=767166ac-39ef-4412-b0f5-72998235b319 diff_map={'math': 'easy', 'science': 'easy', 'reading': 'easy', 'history': 'easy'}
2026-01-18 04:32:43 | INFO     | mybuddy.api | dashboard_flashcards_by_subject: child_id=767166ac-39ef-4412-b0f5-72998235b319 by_subject={'history': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 12, 'longestStreak': 18}, 'math': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 3, 'longestStreak': 6}, 'reading': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 0, 'longestStreak': 0}, 'science': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 2, 'longestStreak': 4}}
2026-01-18 04:32:43 | INFO     | sqlalchemy.engine.Engine | SELECT DISTINCT ((child_activity_events.created_at AT TIME ZONE 'America/New_York')::date) AS d 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.created_at >= $2::TIMESTAMP WITH TIME ZONE ORDER BY d DESC
2026-01-18 04:32:43 | INFO     | sqlalchemy.engine.Engine | [cached since 170.8s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), datetime.datetime(2025, 7, 21, 4, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:32:43 | INFO     | sqlalchemy.engine.Engine | SELECT level_thresholds.id, level_thresholds.name, level_thresholds.threshold, level_thresholds.icon, level_thresholds.color, level_thresholds.is_active 
FROM level_thresholds 
WHERE level_thresholds.is_active = true
2026-01-18 04:32:43 | INFO     | sqlalchemy.engine.Engine | [cached since 170.9s ago] ()
2026-01-18 04:32:43 | INFO     | mybuddy.api | build_dashboard: loaded child_id=767166ac-39ef-4412-b0f5-72998235b319 core_subjects=['history', 'math', 'reading', 'science'] by_subject_keys=['history', 'math', 'reading', 'science'] totalPoints=418
2026-01-18 04:32:43 | INFO     | sqlalchemy.engine.Engine | SELECT child_balanced_progress_counters.id, child_balanced_progress_counters.child_id, child_balanced_progress_counters.subject_code, child_balanced_progress_counters.correct_count, child_balanced_progress_counters.updated_at 
FROM child_balanced_progress_counters 
WHERE child_balanced_progress_counters.child_id = $1::UUID
2026-01-18 04:32:43 | INFO     | sqlalchemy.engine.Engine | [cached since 169.1s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'),)
2026-01-18 04:32:43 | INFO     | sqlalchemy.engine.Engine | SELECT child_progress.child_id, child_progress.total_points, child_progress.total_flashcards, child_progress.total_chores, child_progress.total_outdoor, child_progress.total_affirmations, child_progress.current_streak, child_progress.longest_streak, child_progress.last_active_date, child_progress.last_seen_at, child_progress.current_level, child_progress.subject_counts 
FROM child_progress 
WHERE child_progress.child_id = $1::UUID
2026-01-18 04:32:43 | INFO     | sqlalchemy.engine.Engine | [cached since 171s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'),)
2026-01-18 04:32:43 | INFO     | sqlalchemy.engine.Engine | SELECT achievements.code, child_achievements.unlocked_at 
FROM achievements JOIN child_achievements ON child_achievements.achievement_id = achievements.id 
WHERE child_achievements.child_id = $1::UUID
2026-01-18 04:32:43 | INFO     | sqlalchemy.engine.Engine | [cached since 169.1s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'),)
2026-01-18 04:32:43 | INFO     | sqlalchemy.engine.Engine | SELECT achievements.created_at, achievements.updated_at, achievements.id, achievements.code, achievements.title, achievements.description, achievements.icon, achievements.achievement_type, achievements.points_threshold, achievements.streak_days_threshold, achievements.flashcards_count_threshold, achievements.chores_count_threshold, achievements.outdoor_count_threshold, achievements.is_active 
FROM achievements
2026-01-18 04:32:43 | INFO     | sqlalchemy.engine.Engine | [cached since 170.9s ago] ()
2026-01-18 04:32:43 | INFO     | mybuddy.api | build_dashboard: end child_id=767166ac-39ef-4412-b0f5-72998235b319 unlocked=3 locked=17
2026-01-18 04:32:43 | INFO     | uvicorn.access | 10.3.6.1:0 - "GET /v1/children/767166ac-39ef-4412-b0f5-72998235b319/dashboard HTTP/1.1" 200
2026-01-18 04:32:43 | INFO     | sqlalchemy.engine.Engine | ROLLBACK
2026-01-18 04:32:43 | INFO     | sqlalchemy.engine.Engine | BEGIN (implicit)
2026-01-18 04:32:43 | INFO     | sqlalchemy.engine.Engine | SELECT children.created_at, children.updated_at, children.id, children.owner_sub, children.name, children.birthday, children.interests, children.avatar_id 
FROM children 
WHERE children.id = $1::UUID AND children.owner_sub = $2::VARCHAR
2026-01-18 04:32:43 | INFO     | sqlalchemy.engine.Engine | [cached since 171.3s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), 'fb84a374-66ee-4698-b7ba-f1334bb61d0f')
2026-01-18 04:32:43 | INFO     | sqlalchemy.engine.Engine | SELECT age_ranges.id, age_ranges.code, age_ranges.name, age_ranges.min_age, age_ranges.max_age, age_ranges.is_active 
FROM age_ranges 
WHERE age_ranges.min_age <= $1::INTEGER AND (age_ranges.max_age IS NULL OR age_ranges.max_age >= $2::INTEGER) AND age_ranges.is_active = true
2026-01-18 04:32:43 | INFO     | sqlalchemy.engine.Engine | [cached since 171.2s ago] (8, 8)
2026-01-18 04:32:43 | INFO     | mybuddy.api | list_affirmations: child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 age_range_id=1aea8d41-8a9a-4631-a8d7-b8ef59d74bfc interests=['cef77ae5-6e4d-487e-8569-1cca10556c82']
2026-01-18 04:32:43 | INFO     | sqlalchemy.engine.Engine | SELECT affirmations.id, affirmations.text, affirmations.image, affirmations.gradient_0, affirmations.gradient_1, affirmations.tags, affirmations.age_range_id 
FROM affirmations 
WHERE affirmations.age_range_id = $1::UUID ORDER BY CASE WHEN (coalesce(affirmations.tags, '[]'::jsonb) ? $2::VARCHAR) THEN $3::INTEGER WHEN $4::BOOLEAN THEN $5::INTEGER END, random()
2026-01-18 04:32:43 | INFO     | sqlalchemy.engine.Engine | [generated in 0.00073s] (UUID('1aea8d41-8a9a-4631-a8d7-b8ef59d74bfc'), 'cef77ae5-6e4d-487e-8569-1cca10556c82', 0, True, 1)
2026-01-18 04:32:43 | INFO     | uvicorn.access | 10.3.6.1:0 - "GET /v1/affirmations?childId=b65a73c4-8de3-404d-b875-90fd93cccb11 HTTP/1.1" 200
2026-01-18 04:32:43 | INFO     | sqlalchemy.engine.Engine | ROLLBACK
2026-01-18 04:32:43 | INFO     | sqlalchemy.engine.Engine | BEGIN (implicit)
2026-01-18 04:32:43 | INFO     | sqlalchemy.engine.Engine | SELECT children.created_at, children.updated_at, children.id, children.owner_sub, children.name, children.birthday, children.interests, children.avatar_id 
FROM children 
WHERE children.id = $1::UUID AND children.owner_sub = $2::VARCHAR
2026-01-18 04:32:43 | INFO     | sqlalchemy.engine.Engine | [cached since 171.7s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), 'fb84a374-66ee-4698-b7ba-f1334bb61d0f')
2026-01-18 04:32:43 | INFO     | mybuddy.api | event_affirmation: start child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 affirmationId=9d34ae5d-60ad-429a-8317-172897d516d9
2026-01-18 04:32:43 | INFO     | sqlalchemy.engine.Engine | SELECT points_values.id, points_values.code, points_values.name, points_values.points, points_values.is_active 
FROM points_values 
WHERE points_values.is_active = true
2026-01-18 04:32:43 | INFO     | sqlalchemy.engine.Engine | [cached since 171.7s ago] ()
2026-01-18 04:32:43 | INFO     | sqlalchemy.engine.Engine | SAVEPOINT sa_savepoint_1
2026-01-18 04:32:43 | INFO     | sqlalchemy.engine.Engine | [no key 0.00053s] ()
2026-01-18 04:32:43 | INFO     | sqlalchemy.engine.Engine | INSERT INTO child_activity_events (child_id, kind, subject_id, flashcard_id, chore_id, outdoor_activity_id, affirmation_id, points, correct, answer, meta) VALUES ($1::UUID, $2::VARCHAR, $3::UUID, $4::UUID, $5::UUID, $6::UUID, $7::UUID, $8::INTEGER, $9::BOOLEAN, $10::VARCHAR, $11::JSONB) RETURNING child_activity_events.id, child_activity_events.created_at
2026-01-18 04:32:43 | INFO     | sqlalchemy.engine.Engine | [cached since 171.6s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), 'affirmation', None, None, None, None, UUID('9d34ae5d-60ad-429a-8317-172897d516d9'), 5, None, None, '{"dedupeKey": "affirmation:9d34ae5d-60ad-429a-8317-172897d516d9", "affirmationId": "9d34ae5d-60ad-429a-8317-172897d516d9", "points": 5}')
2026-01-18 04:32:43 | INFO     | sqlalchemy.engine.Engine | ROLLBACK TO SAVEPOINT sa_savepoint_1
2026-01-18 04:32:43 | INFO     | sqlalchemy.engine.Engine | [no key 0.00059s] ()
2026-01-18 04:32:43 | INFO     | mybuddy.api | event_affirmation: deduped child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 affirmationId=9d34ae5d-60ad-429a-8317-172897d516d9
2026-01-18 04:32:43 | INFO     | uvicorn.access | 10.3.6.1:0 - "POST /v1/children/b65a73c4-8de3-404d-b875-90fd93cccb11/events/affirmation HTTP/1.1" 200
2026-01-18 04:32:43 | INFO     | sqlalchemy.engine.Engine | ROLLBACK
2026-01-18 04:32:45 | INFO     | sqlalchemy.engine.Engine | BEGIN (implicit)
2026-01-18 04:32:45 | INFO     | sqlalchemy.engine.Engine | SELECT children.created_at, children.updated_at, children.id, children.owner_sub, children.name, children.birthday, children.interests, children.avatar_id 
FROM children 
WHERE children.id = $1::UUID AND children.owner_sub = $2::VARCHAR
2026-01-18 04:32:45 | INFO     | sqlalchemy.engine.Engine | [cached since 173.3s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), 'fb84a374-66ee-4698-b7ba-f1334bb61d0f')
2026-01-18 04:32:45 | INFO     | mybuddy.api | build_dashboard: start child_id=b65a73c4-8de3-404d-b875-90fd93cccb11
2026-01-18 04:32:45 | INFO     | sqlalchemy.engine.Engine | SELECT child_activity_events.kind, count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID GROUP BY child_activity_events.kind
2026-01-18 04:32:45 | INFO     | sqlalchemy.engine.Engine | [cached since 173.2s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'),)
2026-01-18 04:32:45 | INFO     | sqlalchemy.engine.Engine | SELECT coalesce(sum(child_activity_events.points), $1::INTEGER) AS coalesce_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $2::UUID
2026-01-18 04:32:45 | INFO     | sqlalchemy.engine.Engine | [cached since 173.2s ago] (0, UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'))
2026-01-18 04:32:45 | INFO     | mybuddy.api | progress_totals: child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 totalPoints=75 counts={'affirmation': 8, 'chore': 1, 'outdoor': 1}
2026-01-18 04:32:45 | INFO     | sqlalchemy.engine.Engine | SELECT child_activity_events.kind, count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.created_at >= $2::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $3::TIMESTAMP WITH TIME ZONE GROUP BY child_activity_events.kind
2026-01-18 04:32:45 | INFO     | sqlalchemy.engine.Engine | [cached since 173.2s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:32:45 | INFO     | sqlalchemy.engine.Engine | SELECT coalesce(sum(child_activity_events.points), $1::INTEGER) AS coalesce_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $2::UUID AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE
2026-01-18 04:32:45 | INFO     | sqlalchemy.engine.Engine | [cached since 173.2s ago] (0, UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:32:45 | INFO     | sqlalchemy.engine.Engine | SELECT count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.kind = $2::VARCHAR AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE AND child_activity_events.correct = true
2026-01-18 04:32:45 | INFO     | sqlalchemy.engine.Engine | [cached since 173.2s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), 'flashcard', datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:32:45 | INFO     | mybuddy.api | progress_today: child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 date=2026-01-17 counts={'affirmation': 8, 'chore': 1, 'outdoor': 1} flash_correct=0 totalPoints=75
2026-01-18 04:32:45 | INFO     | sqlalchemy.engine.Engine | SELECT coalesce(sum(child_activity_events.points), $1::INTEGER) AS coalesce_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $2::UUID AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE
2026-01-18 04:32:45 | INFO     | sqlalchemy.engine.Engine | [cached since 173.2s ago] (0, UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), datetime.datetime(2026, 1, 11, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:32:45 | INFO     | sqlalchemy.engine.Engine | SELECT count(DISTINCT ((child_activity_events.created_at AT TIME ZONE 'America/New_York')::date)) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.created_at >= $2::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $3::TIMESTAMP WITH TIME ZONE
2026-01-18 04:32:45 | INFO     | sqlalchemy.engine.Engine | [cached since 171.4s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), datetime.datetime(2026, 1, 11, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:32:45 | INFO     | sqlalchemy.engine.Engine | SELECT child_activity_events.kind, count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.created_at >= $2::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $3::TIMESTAMP WITH TIME ZONE GROUP BY child_activity_events.kind
2026-01-18 04:32:45 | INFO     | sqlalchemy.engine.Engine | [cached since 173.2s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), datetime.datetime(2026, 1, 11, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:32:45 | INFO     | sqlalchemy.engine.Engine | SELECT count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.kind = $2::VARCHAR AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE AND child_activity_events.correct = true
2026-01-18 04:32:45 | INFO     | sqlalchemy.engine.Engine | [cached since 173.2s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), 'flashcard', datetime.datetime(2026, 1, 11, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:32:45 | INFO     | mybuddy.api | progress_week: child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 weekStart=2026-01-11 counts={'affirmation': 8, 'chore': 1, 'outdoor': 1} flash_correct=0 accuracyPct=0 totalPoints=75 daysActive=1
2026-01-18 04:32:45 | INFO     | sqlalchemy.engine.Engine | SELECT DISTINCT child_activity_events.chore_id 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.kind = $2::VARCHAR AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE AND child_activity_events.chore_id IS NOT NULL
2026-01-18 04:32:45 | INFO     | sqlalchemy.engine.Engine | [cached since 171.4s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), 'chore', datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:32:45 | INFO     | sqlalchemy.engine.Engine | SELECT DISTINCT child_activity_events.outdoor_activity_id 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.kind = $2::VARCHAR AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE AND child_activity_events.outdoor_activity_id IS NOT NULL
2026-01-18 04:32:45 | INFO     | sqlalchemy.engine.Engine | [cached since 171.4s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), 'outdoor', datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:32:45 | INFO     | sqlalchemy.engine.Engine | SELECT children.created_at, children.updated_at, children.id, children.owner_sub, children.name, children.birthday, children.interests, children.avatar_id 
FROM children 
WHERE children.id = $1::UUID
2026-01-18 04:32:45 | INFO     | sqlalchemy.engine.Engine | [cached since 173.3s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'),)
2026-01-18 04:32:45 | INFO     | sqlalchemy.engine.Engine | SELECT age_ranges.id, age_ranges.code, age_ranges.name, age_ranges.min_age, age_ranges.max_age, age_ranges.is_active 
FROM age_ranges 
WHERE age_ranges.min_age <= $1::INTEGER AND (age_ranges.max_age IS NULL OR age_ranges.max_age >= $2::INTEGER) AND age_ranges.is_active = true
2026-01-18 04:32:45 | INFO     | sqlalchemy.engine.Engine | [cached since 173.3s ago] (8, 8)
2026-01-18 04:32:45 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code 
FROM subjects JOIN subject_age_ranges ON subjects.id = subject_age_ranges.subject_id 
WHERE subject_age_ranges.age_range_id = $1::UUID ORDER BY subjects.code
2026-01-18 04:32:45 | INFO     | sqlalchemy.engine.Engine | [cached since 173.3s ago] (UUID('1aea8d41-8a9a-4631-a8d7-b8ef59d74bfc'),)
2026-01-18 04:32:45 | INFO     | sqlalchemy.engine.Engine | SELECT difficulty_thresholds.code, difficulty_thresholds.threshold 
FROM difficulty_thresholds 
WHERE difficulty_thresholds.is_active = true
2026-01-18 04:32:45 | INFO     | sqlalchemy.engine.Engine | [cached since 173.2s ago] ()
2026-01-18 04:32:45 | INFO     | mybuddy.api | difficulty_thresholds: child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 thresholds={'easy': 0, 'medium': 25, 'hard': 50, 'impossible': 100}
2026-01-18 04:32:45 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code AS subject_code, count(child_activity_events.id) AS completed, coalesce(sum(CASE WHEN (child_activity_events.correct = true) THEN $1::INTEGER ELSE $2::INTEGER END), $3::INTEGER) AS correct 
FROM child_activity_events JOIN subjects ON subjects.id = child_activity_events.subject_id 
WHERE child_activity_events.child_id = $4::UUID AND child_activity_events.kind = $5::VARCHAR GROUP BY subjects.code
2026-01-18 04:32:45 | INFO     | sqlalchemy.engine.Engine | [cached since 173.2s ago] (1, 0, 0, UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), 'flashcard')
2026-01-18 04:32:45 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code, child_subject_streaks.current_streak, child_subject_streaks.longest_streak 
FROM child_subject_streaks JOIN subjects ON subjects.id = child_subject_streaks.subject_id 
WHERE child_subject_streaks.child_id = $1::UUID
2026-01-18 04:32:45 | INFO     | sqlalchemy.engine.Engine | [cached since 173.2s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'),)
2026-01-18 04:32:45 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code, child_subject_difficulty.difficulty_code 
FROM child_subject_difficulty JOIN subjects ON subjects.id = child_subject_difficulty.subject_id 
WHERE child_subject_difficulty.child_id = $1::UUID
2026-01-18 04:32:45 | INFO     | sqlalchemy.engine.Engine | [cached since 173.2s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'),)
2026-01-18 04:32:45 | INFO     | mybuddy.api | subject_difficulty_map: child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 diff_map={'math': 'easy', 'science': 'easy', 'reading': 'easy', 'history': 'easy'}
2026-01-18 04:32:45 | INFO     | mybuddy.api | dashboard_flashcards_by_subject: child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 by_subject={'history': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 0, 'longestStreak': 0}, 'math': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 0, 'longestStreak': 0}, 'reading': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 0, 'longestStreak': 0}, 'science': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 0, 'longestStreak': 0}}
2026-01-18 04:32:45 | INFO     | sqlalchemy.engine.Engine | SELECT DISTINCT ((child_activity_events.created_at AT TIME ZONE 'America/New_York')::date) AS d 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.created_at >= $2::TIMESTAMP WITH TIME ZONE ORDER BY d DESC
2026-01-18 04:32:45 | INFO     | sqlalchemy.engine.Engine | [cached since 173.2s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), datetime.datetime(2025, 7, 21, 4, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:32:45 | INFO     | sqlalchemy.engine.Engine | SELECT level_thresholds.id, level_thresholds.name, level_thresholds.threshold, level_thresholds.icon, level_thresholds.color, level_thresholds.is_active 
FROM level_thresholds 
WHERE level_thresholds.is_active = true
2026-01-18 04:32:45 | INFO     | sqlalchemy.engine.Engine | [cached since 173.3s ago] ()
2026-01-18 04:32:45 | INFO     | mybuddy.api | build_dashboard: loaded child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 core_subjects=['history', 'math', 'reading', 'science'] by_subject_keys=['history', 'math', 'reading', 'science'] totalPoints=75
2026-01-18 04:32:45 | INFO     | sqlalchemy.engine.Engine | SELECT child_balanced_progress_counters.id, child_balanced_progress_counters.child_id, child_balanced_progress_counters.subject_code, child_balanced_progress_counters.correct_count, child_balanced_progress_counters.updated_at 
FROM child_balanced_progress_counters 
WHERE child_balanced_progress_counters.child_id = $1::UUID
2026-01-18 04:32:45 | INFO     | sqlalchemy.engine.Engine | [cached since 171.4s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'),)
2026-01-18 04:32:45 | INFO     | sqlalchemy.engine.Engine | SELECT child_progress.child_id, child_progress.total_points, child_progress.total_flashcards, child_progress.total_chores, child_progress.total_outdoor, child_progress.total_affirmations, child_progress.current_streak, child_progress.longest_streak, child_progress.last_active_date, child_progress.last_seen_at, child_progress.current_level, child_progress.subject_counts 
FROM child_progress 
WHERE child_progress.child_id = $1::UUID
2026-01-18 04:32:45 | INFO     | sqlalchemy.engine.Engine | [cached since 173.3s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'),)
2026-01-18 04:32:45 | INFO     | sqlalchemy.engine.Engine | SELECT achievements.code, child_achievements.unlocked_at 
FROM achievements JOIN child_achievements ON child_achievements.achievement_id = achievements.id 
WHERE child_achievements.child_id = $1::UUID
2026-01-18 04:32:45 | INFO     | sqlalchemy.engine.Engine | [cached since 171.4s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'),)
2026-01-18 04:32:45 | INFO     | sqlalchemy.engine.Engine | SELECT achievements.created_at, achievements.updated_at, achievements.id, achievements.code, achievements.title, achievements.description, achievements.icon, achievements.achievement_type, achievements.points_threshold, achievements.streak_days_threshold, achievements.flashcards_count_threshold, achievements.chores_count_threshold, achievements.outdoor_count_threshold, achievements.is_active 
FROM achievements
2026-01-18 04:32:45 | INFO     | sqlalchemy.engine.Engine | [cached since 173.2s ago] ()
2026-01-18 04:32:45 | INFO     | mybuddy.api | build_dashboard: end child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 unlocked=2 locked=18
2026-01-18 04:32:45 | INFO     | uvicorn.access | 10.3.6.1:0 - "GET /v1/children/b65a73c4-8de3-404d-b875-90fd93cccb11/dashboard HTTP/1.1" 200
2026-01-18 04:32:45 | INFO     | sqlalchemy.engine.Engine | ROLLBACK
2026-01-18 04:32:47 | INFO     | uvicorn.access | 10.3.6.1:0 - "OPTIONS /v1/children/b65a73c4-8de3-404d-b875-90fd93cccb11 HTTP/1.1" 200
2026-01-18 04:32:47 | INFO     | uvicorn.access | 10.3.6.1:0 - "OPTIONS /v1/subjects?childId=b65a73c4-8de3-404d-b875-90fd93cccb11 HTTP/1.1" 200
2026-01-18 04:32:47 | INFO     | uvicorn.access | 10.3.6.1:0 - "OPTIONS /v1/difficulties HTTP/1.1" 200
2026-01-18 04:32:47 | INFO     | sqlalchemy.engine.Engine | BEGIN (implicit)
2026-01-18 04:32:47 | INFO     | sqlalchemy.engine.Engine | SELECT avatars.id, avatars.name, avatars.image_path, avatars.is_active 
FROM avatars 
WHERE avatars.is_active = true
2026-01-18 04:32:47 | INFO     | sqlalchemy.engine.Engine | [cached since 5.739s ago] ()
2026-01-18 04:32:47 | INFO     | sqlalchemy.engine.Engine | BEGIN (implicit)
2026-01-18 04:32:47 | INFO     | sqlalchemy.engine.Engine | SELECT children.created_at, children.updated_at, children.id, children.owner_sub, children.name, children.birthday, children.interests, children.avatar_id 
FROM children 
WHERE children.id = $1::UUID AND children.owner_sub = $2::VARCHAR
2026-01-18 04:32:47 | INFO     | sqlalchemy.engine.Engine | [cached since 175.1s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), 'fb84a374-66ee-4698-b7ba-f1334bb61d0f')
2026-01-18 04:32:47 | INFO     | mybuddy.api | build_dashboard: start child_id=b65a73c4-8de3-404d-b875-90fd93cccb11
2026-01-18 04:32:47 | INFO     | sqlalchemy.engine.Engine | SELECT child_activity_events.kind, count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID GROUP BY child_activity_events.kind
2026-01-18 04:32:47 | INFO     | sqlalchemy.engine.Engine | [cached since 174.9s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'),)
2026-01-18 04:32:47 | INFO     | uvicorn.access | 10.3.6.1:0 - "GET /v1/avatars HTTP/1.1" 200
2026-01-18 04:32:47 | INFO     | sqlalchemy.engine.Engine | ROLLBACK
2026-01-18 04:32:47 | INFO     | sqlalchemy.engine.Engine | SELECT coalesce(sum(child_activity_events.points), $1::INTEGER) AS coalesce_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $2::UUID
2026-01-18 04:32:47 | INFO     | sqlalchemy.engine.Engine | [cached since 174.9s ago] (0, UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'))
2026-01-18 04:32:47 | INFO     | mybuddy.api | progress_totals: child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 totalPoints=75 counts={'affirmation': 8, 'chore': 1, 'outdoor': 1}
2026-01-18 04:32:47 | INFO     | sqlalchemy.engine.Engine | SELECT child_activity_events.kind, count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.created_at >= $2::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $3::TIMESTAMP WITH TIME ZONE GROUP BY child_activity_events.kind
2026-01-18 04:32:47 | INFO     | sqlalchemy.engine.Engine | [cached since 174.9s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:32:47 | INFO     | sqlalchemy.engine.Engine | SELECT coalesce(sum(child_activity_events.points), $1::INTEGER) AS coalesce_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $2::UUID AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE
2026-01-18 04:32:47 | INFO     | sqlalchemy.engine.Engine | [cached since 174.9s ago] (0, UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:32:47 | INFO     | sqlalchemy.engine.Engine | SELECT count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.kind = $2::VARCHAR AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE AND child_activity_events.correct = true
2026-01-18 04:32:47 | INFO     | sqlalchemy.engine.Engine | [cached since 174.9s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), 'flashcard', datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:32:47 | INFO     | mybuddy.api | progress_today: child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 date=2026-01-17 counts={'affirmation': 8, 'chore': 1, 'outdoor': 1} flash_correct=0 totalPoints=75
2026-01-18 04:32:47 | INFO     | sqlalchemy.engine.Engine | SELECT coalesce(sum(child_activity_events.points), $1::INTEGER) AS coalesce_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $2::UUID AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE
2026-01-18 04:32:47 | INFO     | sqlalchemy.engine.Engine | [cached since 174.9s ago] (0, UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), datetime.datetime(2026, 1, 11, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:32:47 | INFO     | sqlalchemy.engine.Engine | SELECT count(DISTINCT ((child_activity_events.created_at AT TIME ZONE 'America/New_York')::date)) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.created_at >= $2::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $3::TIMESTAMP WITH TIME ZONE
2026-01-18 04:32:47 | INFO     | sqlalchemy.engine.Engine | [cached since 173.2s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), datetime.datetime(2026, 1, 11, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:32:47 | INFO     | sqlalchemy.engine.Engine | SELECT child_activity_events.kind, count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.created_at >= $2::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $3::TIMESTAMP WITH TIME ZONE GROUP BY child_activity_events.kind
2026-01-18 04:32:47 | INFO     | sqlalchemy.engine.Engine | [cached since 174.9s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), datetime.datetime(2026, 1, 11, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:32:47 | INFO     | sqlalchemy.engine.Engine | SELECT count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.kind = $2::VARCHAR AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE AND child_activity_events.correct = true
2026-01-18 04:32:47 | INFO     | sqlalchemy.engine.Engine | [cached since 174.9s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), 'flashcard', datetime.datetime(2026, 1, 11, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:32:47 | INFO     | sqlalchemy.engine.Engine | BEGIN (implicit)
2026-01-18 04:32:47 | INFO     | sqlalchemy.engine.Engine | SELECT difficulty_thresholds.id, difficulty_thresholds.code, difficulty_thresholds.name, difficulty_thresholds.label, difficulty_thresholds.icon, difficulty_thresholds.color, difficulty_thresholds.threshold, difficulty_thresholds.is_active 
FROM difficulty_thresholds 
WHERE difficulty_thresholds.is_active = true
2026-01-18 04:32:47 | INFO     | sqlalchemy.engine.Engine | [generated in 0.00047s] ()
2026-01-18 04:32:47 | INFO     | mybuddy.api | progress_week: child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 weekStart=2026-01-11 counts={'affirmation': 8, 'chore': 1, 'outdoor': 1} flash_correct=0 accuracyPct=0 totalPoints=75 daysActive=1
2026-01-18 04:32:47 | INFO     | sqlalchemy.engine.Engine | SELECT DISTINCT child_activity_events.chore_id 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.kind = $2::VARCHAR AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE AND child_activity_events.chore_id IS NOT NULL
2026-01-18 04:32:47 | INFO     | sqlalchemy.engine.Engine | [cached since 173.2s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), 'chore', datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:32:47 | INFO     | sqlalchemy.engine.Engine | BEGIN (implicit)
2026-01-18 04:32:47 | INFO     | sqlalchemy.engine.Engine | SELECT children.created_at, children.updated_at, children.id, children.owner_sub, children.name, children.birthday, children.interests, children.avatar_id 
FROM children 
WHERE children.id = $1::UUID AND children.owner_sub = $2::VARCHAR
2026-01-18 04:32:47 | INFO     | sqlalchemy.engine.Engine | [cached since 175.2s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), 'fb84a374-66ee-4698-b7ba-f1334bb61d0f')
2026-01-18 04:32:47 | INFO     | sqlalchemy.engine.Engine | SELECT DISTINCT child_activity_events.outdoor_activity_id 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.kind = $2::VARCHAR AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE AND child_activity_events.outdoor_activity_id IS NOT NULL
2026-01-18 04:32:47 | INFO     | sqlalchemy.engine.Engine | [cached since 173.2s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), 'outdoor', datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:32:47 | INFO     | sqlalchemy.engine.Engine | SELECT children.created_at, children.updated_at, children.id, children.owner_sub, children.name, children.birthday, children.interests, children.avatar_id 
FROM children 
WHERE children.id = $1::UUID
2026-01-18 04:32:47 | INFO     | sqlalchemy.engine.Engine | [cached since 175.1s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'),)
2026-01-18 04:32:47 | INFO     | uvicorn.access | 10.3.6.1:0 - "GET /v1/difficulties HTTP/1.1" 200
2026-01-18 04:32:47 | INFO     | uvicorn.access | 10.3.6.1:0 - "GET /v1/children/b65a73c4-8de3-404d-b875-90fd93cccb11 HTTP/1.1" 200
2026-01-18 04:32:47 | INFO     | sqlalchemy.engine.Engine | SELECT age_ranges.id, age_ranges.code, age_ranges.name, age_ranges.min_age, age_ranges.max_age, age_ranges.is_active 
FROM age_ranges 
WHERE age_ranges.min_age <= $1::INTEGER AND (age_ranges.max_age IS NULL OR age_ranges.max_age >= $2::INTEGER) AND age_ranges.is_active = true
2026-01-18 04:32:47 | INFO     | sqlalchemy.engine.Engine | [cached since 175.1s ago] (8, 8)
2026-01-18 04:32:47 | INFO     | sqlalchemy.engine.Engine | BEGIN (implicit)
2026-01-18 04:32:47 | INFO     | sqlalchemy.engine.Engine | SELECT children.created_at, children.updated_at, children.id, children.owner_sub, children.name, children.birthday, children.interests, children.avatar_id 
FROM children 
WHERE children.id = $1::UUID AND children.owner_sub = $2::VARCHAR
2026-01-18 04:32:47 | INFO     | sqlalchemy.engine.Engine | [cached since 175.2s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), 'fb84a374-66ee-4698-b7ba-f1334bb61d0f')
2026-01-18 04:32:47 | INFO     | sqlalchemy.engine.Engine | ROLLBACK
2026-01-18 04:32:47 | INFO     | sqlalchemy.engine.Engine | ROLLBACK
2026-01-18 04:32:47 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code 
FROM subjects JOIN subject_age_ranges ON subjects.id = subject_age_ranges.subject_id 
WHERE subject_age_ranges.age_range_id = $1::UUID ORDER BY subjects.code
2026-01-18 04:32:47 | INFO     | sqlalchemy.engine.Engine | [cached since 175.1s ago] (UUID('1aea8d41-8a9a-4631-a8d7-b8ef59d74bfc'),)
2026-01-18 04:32:47 | INFO     | sqlalchemy.engine.Engine | SELECT difficulty_thresholds.code, difficulty_thresholds.threshold 
FROM difficulty_thresholds 
WHERE difficulty_thresholds.is_active = true
2026-01-18 04:32:47 | INFO     | sqlalchemy.engine.Engine | [cached since 175s ago] ()
2026-01-18 04:32:47 | INFO     | mybuddy.api | difficulty_thresholds: child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 thresholds={'easy': 0, 'medium': 25, 'hard': 50, 'impossible': 100}
2026-01-18 04:32:47 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code AS subject_code, count(child_activity_events.id) AS completed, coalesce(sum(CASE WHEN (child_activity_events.correct = true) THEN $1::INTEGER ELSE $2::INTEGER END), $3::INTEGER) AS correct 
FROM child_activity_events JOIN subjects ON subjects.id = child_activity_events.subject_id 
WHERE child_activity_events.child_id = $4::UUID AND child_activity_events.kind = $5::VARCHAR GROUP BY subjects.code
2026-01-18 04:32:47 | INFO     | sqlalchemy.engine.Engine | [cached since 175s ago] (1, 0, 0, UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), 'flashcard')
2026-01-18 04:32:47 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code, child_subject_streaks.current_streak, child_subject_streaks.longest_streak 
FROM child_subject_streaks JOIN subjects ON subjects.id = child_subject_streaks.subject_id 
WHERE child_subject_streaks.child_id = $1::UUID
2026-01-18 04:32:47 | INFO     | sqlalchemy.engine.Engine | [cached since 175s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'),)
2026-01-18 04:32:47 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code, child_subject_difficulty.difficulty_code 
FROM child_subject_difficulty JOIN subjects ON subjects.id = child_subject_difficulty.subject_id 
WHERE child_subject_difficulty.child_id = $1::UUID
2026-01-18 04:32:47 | INFO     | sqlalchemy.engine.Engine | [cached since 175s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'),)
2026-01-18 04:32:47 | INFO     | mybuddy.api | list_subjects: child_id=b65a73c4-8de3-404d-b875-90fd93cccb11
2026-01-18 04:32:47 | INFO     | sqlalchemy.engine.Engine | SELECT age_ranges.id, age_ranges.code, age_ranges.name, age_ranges.min_age, age_ranges.max_age, age_ranges.is_active 
FROM age_ranges 
WHERE age_ranges.min_age <= $1::INTEGER AND (age_ranges.max_age IS NULL OR age_ranges.max_age >= $2::INTEGER) AND age_ranges.is_active = true
2026-01-18 04:32:47 | INFO     | sqlalchemy.engine.Engine | [cached since 175.1s ago] (8, 8)
2026-01-18 04:32:47 | INFO     | mybuddy.api | subject_difficulty_map: child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 diff_map={'math': 'easy', 'science': 'easy', 'reading': 'easy', 'history': 'easy'}
2026-01-18 04:32:47 | INFO     | mybuddy.api | dashboard_flashcards_by_subject: child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 by_subject={'history': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 0, 'longestStreak': 0}, 'math': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 0, 'longestStreak': 0}, 'reading': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 0, 'longestStreak': 0}, 'science': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 0, 'longestStreak': 0}}
2026-01-18 04:32:47 | INFO     | sqlalchemy.engine.Engine | SELECT DISTINCT ((child_activity_events.created_at AT TIME ZONE 'America/New_York')::date) AS d 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.created_at >= $2::TIMESTAMP WITH TIME ZONE ORDER BY d DESC
2026-01-18 04:32:47 | INFO     | sqlalchemy.engine.Engine | [cached since 175s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), datetime.datetime(2025, 7, 21, 4, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:32:47 | INFO     | sqlalchemy.engine.Engine | SELECT level_thresholds.id, level_thresholds.name, level_thresholds.threshold, level_thresholds.icon, level_thresholds.color, level_thresholds.is_active 
FROM level_thresholds 
WHERE level_thresholds.is_active = true
2026-01-18 04:32:47 | INFO     | sqlalchemy.engine.Engine | [cached since 175.1s ago] ()
2026-01-18 04:32:47 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.id, subjects.code, subjects.name, subjects.icon, subjects.color 
FROM subjects JOIN subject_age_ranges ON subjects.id = subject_age_ranges.subject_id 
WHERE subject_age_ranges.age_range_id = $1::UUID ORDER BY subjects.name ASC
2026-01-18 04:32:47 | INFO     | sqlalchemy.engine.Engine | [generated in 0.00029s] (UUID('1aea8d41-8a9a-4631-a8d7-b8ef59d74bfc'),)
2026-01-18 04:32:47 | INFO     | mybuddy.api | build_dashboard: loaded child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 core_subjects=['history', 'math', 'reading', 'science'] by_subject_keys=['history', 'math', 'reading', 'science'] totalPoints=75
2026-01-18 04:32:47 | INFO     | sqlalchemy.engine.Engine | SELECT child_balanced_progress_counters.id, child_balanced_progress_counters.child_id, child_balanced_progress_counters.subject_code, child_balanced_progress_counters.correct_count, child_balanced_progress_counters.updated_at 
FROM child_balanced_progress_counters 
WHERE child_balanced_progress_counters.child_id = $1::UUID
2026-01-18 04:32:47 | INFO     | sqlalchemy.engine.Engine | [cached since 173.2s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'),)
2026-01-18 04:32:47 | INFO     | sqlalchemy.engine.Engine | SELECT child_progress.child_id, child_progress.total_points, child_progress.total_flashcards, child_progress.total_chores, child_progress.total_outdoor, child_progress.total_affirmations, child_progress.current_streak, child_progress.longest_streak, child_progress.last_active_date, child_progress.last_seen_at, child_progress.current_level, child_progress.subject_counts 
FROM child_progress 
WHERE child_progress.child_id = $1::UUID
2026-01-18 04:32:47 | INFO     | sqlalchemy.engine.Engine | [cached since 175.1s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'),)
2026-01-18 04:32:47 | INFO     | sqlalchemy.engine.Engine | SELECT achievements.code, child_achievements.unlocked_at 
FROM achievements JOIN child_achievements ON child_achievements.achievement_id = achievements.id 
WHERE child_achievements.child_id = $1::UUID
2026-01-18 04:32:47 | INFO     | sqlalchemy.engine.Engine | [cached since 173.2s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'),)
2026-01-18 04:32:47 | INFO     | mybuddy.api | list_subjects: returned count=4 child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 age_range_id=1aea8d41-8a9a-4631-a8d7-b8ef59d74bfc
2026-01-18 04:32:47 | INFO     | sqlalchemy.engine.Engine | SELECT achievements.created_at, achievements.updated_at, achievements.id, achievements.code, achievements.title, achievements.description, achievements.icon, achievements.achievement_type, achievements.points_threshold, achievements.streak_days_threshold, achievements.flashcards_count_threshold, achievements.chores_count_threshold, achievements.outdoor_count_threshold, achievements.is_active 
FROM achievements
2026-01-18 04:32:47 | INFO     | sqlalchemy.engine.Engine | [cached since 175s ago] ()
2026-01-18 04:32:47 | INFO     | uvicorn.access | 10.3.6.1:0 - "GET /v1/subjects?childId=b65a73c4-8de3-404d-b875-90fd93cccb11 HTTP/1.1" 200
2026-01-18 04:32:47 | INFO     | sqlalchemy.engine.Engine | ROLLBACK
2026-01-18 04:32:47 | INFO     | mybuddy.api | build_dashboard: end child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 unlocked=2 locked=18
2026-01-18 04:32:47 | INFO     | uvicorn.access | 10.3.6.1:0 - "GET /v1/children/b65a73c4-8de3-404d-b875-90fd93cccb11/dashboard HTTP/1.1" 200
2026-01-18 04:32:47 | INFO     | sqlalchemy.engine.Engine | ROLLBACK
2026-01-18 04:32:56 | INFO     | sqlalchemy.engine.Engine | BEGIN (implicit)
2026-01-18 04:32:56 | INFO     | sqlalchemy.engine.Engine | SELECT children.created_at, children.updated_at, children.id, children.owner_sub, children.name, children.birthday, children.interests, children.avatar_id 
FROM children 
WHERE children.id = $1::UUID AND children.owner_sub = $2::VARCHAR
2026-01-18 04:32:56 | INFO     | sqlalchemy.engine.Engine | [cached since 184.5s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), '3a26e22b-005d-4dc6-ac5f-bc66f95d8748')
2026-01-18 04:32:56 | INFO     | mybuddy.api | event_flashcard: start child_id=767166ac-39ef-4412-b0f5-72998235b319 flashcardId=a03a59ca-e13c-4053-aebf-f28342f181a3 correct=True
2026-01-18 04:32:56 | INFO     | sqlalchemy.engine.Engine | SELECT points_values.id, points_values.code, points_values.name, points_values.points, points_values.is_active 
FROM points_values 
WHERE points_values.is_active = true
2026-01-18 04:32:56 | INFO     | sqlalchemy.engine.Engine | [cached since 184.5s ago] ()
2026-01-18 04:32:56 | INFO     | sqlalchemy.engine.Engine | SELECT flashcards.id, flashcards.subject_id, flashcards.question, flashcards.choices, flashcards.explanations, flashcards.correct_index, flashcards.difficulty_code, flashcards.tags, flashcards.age_range_id 
FROM flashcards 
WHERE flashcards.id = $1::UUID
2026-01-18 04:32:56 | INFO     | sqlalchemy.engine.Engine | [cached since 184.5s ago] (UUID('a03a59ca-e13c-4053-aebf-f28342f181a3'),)
2026-01-18 04:32:56 | INFO     | mybuddy.api | event_flashcard: validated child_id=767166ac-39ef-4412-b0f5-72998235b319 flashcardId=a03a59ca-e13c-4053-aebf-f28342f181a3 subject_id=73c23c39-1a46-4a0a-9f0d-6b8f44a61635 points=10
2026-01-18 04:32:56 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.id, subjects.code, subjects.name, subjects.icon, subjects.color 
FROM subjects 
WHERE subjects.id = $1::UUID
2026-01-18 04:32:56 | INFO     | sqlalchemy.engine.Engine | [cached since 184.5s ago] (UUID('73c23c39-1a46-4a0a-9f0d-6b8f44a61635'),)
2026-01-18 04:32:56 | INFO     | sqlalchemy.engine.Engine | SAVEPOINT sa_savepoint_1
2026-01-18 04:32:56 | INFO     | sqlalchemy.engine.Engine | [no key 0.00059s] ()
2026-01-18 04:32:56 | INFO     | sqlalchemy.engine.Engine | INSERT INTO child_activity_events (child_id, kind, subject_id, flashcard_id, chore_id, outdoor_activity_id, affirmation_id, points, correct, answer, meta) VALUES ($1::UUID, $2::VARCHAR, $3::UUID, $4::UUID, $5::UUID, $6::UUID, $7::UUID, $8::INTEGER, $9::BOOLEAN, $10::VARCHAR, $11::JSONB) RETURNING child_activity_events.id, child_activity_events.created_at
2026-01-18 04:32:56 | INFO     | sqlalchemy.engine.Engine | [cached since 184.5s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), 'flashcard', UUID('73c23c39-1a46-4a0a-9f0d-6b8f44a61635'), UUID('a03a59ca-e13c-4053-aebf-f28342f181a3'), None, None, None, 10, True, '400,000', '{"dedupeKey": "flashcard:a03a59ca-e13c-4053-aebf-f28342f181a3", "flashcardId": "a03a59ca-e13c-4053-aebf-f28342f181a3", "subjectId": "73c23c39-1a46-4a0a-9f0d-6b8f44a61635", "correct": true, "answer": "400,000", "points": 10}')
2026-01-18 04:32:56 | INFO     | sqlalchemy.engine.Engine | RELEASE SAVEPOINT sa_savepoint_1
2026-01-18 04:32:56 | INFO     | sqlalchemy.engine.Engine | [no key 0.00060s] ()
2026-01-18 04:32:56 | INFO     | mybuddy.api | event_flashcard: inserted_event child_id=767166ac-39ef-4412-b0f5-72998235b319
2026-01-18 04:32:56 | INFO     | sqlalchemy.engine.Engine | SELECT difficulty_thresholds.id, difficulty_thresholds.code, difficulty_thresholds.name, difficulty_thresholds.label, difficulty_thresholds.icon, difficulty_thresholds.color, difficulty_thresholds.threshold, difficulty_thresholds.is_active 
FROM difficulty_thresholds 
WHERE difficulty_thresholds.is_active = true
2026-01-18 04:32:56 | INFO     | sqlalchemy.engine.Engine | [cached since 184.5s ago] ()
2026-01-18 04:32:56 | INFO     | sqlalchemy.engine.Engine | SELECT child_subject_difficulty.child_id, child_subject_difficulty.subject_id, child_subject_difficulty.difficulty_code, child_subject_difficulty.last_updated 
FROM child_subject_difficulty 
WHERE child_subject_difficulty.child_id = $1::UUID AND child_subject_difficulty.subject_id = $2::UUID
2026-01-18 04:32:56 | INFO     | sqlalchemy.engine.Engine | [cached since 184.4s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), UUID('73c23c39-1a46-4a0a-9f0d-6b8f44a61635'))
2026-01-18 04:32:56 | INFO     | sqlalchemy.engine.Engine | SELECT child_subject_streaks.child_id, child_subject_streaks.subject_id, child_subject_streaks.current_streak, child_subject_streaks.longest_streak, child_subject_streaks.last_updated 
FROM child_subject_streaks 
WHERE child_subject_streaks.child_id = $1::UUID AND child_subject_streaks.subject_id = $2::UUID
2026-01-18 04:32:56 | INFO     | sqlalchemy.engine.Engine | [cached since 184.4s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), UUID('73c23c39-1a46-4a0a-9f0d-6b8f44a61635'))
2026-01-18 04:32:56 | INFO     | sqlalchemy.engine.Engine | UPDATE child_subject_streaks SET current_streak=$1::INTEGER, last_updated=$2::TIMESTAMP WITH TIME ZONE WHERE child_subject_streaks.child_id = $3::UUID AND child_subject_streaks.subject_id = $4::UUID
2026-01-18 04:32:56 | INFO     | sqlalchemy.engine.Engine | [cached since 184.4s ago] (4, datetime.datetime(2026, 1, 18, 4, 32, 56, 482826, tzinfo=datetime.timezone.utc), UUID('767166ac-39ef-4412-b0f5-72998235b319'), UUID('73c23c39-1a46-4a0a-9f0d-6b8f44a61635'))
2026-01-18 04:32:56 | INFO     | sqlalchemy.engine.Engine | SELECT child_balanced_progress_counters.id, child_balanced_progress_counters.child_id, child_balanced_progress_counters.subject_code, child_balanced_progress_counters.correct_count, child_balanced_progress_counters.updated_at 
FROM child_balanced_progress_counters 
WHERE child_balanced_progress_counters.child_id = $1::UUID AND child_balanced_progress_counters.subject_code = $2::VARCHAR
2026-01-18 04:32:56 | INFO     | sqlalchemy.engine.Engine | [cached since 184.4s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), 'math')
2026-01-18 04:32:56 | INFO     | sqlalchemy.engine.Engine | UPDATE child_balanced_progress_counters SET correct_count=$1::INTEGER, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE child_balanced_progress_counters.id = $3::UUID
2026-01-18 04:32:56 | INFO     | sqlalchemy.engine.Engine | [cached since 184.4s ago] (18, datetime.datetime(2026, 1, 18, 4, 32, 56, 491508, tzinfo=datetime.timezone.utc), UUID('4cdd2f9d-ec9b-4704-8505-26aabc45a383'))
2026-01-18 04:32:56 | INFO     | sqlalchemy.engine.Engine | SELECT child_flashcard_performance.created_at, child_flashcard_performance.updated_at, child_flashcard_performance.child_id, child_flashcard_performance.flashcard_id, child_flashcard_performance.correct_count, child_flashcard_performance.incorrect_count, child_flashcard_performance.last_seen_at 
FROM child_flashcard_performance 
WHERE child_flashcard_performance.child_id = $1::UUID AND child_flashcard_performance.flashcard_id = $2::UUID
2026-01-18 04:32:56 | INFO     | sqlalchemy.engine.Engine | [cached since 184.4s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), UUID('a03a59ca-e13c-4053-aebf-f28342f181a3'))
2026-01-18 04:32:56 | INFO     | mybuddy.api | event_flashcard: create_perf child_id=767166ac-39ef-4412-b0f5-72998235b319 flashcardId=a03a59ca-e13c-4053-aebf-f28342f181a3 correct=True
2026-01-18 04:32:56 | INFO     | sqlalchemy.engine.Engine | INSERT INTO child_flashcard_performance (child_id, flashcard_id, correct_count, incorrect_count, last_seen_at) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::INTEGER, $5::TIMESTAMP WITH TIME ZONE) RETURNING child_flashcard_performance.created_at, child_flashcard_performance.updated_at
2026-01-18 04:32:56 | INFO     | sqlalchemy.engine.Engine | [cached since 184.4s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), UUID('a03a59ca-e13c-4053-aebf-f28342f181a3'), 1, 0, datetime.datetime(2026, 1, 18, 4, 32, 56, 499910, tzinfo=datetime.timezone.utc))
2026-01-18 04:32:56 | INFO     | sqlalchemy.engine.Engine | SELECT children.created_at, children.updated_at, children.id, children.owner_sub, children.name, children.birthday, children.interests, children.avatar_id 
FROM children 
WHERE children.id = $1::UUID
2026-01-18 04:32:56 | INFO     | sqlalchemy.engine.Engine | [cached since 184.4s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'),)
2026-01-18 04:32:56 | INFO     | sqlalchemy.engine.Engine | SELECT age_ranges.id, age_ranges.code, age_ranges.name, age_ranges.min_age, age_ranges.max_age, age_ranges.is_active 
FROM age_ranges 
WHERE age_ranges.min_age <= $1::INTEGER AND (age_ranges.max_age IS NULL OR age_ranges.max_age >= $2::INTEGER) AND age_ranges.is_active = true
2026-01-18 04:32:56 | INFO     | sqlalchemy.engine.Engine | [cached since 184.4s ago] (8, 8)
2026-01-18 04:32:56 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code 
FROM subjects JOIN subject_age_ranges ON subjects.id = subject_age_ranges.subject_id 
WHERE subject_age_ranges.age_range_id = $1::UUID ORDER BY subjects.code
2026-01-18 04:32:56 | INFO     | sqlalchemy.engine.Engine | [cached since 184.4s ago] (UUID('1aea8d41-8a9a-4631-a8d7-b8ef59d74bfc'),)
2026-01-18 04:32:56 | INFO     | sqlalchemy.engine.Engine | SELECT child_progress.child_id, child_progress.total_points, child_progress.total_flashcards, child_progress.total_chores, child_progress.total_outdoor, child_progress.total_affirmations, child_progress.current_streak, child_progress.longest_streak, child_progress.last_active_date, child_progress.last_seen_at, child_progress.current_level, child_progress.subject_counts 
FROM child_progress 
WHERE child_progress.child_id = $1::UUID
2026-01-18 04:32:56 | INFO     | sqlalchemy.engine.Engine | [cached since 184.4s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'),)
2026-01-18 04:32:56 | INFO     | sqlalchemy.engine.Engine | SELECT level_thresholds.id, level_thresholds.name, level_thresholds.threshold, level_thresholds.icon, level_thresholds.color, level_thresholds.is_active 
FROM level_thresholds 
WHERE level_thresholds.is_active = true
2026-01-18 04:32:56 | INFO     | sqlalchemy.engine.Engine | [cached since 184.4s ago] ()
2026-01-18 04:32:56 | INFO     | sqlalchemy.engine.Engine | SELECT child_balanced_progress_counters.id, child_balanced_progress_counters.child_id, child_balanced_progress_counters.subject_code, child_balanced_progress_counters.correct_count, child_balanced_progress_counters.updated_at 
FROM child_balanced_progress_counters 
WHERE child_balanced_progress_counters.child_id = $1::UUID AND child_balanced_progress_counters.subject_code IN ($2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR)
2026-01-18 04:32:56 | INFO     | sqlalchemy.engine.Engine | [cached since 184.4s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), 'history', 'math', 'reading', 'science')
2026-01-18 04:32:56 | INFO     | sqlalchemy.engine.Engine | SELECT child_activity_events.kind, count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID GROUP BY child_activity_events.kind
2026-01-18 04:32:56 | INFO     | sqlalchemy.engine.Engine | [cached since 184.4s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'),)
2026-01-18 04:32:56 | INFO     | sqlalchemy.engine.Engine | SELECT coalesce(sum(child_activity_events.points), $1::INTEGER) AS coalesce_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $2::UUID
2026-01-18 04:32:56 | INFO     | sqlalchemy.engine.Engine | [cached since 184.4s ago] (0, UUID('767166ac-39ef-4412-b0f5-72998235b319'))
2026-01-18 04:32:56 | INFO     | mybuddy.api | progress_totals: child_id=767166ac-39ef-4412-b0f5-72998235b319 totalPoints=428 counts={'affirmation': 2, 'flashcard': 49}
2026-01-18 04:32:56 | INFO     | sqlalchemy.engine.Engine | SELECT child_activity_events.kind, count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.created_at >= $2::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $3::TIMESTAMP WITH TIME ZONE GROUP BY child_activity_events.kind
2026-01-18 04:32:56 | INFO     | sqlalchemy.engine.Engine | [cached since 184.4s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:32:56 | INFO     | sqlalchemy.engine.Engine | SELECT coalesce(sum(child_activity_events.points), $1::INTEGER) AS coalesce_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $2::UUID AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE
2026-01-18 04:32:56 | INFO     | sqlalchemy.engine.Engine | [cached since 184.4s ago] (0, UUID('767166ac-39ef-4412-b0f5-72998235b319'), datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:32:56 | INFO     | sqlalchemy.engine.Engine | SELECT count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.kind = $2::VARCHAR AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE AND child_activity_events.correct = true
2026-01-18 04:32:56 | INFO     | sqlalchemy.engine.Engine | [cached since 184.4s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), 'flashcard', datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:32:56 | INFO     | mybuddy.api | progress_today: child_id=767166ac-39ef-4412-b0f5-72998235b319 date=2026-01-17 counts={'affirmation': 2, 'flashcard': 49} flash_correct=40 totalPoints=428
2026-01-18 04:32:56 | INFO     | sqlalchemy.engine.Engine | SELECT difficulty_thresholds.code, difficulty_thresholds.threshold 
FROM difficulty_thresholds 
WHERE difficulty_thresholds.is_active = true
2026-01-18 04:32:56 | INFO     | sqlalchemy.engine.Engine | [cached since 184.4s ago] ()
2026-01-18 04:32:56 | INFO     | mybuddy.api | difficulty_thresholds: child_id=767166ac-39ef-4412-b0f5-72998235b319 thresholds={'easy': 0, 'medium': 25, 'hard': 50, 'impossible': 100}
2026-01-18 04:32:56 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code AS subject_code, count(child_activity_events.id) AS completed, coalesce(sum(CASE WHEN (child_activity_events.correct = true) THEN $1::INTEGER ELSE $2::INTEGER END), $3::INTEGER) AS correct 
FROM child_activity_events JOIN subjects ON subjects.id = child_activity_events.subject_id 
WHERE child_activity_events.child_id = $4::UUID AND child_activity_events.kind = $5::VARCHAR GROUP BY subjects.code
2026-01-18 04:32:56 | INFO     | sqlalchemy.engine.Engine | [cached since 184.4s ago] (1, 0, 0, UUID('767166ac-39ef-4412-b0f5-72998235b319'), 'flashcard')
2026-01-18 04:32:56 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code, child_subject_streaks.current_streak, child_subject_streaks.longest_streak 
FROM child_subject_streaks JOIN subjects ON subjects.id = child_subject_streaks.subject_id 
WHERE child_subject_streaks.child_id = $1::UUID
2026-01-18 04:32:56 | INFO     | sqlalchemy.engine.Engine | [cached since 184.4s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'),)
2026-01-18 04:32:56 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code, child_subject_difficulty.difficulty_code 
FROM child_subject_difficulty JOIN subjects ON subjects.id = child_subject_difficulty.subject_id 
WHERE child_subject_difficulty.child_id = $1::UUID
2026-01-18 04:32:56 | INFO     | sqlalchemy.engine.Engine | [cached since 184.4s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'),)
2026-01-18 04:32:56 | INFO     | mybuddy.api | subject_difficulty_map: child_id=767166ac-39ef-4412-b0f5-72998235b319 diff_map={'math': 'easy', 'science': 'easy', 'reading': 'easy', 'history': 'easy'}
2026-01-18 04:32:56 | INFO     | mybuddy.api | dashboard_flashcards_by_subject: child_id=767166ac-39ef-4412-b0f5-72998235b319 by_subject={'history': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 12, 'longestStreak': 18}, 'math': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 4, 'longestStreak': 6}, 'reading': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 0, 'longestStreak': 0}, 'science': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 2, 'longestStreak': 4}}
2026-01-18 04:32:56 | INFO     | sqlalchemy.engine.Engine | SELECT DISTINCT ((child_activity_events.created_at AT TIME ZONE 'America/New_York')::date) AS d 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.created_at >= $2::TIMESTAMP WITH TIME ZONE ORDER BY d DESC
2026-01-18 04:32:56 | INFO     | sqlalchemy.engine.Engine | [cached since 184.4s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), datetime.datetime(2025, 7, 21, 4, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:32:56 | INFO     | sqlalchemy.engine.Engine | SELECT achievements.created_at, achievements.updated_at, achievements.id, achievements.code, achievements.title, achievements.description, achievements.icon, achievements.achievement_type, achievements.points_threshold, achievements.streak_days_threshold, achievements.flashcards_count_threshold, achievements.chores_count_threshold, achievements.outdoor_count_threshold, achievements.is_active 
FROM achievements
2026-01-18 04:32:56 | INFO     | sqlalchemy.engine.Engine | [cached since 184.3s ago] ()
2026-01-18 04:32:56 | INFO     | sqlalchemy.engine.Engine | SELECT achievements.code 
FROM achievements JOIN child_achievements ON child_achievements.achievement_id = achievements.id 
WHERE child_achievements.child_id = $1::UUID
2026-01-18 04:32:56 | INFO     | sqlalchemy.engine.Engine | [cached since 184.3s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'),)
2026-01-18 04:32:56 | INFO     | mybuddy.api | event_flashcard: commit child_id=767166ac-39ef-4412-b0f5-72998235b319 points=10 newAchievementCodes=[]
2026-01-18 04:32:56 | INFO     | sqlalchemy.engine.Engine | COMMIT
2026-01-18 04:32:56 | INFO     | mybuddy.api | event_flashcard: success child_id=767166ac-39ef-4412-b0f5-72998235b319
2026-01-18 04:32:56 | INFO     | uvicorn.access | 10.3.6.1:0 - "POST /v1/children/767166ac-39ef-4412-b0f5-72998235b319/events/flashcard HTTP/1.1" 200
2026-01-18 04:32:58 | INFO     | sqlalchemy.engine.Engine | BEGIN (implicit)
2026-01-18 04:32:58 | INFO     | sqlalchemy.engine.Engine | SELECT children.created_at, children.updated_at, children.id, children.owner_sub, children.name, children.birthday, children.interests, children.avatar_id 
FROM children 
WHERE children.id = $1::UUID AND children.owner_sub = $2::VARCHAR
2026-01-18 04:32:58 | INFO     | sqlalchemy.engine.Engine | [cached since 186.3s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), '3a26e22b-005d-4dc6-ac5f-bc66f95d8748')
2026-01-18 04:32:58 | INFO     | mybuddy.api | build_dashboard: start child_id=767166ac-39ef-4412-b0f5-72998235b319
2026-01-18 04:32:58 | INFO     | sqlalchemy.engine.Engine | SELECT child_activity_events.kind, count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID GROUP BY child_activity_events.kind
2026-01-18 04:32:58 | INFO     | sqlalchemy.engine.Engine | [cached since 186.1s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'),)
2026-01-18 04:32:58 | INFO     | sqlalchemy.engine.Engine | SELECT coalesce(sum(child_activity_events.points), $1::INTEGER) AS coalesce_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $2::UUID
2026-01-18 04:32:58 | INFO     | sqlalchemy.engine.Engine | [cached since 186.1s ago] (0, UUID('767166ac-39ef-4412-b0f5-72998235b319'))
2026-01-18 04:32:58 | INFO     | mybuddy.api | progress_totals: child_id=767166ac-39ef-4412-b0f5-72998235b319 totalPoints=428 counts={'affirmation': 2, 'flashcard': 49}
2026-01-18 04:32:58 | INFO     | sqlalchemy.engine.Engine | SELECT child_activity_events.kind, count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.created_at >= $2::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $3::TIMESTAMP WITH TIME ZONE GROUP BY child_activity_events.kind
2026-01-18 04:32:58 | INFO     | sqlalchemy.engine.Engine | [cached since 186.1s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:32:58 | INFO     | sqlalchemy.engine.Engine | SELECT coalesce(sum(child_activity_events.points), $1::INTEGER) AS coalesce_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $2::UUID AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE
2026-01-18 04:32:58 | INFO     | sqlalchemy.engine.Engine | [cached since 186.1s ago] (0, UUID('767166ac-39ef-4412-b0f5-72998235b319'), datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:32:58 | INFO     | sqlalchemy.engine.Engine | SELECT count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.kind = $2::VARCHAR AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE AND child_activity_events.correct = true
2026-01-18 04:32:58 | INFO     | sqlalchemy.engine.Engine | [cached since 186.1s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), 'flashcard', datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:32:58 | INFO     | mybuddy.api | progress_today: child_id=767166ac-39ef-4412-b0f5-72998235b319 date=2026-01-17 counts={'affirmation': 2, 'flashcard': 49} flash_correct=40 totalPoints=428
2026-01-18 04:32:58 | INFO     | sqlalchemy.engine.Engine | SELECT coalesce(sum(child_activity_events.points), $1::INTEGER) AS coalesce_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $2::UUID AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE
2026-01-18 04:32:58 | INFO     | sqlalchemy.engine.Engine | [cached since 186.1s ago] (0, UUID('767166ac-39ef-4412-b0f5-72998235b319'), datetime.datetime(2026, 1, 11, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:32:58 | INFO     | sqlalchemy.engine.Engine | SELECT count(DISTINCT ((child_activity_events.created_at AT TIME ZONE 'America/New_York')::date)) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.created_at >= $2::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $3::TIMESTAMP WITH TIME ZONE
2026-01-18 04:32:58 | INFO     | sqlalchemy.engine.Engine | [cached since 184.3s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), datetime.datetime(2026, 1, 11, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:32:58 | INFO     | sqlalchemy.engine.Engine | SELECT child_activity_events.kind, count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.created_at >= $2::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $3::TIMESTAMP WITH TIME ZONE GROUP BY child_activity_events.kind
2026-01-18 04:32:58 | INFO     | sqlalchemy.engine.Engine | [cached since 186.1s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), datetime.datetime(2026, 1, 11, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:32:58 | INFO     | sqlalchemy.engine.Engine | SELECT count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.kind = $2::VARCHAR AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE AND child_activity_events.correct = true
2026-01-18 04:32:58 | INFO     | sqlalchemy.engine.Engine | [cached since 186.1s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), 'flashcard', datetime.datetime(2026, 1, 11, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:32:58 | INFO     | mybuddy.api | progress_week: child_id=767166ac-39ef-4412-b0f5-72998235b319 weekStart=2026-01-11 counts={'affirmation': 2, 'flashcard': 49} flash_correct=40 accuracyPct=82 totalPoints=428 daysActive=1
2026-01-18 04:32:58 | INFO     | sqlalchemy.engine.Engine | SELECT DISTINCT child_activity_events.chore_id 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.kind = $2::VARCHAR AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE AND child_activity_events.chore_id IS NOT NULL
2026-01-18 04:32:58 | INFO     | sqlalchemy.engine.Engine | [cached since 184.3s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), 'chore', datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:32:58 | INFO     | sqlalchemy.engine.Engine | SELECT DISTINCT child_activity_events.outdoor_activity_id 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.kind = $2::VARCHAR AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE AND child_activity_events.outdoor_activity_id IS NOT NULL
2026-01-18 04:32:58 | INFO     | sqlalchemy.engine.Engine | [cached since 184.3s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), 'outdoor', datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:32:58 | INFO     | sqlalchemy.engine.Engine | SELECT children.created_at, children.updated_at, children.id, children.owner_sub, children.name, children.birthday, children.interests, children.avatar_id 
FROM children 
WHERE children.id = $1::UUID
2026-01-18 04:32:58 | INFO     | sqlalchemy.engine.Engine | [cached since 186.2s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'),)
2026-01-18 04:32:58 | INFO     | sqlalchemy.engine.Engine | SELECT age_ranges.id, age_ranges.code, age_ranges.name, age_ranges.min_age, age_ranges.max_age, age_ranges.is_active 
FROM age_ranges 
WHERE age_ranges.min_age <= $1::INTEGER AND (age_ranges.max_age IS NULL OR age_ranges.max_age >= $2::INTEGER) AND age_ranges.is_active = true
2026-01-18 04:32:58 | INFO     | sqlalchemy.engine.Engine | [cached since 186.2s ago] (8, 8)
2026-01-18 04:32:58 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code 
FROM subjects JOIN subject_age_ranges ON subjects.id = subject_age_ranges.subject_id 
WHERE subject_age_ranges.age_range_id = $1::UUID ORDER BY subjects.code
2026-01-18 04:32:58 | INFO     | sqlalchemy.engine.Engine | [cached since 186.2s ago] (UUID('1aea8d41-8a9a-4631-a8d7-b8ef59d74bfc'),)
2026-01-18 04:32:58 | INFO     | sqlalchemy.engine.Engine | SELECT difficulty_thresholds.code, difficulty_thresholds.threshold 
FROM difficulty_thresholds 
WHERE difficulty_thresholds.is_active = true
2026-01-18 04:32:58 | INFO     | sqlalchemy.engine.Engine | [cached since 186.1s ago] ()
2026-01-18 04:32:58 | INFO     | mybuddy.api | difficulty_thresholds: child_id=767166ac-39ef-4412-b0f5-72998235b319 thresholds={'easy': 0, 'medium': 25, 'hard': 50, 'impossible': 100}
2026-01-18 04:32:58 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code AS subject_code, count(child_activity_events.id) AS completed, coalesce(sum(CASE WHEN (child_activity_events.correct = true) THEN $1::INTEGER ELSE $2::INTEGER END), $3::INTEGER) AS correct 
FROM child_activity_events JOIN subjects ON subjects.id = child_activity_events.subject_id 
WHERE child_activity_events.child_id = $4::UUID AND child_activity_events.kind = $5::VARCHAR GROUP BY subjects.code
2026-01-18 04:32:58 | INFO     | sqlalchemy.engine.Engine | [cached since 186.1s ago] (1, 0, 0, UUID('767166ac-39ef-4412-b0f5-72998235b319'), 'flashcard')
2026-01-18 04:32:58 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code, child_subject_streaks.current_streak, child_subject_streaks.longest_streak 
FROM child_subject_streaks JOIN subjects ON subjects.id = child_subject_streaks.subject_id 
WHERE child_subject_streaks.child_id = $1::UUID
2026-01-18 04:32:58 | INFO     | sqlalchemy.engine.Engine | [cached since 186.1s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'),)
2026-01-18 04:32:58 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code, child_subject_difficulty.difficulty_code 
FROM child_subject_difficulty JOIN subjects ON subjects.id = child_subject_difficulty.subject_id 
WHERE child_subject_difficulty.child_id = $1::UUID
2026-01-18 04:32:58 | INFO     | sqlalchemy.engine.Engine | [cached since 186.1s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'),)
2026-01-18 04:32:58 | INFO     | mybuddy.api | subject_difficulty_map: child_id=767166ac-39ef-4412-b0f5-72998235b319 diff_map={'math': 'easy', 'science': 'easy', 'reading': 'easy', 'history': 'easy'}
2026-01-18 04:32:58 | INFO     | mybuddy.api | dashboard_flashcards_by_subject: child_id=767166ac-39ef-4412-b0f5-72998235b319 by_subject={'history': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 12, 'longestStreak': 18}, 'math': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 4, 'longestStreak': 6}, 'reading': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 0, 'longestStreak': 0}, 'science': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 2, 'longestStreak': 4}}
2026-01-18 04:32:58 | INFO     | sqlalchemy.engine.Engine | SELECT DISTINCT ((child_activity_events.created_at AT TIME ZONE 'America/New_York')::date) AS d 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.created_at >= $2::TIMESTAMP WITH TIME ZONE ORDER BY d DESC
2026-01-18 04:32:58 | INFO     | sqlalchemy.engine.Engine | [cached since 186.1s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), datetime.datetime(2025, 7, 21, 4, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:32:58 | INFO     | sqlalchemy.engine.Engine | SELECT level_thresholds.id, level_thresholds.name, level_thresholds.threshold, level_thresholds.icon, level_thresholds.color, level_thresholds.is_active 
FROM level_thresholds 
WHERE level_thresholds.is_active = true
2026-01-18 04:32:58 | INFO     | sqlalchemy.engine.Engine | [cached since 186.2s ago] ()
2026-01-18 04:32:58 | INFO     | mybuddy.api | build_dashboard: loaded child_id=767166ac-39ef-4412-b0f5-72998235b319 core_subjects=['history', 'math', 'reading', 'science'] by_subject_keys=['history', 'math', 'reading', 'science'] totalPoints=428
2026-01-18 04:32:58 | INFO     | sqlalchemy.engine.Engine | SELECT child_balanced_progress_counters.id, child_balanced_progress_counters.child_id, child_balanced_progress_counters.subject_code, child_balanced_progress_counters.correct_count, child_balanced_progress_counters.updated_at 
FROM child_balanced_progress_counters 
WHERE child_balanced_progress_counters.child_id = $1::UUID
2026-01-18 04:32:58 | INFO     | sqlalchemy.engine.Engine | [cached since 184.3s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'),)
2026-01-18 04:32:58 | INFO     | sqlalchemy.engine.Engine | SELECT child_progress.child_id, child_progress.total_points, child_progress.total_flashcards, child_progress.total_chores, child_progress.total_outdoor, child_progress.total_affirmations, child_progress.current_streak, child_progress.longest_streak, child_progress.last_active_date, child_progress.last_seen_at, child_progress.current_level, child_progress.subject_counts 
FROM child_progress 
WHERE child_progress.child_id = $1::UUID
2026-01-18 04:32:58 | INFO     | sqlalchemy.engine.Engine | [cached since 186.2s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'),)
2026-01-18 04:32:58 | INFO     | sqlalchemy.engine.Engine | SELECT achievements.code, child_achievements.unlocked_at 
FROM achievements JOIN child_achievements ON child_achievements.achievement_id = achievements.id 
WHERE child_achievements.child_id = $1::UUID
2026-01-18 04:32:58 | INFO     | sqlalchemy.engine.Engine | [cached since 184.3s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'),)
2026-01-18 04:32:58 | INFO     | sqlalchemy.engine.Engine | SELECT achievements.created_at, achievements.updated_at, achievements.id, achievements.code, achievements.title, achievements.description, achievements.icon, achievements.achievement_type, achievements.points_threshold, achievements.streak_days_threshold, achievements.flashcards_count_threshold, achievements.chores_count_threshold, achievements.outdoor_count_threshold, achievements.is_active 
FROM achievements
2026-01-18 04:32:58 | INFO     | sqlalchemy.engine.Engine | [cached since 186.1s ago] ()
2026-01-18 04:32:58 | INFO     | mybuddy.api | build_dashboard: end child_id=767166ac-39ef-4412-b0f5-72998235b319 unlocked=3 locked=17
2026-01-18 04:32:58 | INFO     | uvicorn.access | 10.3.6.1:0 - "GET /v1/children/767166ac-39ef-4412-b0f5-72998235b319/dashboard HTTP/1.1" 200
2026-01-18 04:32:58 | INFO     | sqlalchemy.engine.Engine | ROLLBACK
2026-01-18 04:33:15 | INFO     | sqlalchemy.engine.Engine | BEGIN (implicit)
2026-01-18 04:33:15 | INFO     | sqlalchemy.engine.Engine | SELECT children.created_at, children.updated_at, children.id, children.owner_sub, children.name, children.birthday, children.interests, children.avatar_id 
FROM children 
WHERE children.id = $1::UUID AND children.owner_sub = $2::VARCHAR
2026-01-18 04:33:15 | INFO     | sqlalchemy.engine.Engine | [cached since 203.8s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), '3a26e22b-005d-4dc6-ac5f-bc66f95d8748')
2026-01-18 04:33:15 | INFO     | mybuddy.api | event_flashcard: start child_id=767166ac-39ef-4412-b0f5-72998235b319 flashcardId=fcb38dbb-83e3-4c06-a134-3dafec0999cf correct=False
2026-01-18 04:33:15 | INFO     | sqlalchemy.engine.Engine | SELECT points_values.id, points_values.code, points_values.name, points_values.points, points_values.is_active 
FROM points_values 
WHERE points_values.is_active = true
2026-01-18 04:33:15 | INFO     | sqlalchemy.engine.Engine | [cached since 203.8s ago] ()
2026-01-18 04:33:15 | INFO     | sqlalchemy.engine.Engine | SELECT flashcards.id, flashcards.subject_id, flashcards.question, flashcards.choices, flashcards.explanations, flashcards.correct_index, flashcards.difficulty_code, flashcards.tags, flashcards.age_range_id 
FROM flashcards 
WHERE flashcards.id = $1::UUID
2026-01-18 04:33:15 | INFO     | sqlalchemy.engine.Engine | [cached since 203.8s ago] (UUID('fcb38dbb-83e3-4c06-a134-3dafec0999cf'),)
2026-01-18 04:33:15 | INFO     | mybuddy.api | event_flashcard: validated child_id=767166ac-39ef-4412-b0f5-72998235b319 flashcardId=fcb38dbb-83e3-4c06-a134-3dafec0999cf subject_id=73c23c39-1a46-4a0a-9f0d-6b8f44a61635 points=2
2026-01-18 04:33:15 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.id, subjects.code, subjects.name, subjects.icon, subjects.color 
FROM subjects 
WHERE subjects.id = $1::UUID
2026-01-18 04:33:15 | INFO     | sqlalchemy.engine.Engine | [cached since 203.8s ago] (UUID('73c23c39-1a46-4a0a-9f0d-6b8f44a61635'),)
2026-01-18 04:33:15 | INFO     | sqlalchemy.engine.Engine | SAVEPOINT sa_savepoint_1
2026-01-18 04:33:15 | INFO     | sqlalchemy.engine.Engine | [no key 0.00056s] ()
2026-01-18 04:33:15 | INFO     | sqlalchemy.engine.Engine | INSERT INTO child_activity_events (child_id, kind, subject_id, flashcard_id, chore_id, outdoor_activity_id, affirmation_id, points, correct, answer, meta) VALUES ($1::UUID, $2::VARCHAR, $3::UUID, $4::UUID, $5::UUID, $6::UUID, $7::UUID, $8::INTEGER, $9::BOOLEAN, $10::VARCHAR, $11::JSONB) RETURNING child_activity_events.id, child_activity_events.created_at
2026-01-18 04:33:15 | INFO     | sqlalchemy.engine.Engine | [cached since 203.8s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), 'flashcard', UUID('73c23c39-1a46-4a0a-9f0d-6b8f44a61635'), UUID('fcb38dbb-83e3-4c06-a134-3dafec0999cf'), None, None, None, 2, False, '8', '{"dedupeKey": "flashcard:fcb38dbb-83e3-4c06-a134-3dafec0999cf", "flashcardId": "fcb38dbb-83e3-4c06-a134-3dafec0999cf", "subjectId": "73c23c39-1a46-4a0a-9f0d-6b8f44a61635", "correct": false, "answer": "8", "points": 2}')
2026-01-18 04:33:15 | INFO     | sqlalchemy.engine.Engine | RELEASE SAVEPOINT sa_savepoint_1
2026-01-18 04:33:15 | INFO     | sqlalchemy.engine.Engine | [no key 0.00058s] ()
2026-01-18 04:33:15 | INFO     | mybuddy.api | event_flashcard: inserted_event child_id=767166ac-39ef-4412-b0f5-72998235b319
2026-01-18 04:33:15 | INFO     | sqlalchemy.engine.Engine | SELECT difficulty_thresholds.id, difficulty_thresholds.code, difficulty_thresholds.name, difficulty_thresholds.label, difficulty_thresholds.icon, difficulty_thresholds.color, difficulty_thresholds.threshold, difficulty_thresholds.is_active 
FROM difficulty_thresholds 
WHERE difficulty_thresholds.is_active = true
2026-01-18 04:33:15 | INFO     | sqlalchemy.engine.Engine | [cached since 203.8s ago] ()
2026-01-18 04:33:15 | INFO     | sqlalchemy.engine.Engine | SELECT child_subject_difficulty.child_id, child_subject_difficulty.subject_id, child_subject_difficulty.difficulty_code, child_subject_difficulty.last_updated 
FROM child_subject_difficulty 
WHERE child_subject_difficulty.child_id = $1::UUID AND child_subject_difficulty.subject_id = $2::UUID
2026-01-18 04:33:15 | INFO     | sqlalchemy.engine.Engine | [cached since 203.8s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), UUID('73c23c39-1a46-4a0a-9f0d-6b8f44a61635'))
2026-01-18 04:33:15 | INFO     | sqlalchemy.engine.Engine | SELECT child_subject_streaks.child_id, child_subject_streaks.subject_id, child_subject_streaks.current_streak, child_subject_streaks.longest_streak, child_subject_streaks.last_updated 
FROM child_subject_streaks 
WHERE child_subject_streaks.child_id = $1::UUID AND child_subject_streaks.subject_id = $2::UUID
2026-01-18 04:33:15 | INFO     | sqlalchemy.engine.Engine | [cached since 203.8s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), UUID('73c23c39-1a46-4a0a-9f0d-6b8f44a61635'))
2026-01-18 04:33:15 | INFO     | sqlalchemy.engine.Engine | UPDATE child_subject_streaks SET current_streak=$1::INTEGER, last_updated=$2::TIMESTAMP WITH TIME ZONE WHERE child_subject_streaks.child_id = $3::UUID AND child_subject_streaks.subject_id = $4::UUID
2026-01-18 04:33:15 | INFO     | sqlalchemy.engine.Engine | [cached since 203.8s ago] (0, datetime.datetime(2026, 1, 18, 4, 33, 15, 833934, tzinfo=datetime.timezone.utc), UUID('767166ac-39ef-4412-b0f5-72998235b319'), UUID('73c23c39-1a46-4a0a-9f0d-6b8f44a61635'))
2026-01-18 04:33:15 | INFO     | sqlalchemy.engine.Engine | SELECT child_flashcard_performance.created_at, child_flashcard_performance.updated_at, child_flashcard_performance.child_id, child_flashcard_performance.flashcard_id, child_flashcard_performance.correct_count, child_flashcard_performance.incorrect_count, child_flashcard_performance.last_seen_at 
FROM child_flashcard_performance 
WHERE child_flashcard_performance.child_id = $1::UUID AND child_flashcard_performance.flashcard_id = $2::UUID
2026-01-18 04:33:15 | INFO     | sqlalchemy.engine.Engine | [cached since 203.8s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), UUID('fcb38dbb-83e3-4c06-a134-3dafec0999cf'))
2026-01-18 04:33:15 | INFO     | mybuddy.api | event_flashcard: create_perf child_id=767166ac-39ef-4412-b0f5-72998235b319 flashcardId=fcb38dbb-83e3-4c06-a134-3dafec0999cf correct=False
2026-01-18 04:33:15 | INFO     | sqlalchemy.engine.Engine | INSERT INTO child_flashcard_performance (child_id, flashcard_id, correct_count, incorrect_count, last_seen_at) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::INTEGER, $5::TIMESTAMP WITH TIME ZONE) RETURNING child_flashcard_performance.created_at, child_flashcard_performance.updated_at
2026-01-18 04:33:15 | INFO     | sqlalchemy.engine.Engine | [cached since 203.8s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), UUID('fcb38dbb-83e3-4c06-a134-3dafec0999cf'), 0, 1, datetime.datetime(2026, 1, 18, 4, 33, 15, 847679, tzinfo=datetime.timezone.utc))
2026-01-18 04:33:15 | INFO     | sqlalchemy.engine.Engine | SELECT children.created_at, children.updated_at, children.id, children.owner_sub, children.name, children.birthday, children.interests, children.avatar_id 
FROM children 
WHERE children.id = $1::UUID
2026-01-18 04:33:15 | INFO     | sqlalchemy.engine.Engine | [cached since 203.8s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'),)
2026-01-18 04:33:15 | INFO     | sqlalchemy.engine.Engine | SELECT age_ranges.id, age_ranges.code, age_ranges.name, age_ranges.min_age, age_ranges.max_age, age_ranges.is_active 
FROM age_ranges 
WHERE age_ranges.min_age <= $1::INTEGER AND (age_ranges.max_age IS NULL OR age_ranges.max_age >= $2::INTEGER) AND age_ranges.is_active = true
2026-01-18 04:33:15 | INFO     | sqlalchemy.engine.Engine | [cached since 203.8s ago] (8, 8)
2026-01-18 04:33:15 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code 
FROM subjects JOIN subject_age_ranges ON subjects.id = subject_age_ranges.subject_id 
WHERE subject_age_ranges.age_range_id = $1::UUID ORDER BY subjects.code
2026-01-18 04:33:15 | INFO     | sqlalchemy.engine.Engine | [cached since 203.8s ago] (UUID('1aea8d41-8a9a-4631-a8d7-b8ef59d74bfc'),)
2026-01-18 04:33:15 | INFO     | sqlalchemy.engine.Engine | SELECT child_progress.child_id, child_progress.total_points, child_progress.total_flashcards, child_progress.total_chores, child_progress.total_outdoor, child_progress.total_affirmations, child_progress.current_streak, child_progress.longest_streak, child_progress.last_active_date, child_progress.last_seen_at, child_progress.current_level, child_progress.subject_counts 
FROM child_progress 
WHERE child_progress.child_id = $1::UUID
2026-01-18 04:33:15 | INFO     | sqlalchemy.engine.Engine | [cached since 203.8s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'),)
2026-01-18 04:33:15 | INFO     | sqlalchemy.engine.Engine | SELECT level_thresholds.id, level_thresholds.name, level_thresholds.threshold, level_thresholds.icon, level_thresholds.color, level_thresholds.is_active 
FROM level_thresholds 
WHERE level_thresholds.is_active = true
2026-01-18 04:33:15 | INFO     | sqlalchemy.engine.Engine | [cached since 203.8s ago] ()
2026-01-18 04:33:15 | INFO     | sqlalchemy.engine.Engine | SELECT child_balanced_progress_counters.id, child_balanced_progress_counters.child_id, child_balanced_progress_counters.subject_code, child_balanced_progress_counters.correct_count, child_balanced_progress_counters.updated_at 
FROM child_balanced_progress_counters 
WHERE child_balanced_progress_counters.child_id = $1::UUID AND child_balanced_progress_counters.subject_code IN ($2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR)
2026-01-18 04:33:15 | INFO     | sqlalchemy.engine.Engine | [cached since 203.7s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), 'history', 'math', 'reading', 'science')
2026-01-18 04:33:15 | INFO     | sqlalchemy.engine.Engine | SELECT child_activity_events.kind, count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID GROUP BY child_activity_events.kind
2026-01-18 04:33:15 | INFO     | sqlalchemy.engine.Engine | [cached since 203.7s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'),)
2026-01-18 04:33:15 | INFO     | sqlalchemy.engine.Engine | SELECT coalesce(sum(child_activity_events.points), $1::INTEGER) AS coalesce_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $2::UUID
2026-01-18 04:33:15 | INFO     | sqlalchemy.engine.Engine | [cached since 203.7s ago] (0, UUID('767166ac-39ef-4412-b0f5-72998235b319'))
2026-01-18 04:33:15 | INFO     | mybuddy.api | progress_totals: child_id=767166ac-39ef-4412-b0f5-72998235b319 totalPoints=430 counts={'affirmation': 2, 'flashcard': 50}
2026-01-18 04:33:15 | INFO     | sqlalchemy.engine.Engine | SELECT child_activity_events.kind, count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.created_at >= $2::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $3::TIMESTAMP WITH TIME ZONE GROUP BY child_activity_events.kind
2026-01-18 04:33:15 | INFO     | sqlalchemy.engine.Engine | [cached since 203.7s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:33:15 | INFO     | sqlalchemy.engine.Engine | SELECT coalesce(sum(child_activity_events.points), $1::INTEGER) AS coalesce_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $2::UUID AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE
2026-01-18 04:33:15 | INFO     | sqlalchemy.engine.Engine | [cached since 203.7s ago] (0, UUID('767166ac-39ef-4412-b0f5-72998235b319'), datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:33:15 | INFO     | sqlalchemy.engine.Engine | SELECT count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.kind = $2::VARCHAR AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE AND child_activity_events.correct = true
2026-01-18 04:33:15 | INFO     | sqlalchemy.engine.Engine | [cached since 203.7s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), 'flashcard', datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:33:15 | INFO     | mybuddy.api | progress_today: child_id=767166ac-39ef-4412-b0f5-72998235b319 date=2026-01-17 counts={'affirmation': 2, 'flashcard': 50} flash_correct=40 totalPoints=430
2026-01-18 04:33:15 | INFO     | sqlalchemy.engine.Engine | SELECT difficulty_thresholds.code, difficulty_thresholds.threshold 
FROM difficulty_thresholds 
WHERE difficulty_thresholds.is_active = true
2026-01-18 04:33:15 | INFO     | sqlalchemy.engine.Engine | [cached since 203.7s ago] ()
2026-01-18 04:33:15 | INFO     | mybuddy.api | difficulty_thresholds: child_id=767166ac-39ef-4412-b0f5-72998235b319 thresholds={'easy': 0, 'medium': 25, 'hard': 50, 'impossible': 100}
2026-01-18 04:33:15 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code AS subject_code, count(child_activity_events.id) AS completed, coalesce(sum(CASE WHEN (child_activity_events.correct = true) THEN $1::INTEGER ELSE $2::INTEGER END), $3::INTEGER) AS correct 
FROM child_activity_events JOIN subjects ON subjects.id = child_activity_events.subject_id 
WHERE child_activity_events.child_id = $4::UUID AND child_activity_events.kind = $5::VARCHAR GROUP BY subjects.code
2026-01-18 04:33:15 | INFO     | sqlalchemy.engine.Engine | [cached since 203.7s ago] (1, 0, 0, UUID('767166ac-39ef-4412-b0f5-72998235b319'), 'flashcard')
2026-01-18 04:33:15 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code, child_subject_streaks.current_streak, child_subject_streaks.longest_streak 
FROM child_subject_streaks JOIN subjects ON subjects.id = child_subject_streaks.subject_id 
WHERE child_subject_streaks.child_id = $1::UUID
2026-01-18 04:33:15 | INFO     | sqlalchemy.engine.Engine | [cached since 203.7s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'),)
2026-01-18 04:33:15 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code, child_subject_difficulty.difficulty_code 
FROM child_subject_difficulty JOIN subjects ON subjects.id = child_subject_difficulty.subject_id 
WHERE child_subject_difficulty.child_id = $1::UUID
2026-01-18 04:33:15 | INFO     | sqlalchemy.engine.Engine | [cached since 203.7s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'),)
2026-01-18 04:33:15 | INFO     | mybuddy.api | subject_difficulty_map: child_id=767166ac-39ef-4412-b0f5-72998235b319 diff_map={'math': 'easy', 'science': 'easy', 'reading': 'easy', 'history': 'easy'}
2026-01-18 04:33:15 | INFO     | mybuddy.api | dashboard_flashcards_by_subject: child_id=767166ac-39ef-4412-b0f5-72998235b319 by_subject={'history': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 12, 'longestStreak': 18}, 'math': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 0, 'longestStreak': 6}, 'reading': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 0, 'longestStreak': 0}, 'science': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 2, 'longestStreak': 4}}
2026-01-18 04:33:15 | INFO     | sqlalchemy.engine.Engine | SELECT DISTINCT ((child_activity_events.created_at AT TIME ZONE 'America/New_York')::date) AS d 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.created_at >= $2::TIMESTAMP WITH TIME ZONE ORDER BY d DESC
2026-01-18 04:33:15 | INFO     | sqlalchemy.engine.Engine | [cached since 203.7s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), datetime.datetime(2025, 7, 21, 4, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:33:15 | INFO     | sqlalchemy.engine.Engine | SELECT achievements.created_at, achievements.updated_at, achievements.id, achievements.code, achievements.title, achievements.description, achievements.icon, achievements.achievement_type, achievements.points_threshold, achievements.streak_days_threshold, achievements.flashcards_count_threshold, achievements.chores_count_threshold, achievements.outdoor_count_threshold, achievements.is_active 
FROM achievements
2026-01-18 04:33:15 | INFO     | sqlalchemy.engine.Engine | [cached since 203.7s ago] ()
2026-01-18 04:33:15 | INFO     | sqlalchemy.engine.Engine | SELECT achievements.code 
FROM achievements JOIN child_achievements ON child_achievements.achievement_id = achievements.id 
WHERE child_achievements.child_id = $1::UUID
2026-01-18 04:33:15 | INFO     | sqlalchemy.engine.Engine | [cached since 203.7s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'),)
2026-01-18 04:33:15 | INFO     | sqlalchemy.engine.Engine | SELECT achievements.code, achievements.id 
FROM achievements 
WHERE achievements.code IN ($1::VARCHAR)
2026-01-18 04:33:15 | INFO     | sqlalchemy.engine.Engine | [generated in 0.00102s] ('knowledge-seeker',)
2026-01-18 04:33:15 | INFO     | mybuddy.api | event_flashcard: commit child_id=767166ac-39ef-4412-b0f5-72998235b319 points=2 newAchievementCodes=['knowledge-seeker']
2026-01-18 04:33:15 | INFO     | sqlalchemy.engine.Engine | INSERT INTO child_achievements (child_id, achievement_id, context) VALUES ($1::UUID, $2::UUID, $3::JSONB) RETURNING child_achievements.unlocked_at
2026-01-18 04:33:15 | INFO     | sqlalchemy.engine.Engine | [generated in 0.00070s] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), UUID('2546d9bd-1b18-40f5-8cf1-5ab60d11a954'), 'null')
2026-01-18 04:33:16 | INFO     | sqlalchemy.engine.Engine | COMMIT
2026-01-18 04:33:16 | INFO     | mybuddy.api | event_flashcard: success child_id=767166ac-39ef-4412-b0f5-72998235b319
2026-01-18 04:33:16 | INFO     | uvicorn.access | 10.3.6.1:0 - "POST /v1/children/767166ac-39ef-4412-b0f5-72998235b319/events/flashcard HTTP/1.1" 200
2026-01-18 04:33:17 | INFO     | sqlalchemy.engine.Engine | BEGIN (implicit)
2026-01-18 04:33:17 | INFO     | sqlalchemy.engine.Engine | SELECT children.created_at, children.updated_at, children.id, children.owner_sub, children.name, children.birthday, children.interests, children.avatar_id 
FROM children 
WHERE children.id = $1::UUID AND children.owner_sub = $2::VARCHAR
2026-01-18 04:33:17 | INFO     | sqlalchemy.engine.Engine | [cached since 205.7s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), '3a26e22b-005d-4dc6-ac5f-bc66f95d8748')
2026-01-18 04:33:17 | INFO     | mybuddy.api | build_dashboard: start child_id=767166ac-39ef-4412-b0f5-72998235b319
2026-01-18 04:33:17 | INFO     | sqlalchemy.engine.Engine | SELECT child_activity_events.kind, count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID GROUP BY child_activity_events.kind
2026-01-18 04:33:17 | INFO     | sqlalchemy.engine.Engine | [cached since 205.5s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'),)
2026-01-18 04:33:17 | INFO     | sqlalchemy.engine.Engine | SELECT coalesce(sum(child_activity_events.points), $1::INTEGER) AS coalesce_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $2::UUID
2026-01-18 04:33:17 | INFO     | sqlalchemy.engine.Engine | [cached since 205.5s ago] (0, UUID('767166ac-39ef-4412-b0f5-72998235b319'))
2026-01-18 04:33:17 | INFO     | mybuddy.api | progress_totals: child_id=767166ac-39ef-4412-b0f5-72998235b319 totalPoints=430 counts={'affirmation': 2, 'flashcard': 50}
2026-01-18 04:33:17 | INFO     | sqlalchemy.engine.Engine | SELECT child_activity_events.kind, count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.created_at >= $2::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $3::TIMESTAMP WITH TIME ZONE GROUP BY child_activity_events.kind
2026-01-18 04:33:17 | INFO     | sqlalchemy.engine.Engine | [cached since 205.5s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:33:17 | INFO     | sqlalchemy.engine.Engine | SELECT coalesce(sum(child_activity_events.points), $1::INTEGER) AS coalesce_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $2::UUID AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE
2026-01-18 04:33:17 | INFO     | sqlalchemy.engine.Engine | [cached since 205.5s ago] (0, UUID('767166ac-39ef-4412-b0f5-72998235b319'), datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:33:17 | INFO     | sqlalchemy.engine.Engine | SELECT count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.kind = $2::VARCHAR AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE AND child_activity_events.correct = true
2026-01-18 04:33:17 | INFO     | sqlalchemy.engine.Engine | [cached since 205.5s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), 'flashcard', datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:33:17 | INFO     | mybuddy.api | progress_today: child_id=767166ac-39ef-4412-b0f5-72998235b319 date=2026-01-17 counts={'affirmation': 2, 'flashcard': 50} flash_correct=40 totalPoints=430
2026-01-18 04:33:17 | INFO     | sqlalchemy.engine.Engine | SELECT coalesce(sum(child_activity_events.points), $1::INTEGER) AS coalesce_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $2::UUID AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE
2026-01-18 04:33:17 | INFO     | sqlalchemy.engine.Engine | [cached since 205.5s ago] (0, UUID('767166ac-39ef-4412-b0f5-72998235b319'), datetime.datetime(2026, 1, 11, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:33:17 | INFO     | sqlalchemy.engine.Engine | SELECT count(DISTINCT ((child_activity_events.created_at AT TIME ZONE 'America/New_York')::date)) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.created_at >= $2::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $3::TIMESTAMP WITH TIME ZONE
2026-01-18 04:33:17 | INFO     | sqlalchemy.engine.Engine | [cached since 203.8s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), datetime.datetime(2026, 1, 11, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:33:17 | INFO     | sqlalchemy.engine.Engine | SELECT child_activity_events.kind, count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.created_at >= $2::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $3::TIMESTAMP WITH TIME ZONE GROUP BY child_activity_events.kind
2026-01-18 04:33:17 | INFO     | sqlalchemy.engine.Engine | [cached since 205.5s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), datetime.datetime(2026, 1, 11, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:33:17 | INFO     | sqlalchemy.engine.Engine | SELECT count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.kind = $2::VARCHAR AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE AND child_activity_events.correct = true
2026-01-18 04:33:17 | INFO     | sqlalchemy.engine.Engine | [cached since 205.5s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), 'flashcard', datetime.datetime(2026, 1, 11, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:33:17 | INFO     | mybuddy.api | progress_week: child_id=767166ac-39ef-4412-b0f5-72998235b319 weekStart=2026-01-11 counts={'affirmation': 2, 'flashcard': 50} flash_correct=40 accuracyPct=80 totalPoints=430 daysActive=1
2026-01-18 04:33:17 | INFO     | sqlalchemy.engine.Engine | SELECT DISTINCT child_activity_events.chore_id 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.kind = $2::VARCHAR AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE AND child_activity_events.chore_id IS NOT NULL
2026-01-18 04:33:17 | INFO     | sqlalchemy.engine.Engine | [cached since 203.8s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), 'chore', datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:33:17 | INFO     | sqlalchemy.engine.Engine | SELECT DISTINCT child_activity_events.outdoor_activity_id 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.kind = $2::VARCHAR AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE AND child_activity_events.outdoor_activity_id IS NOT NULL
2026-01-18 04:33:17 | INFO     | sqlalchemy.engine.Engine | [cached since 203.7s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), 'outdoor', datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:33:17 | INFO     | sqlalchemy.engine.Engine | SELECT children.created_at, children.updated_at, children.id, children.owner_sub, children.name, children.birthday, children.interests, children.avatar_id 
FROM children 
WHERE children.id = $1::UUID
2026-01-18 04:33:17 | INFO     | sqlalchemy.engine.Engine | [cached since 205.6s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'),)
2026-01-18 04:33:17 | INFO     | sqlalchemy.engine.Engine | SELECT age_ranges.id, age_ranges.code, age_ranges.name, age_ranges.min_age, age_ranges.max_age, age_ranges.is_active 
FROM age_ranges 
WHERE age_ranges.min_age <= $1::INTEGER AND (age_ranges.max_age IS NULL OR age_ranges.max_age >= $2::INTEGER) AND age_ranges.is_active = true
2026-01-18 04:33:17 | INFO     | sqlalchemy.engine.Engine | [cached since 205.6s ago] (8, 8)
2026-01-18 04:33:17 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code 
FROM subjects JOIN subject_age_ranges ON subjects.id = subject_age_ranges.subject_id 
WHERE subject_age_ranges.age_range_id = $1::UUID ORDER BY subjects.code
2026-01-18 04:33:17 | INFO     | sqlalchemy.engine.Engine | [cached since 205.6s ago] (UUID('1aea8d41-8a9a-4631-a8d7-b8ef59d74bfc'),)
2026-01-18 04:33:17 | INFO     | sqlalchemy.engine.Engine | SELECT difficulty_thresholds.code, difficulty_thresholds.threshold 
FROM difficulty_thresholds 
WHERE difficulty_thresholds.is_active = true
2026-01-18 04:33:17 | INFO     | sqlalchemy.engine.Engine | [cached since 205.5s ago] ()
2026-01-18 04:33:17 | INFO     | mybuddy.api | difficulty_thresholds: child_id=767166ac-39ef-4412-b0f5-72998235b319 thresholds={'easy': 0, 'medium': 25, 'hard': 50, 'impossible': 100}
2026-01-18 04:33:17 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code AS subject_code, count(child_activity_events.id) AS completed, coalesce(sum(CASE WHEN (child_activity_events.correct = true) THEN $1::INTEGER ELSE $2::INTEGER END), $3::INTEGER) AS correct 
FROM child_activity_events JOIN subjects ON subjects.id = child_activity_events.subject_id 
WHERE child_activity_events.child_id = $4::UUID AND child_activity_events.kind = $5::VARCHAR GROUP BY subjects.code
2026-01-18 04:33:17 | INFO     | sqlalchemy.engine.Engine | [cached since 205.5s ago] (1, 0, 0, UUID('767166ac-39ef-4412-b0f5-72998235b319'), 'flashcard')
2026-01-18 04:33:17 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code, child_subject_streaks.current_streak, child_subject_streaks.longest_streak 
FROM child_subject_streaks JOIN subjects ON subjects.id = child_subject_streaks.subject_id 
WHERE child_subject_streaks.child_id = $1::UUID
2026-01-18 04:33:17 | INFO     | sqlalchemy.engine.Engine | [cached since 205.5s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'),)
2026-01-18 04:33:17 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code, child_subject_difficulty.difficulty_code 
FROM child_subject_difficulty JOIN subjects ON subjects.id = child_subject_difficulty.subject_id 
WHERE child_subject_difficulty.child_id = $1::UUID
2026-01-18 04:33:17 | INFO     | sqlalchemy.engine.Engine | [cached since 205.5s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'),)
2026-01-18 04:33:17 | INFO     | mybuddy.api | subject_difficulty_map: child_id=767166ac-39ef-4412-b0f5-72998235b319 diff_map={'math': 'easy', 'science': 'easy', 'reading': 'easy', 'history': 'easy'}
2026-01-18 04:33:17 | INFO     | mybuddy.api | dashboard_flashcards_by_subject: child_id=767166ac-39ef-4412-b0f5-72998235b319 by_subject={'history': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 12, 'longestStreak': 18}, 'math': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 0, 'longestStreak': 6}, 'reading': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 0, 'longestStreak': 0}, 'science': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 2, 'longestStreak': 4}}
2026-01-18 04:33:17 | INFO     | sqlalchemy.engine.Engine | SELECT DISTINCT ((child_activity_events.created_at AT TIME ZONE 'America/New_York')::date) AS d 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.created_at >= $2::TIMESTAMP WITH TIME ZONE ORDER BY d DESC
2026-01-18 04:33:17 | INFO     | sqlalchemy.engine.Engine | [cached since 205.5s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), datetime.datetime(2025, 7, 21, 4, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:33:17 | INFO     | sqlalchemy.engine.Engine | SELECT level_thresholds.id, level_thresholds.name, level_thresholds.threshold, level_thresholds.icon, level_thresholds.color, level_thresholds.is_active 
FROM level_thresholds 
WHERE level_thresholds.is_active = true
2026-01-18 04:33:17 | INFO     | sqlalchemy.engine.Engine | [cached since 205.6s ago] ()
2026-01-18 04:33:17 | INFO     | mybuddy.api | build_dashboard: loaded child_id=767166ac-39ef-4412-b0f5-72998235b319 core_subjects=['history', 'math', 'reading', 'science'] by_subject_keys=['history', 'math', 'reading', 'science'] totalPoints=430
2026-01-18 04:33:17 | INFO     | sqlalchemy.engine.Engine | SELECT child_balanced_progress_counters.id, child_balanced_progress_counters.child_id, child_balanced_progress_counters.subject_code, child_balanced_progress_counters.correct_count, child_balanced_progress_counters.updated_at 
FROM child_balanced_progress_counters 
WHERE child_balanced_progress_counters.child_id = $1::UUID
2026-01-18 04:33:17 | INFO     | sqlalchemy.engine.Engine | [cached since 203.7s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'),)
2026-01-18 04:33:17 | INFO     | sqlalchemy.engine.Engine | SELECT child_progress.child_id, child_progress.total_points, child_progress.total_flashcards, child_progress.total_chores, child_progress.total_outdoor, child_progress.total_affirmations, child_progress.current_streak, child_progress.longest_streak, child_progress.last_active_date, child_progress.last_seen_at, child_progress.current_level, child_progress.subject_counts 
FROM child_progress 
WHERE child_progress.child_id = $1::UUID
2026-01-18 04:33:17 | INFO     | sqlalchemy.engine.Engine | [cached since 205.6s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'),)
2026-01-18 04:33:17 | INFO     | sqlalchemy.engine.Engine | SELECT achievements.code, child_achievements.unlocked_at 
FROM achievements JOIN child_achievements ON child_achievements.achievement_id = achievements.id 
WHERE child_achievements.child_id = $1::UUID
2026-01-18 04:33:17 | INFO     | sqlalchemy.engine.Engine | [cached since 203.7s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'),)
2026-01-18 04:33:17 | INFO     | sqlalchemy.engine.Engine | SELECT achievements.created_at, achievements.updated_at, achievements.id, achievements.code, achievements.title, achievements.description, achievements.icon, achievements.achievement_type, achievements.points_threshold, achievements.streak_days_threshold, achievements.flashcards_count_threshold, achievements.chores_count_threshold, achievements.outdoor_count_threshold, achievements.is_active 
FROM achievements
2026-01-18 04:33:17 | INFO     | sqlalchemy.engine.Engine | [cached since 205.5s ago] ()
2026-01-18 04:33:17 | INFO     | mybuddy.api | build_dashboard: end child_id=767166ac-39ef-4412-b0f5-72998235b319 unlocked=4 locked=16
2026-01-18 04:33:17 | INFO     | uvicorn.access | 10.3.6.1:0 - "GET /v1/children/767166ac-39ef-4412-b0f5-72998235b319/dashboard HTTP/1.1" 200
2026-01-18 04:33:17 | INFO     | sqlalchemy.engine.Engine | ROLLBACK
2026-01-18 04:33:18 | INFO     | sqlalchemy.engine.Engine | BEGIN (implicit)
2026-01-18 04:33:18 | INFO     | sqlalchemy.engine.Engine | SELECT children.created_at, children.updated_at, children.id, children.owner_sub, children.name, children.birthday, children.interests, children.avatar_id 
FROM children 
WHERE children.id = $1::UUID AND children.owner_sub = $2::VARCHAR
2026-01-18 04:33:18 | INFO     | sqlalchemy.engine.Engine | [cached since 206.6s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), '3a26e22b-005d-4dc6-ac5f-bc66f95d8748')
2026-01-18 04:33:18 | INFO     | mybuddy.api | build_dashboard: start child_id=767166ac-39ef-4412-b0f5-72998235b319
2026-01-18 04:33:18 | INFO     | sqlalchemy.engine.Engine | SELECT child_activity_events.kind, count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID GROUP BY child_activity_events.kind
2026-01-18 04:33:18 | INFO     | sqlalchemy.engine.Engine | [cached since 206.4s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'),)
2026-01-18 04:33:18 | INFO     | sqlalchemy.engine.Engine | SELECT coalesce(sum(child_activity_events.points), $1::INTEGER) AS coalesce_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $2::UUID
2026-01-18 04:33:18 | INFO     | sqlalchemy.engine.Engine | [cached since 206.4s ago] (0, UUID('767166ac-39ef-4412-b0f5-72998235b319'))
2026-01-18 04:33:18 | INFO     | mybuddy.api | progress_totals: child_id=767166ac-39ef-4412-b0f5-72998235b319 totalPoints=430 counts={'affirmation': 2, 'flashcard': 50}
2026-01-18 04:33:18 | INFO     | sqlalchemy.engine.Engine | SELECT child_activity_events.kind, count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.created_at >= $2::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $3::TIMESTAMP WITH TIME ZONE GROUP BY child_activity_events.kind
2026-01-18 04:33:18 | INFO     | sqlalchemy.engine.Engine | [cached since 206.4s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:33:18 | INFO     | sqlalchemy.engine.Engine | SELECT coalesce(sum(child_activity_events.points), $1::INTEGER) AS coalesce_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $2::UUID AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE
2026-01-18 04:33:18 | INFO     | sqlalchemy.engine.Engine | [cached since 206.4s ago] (0, UUID('767166ac-39ef-4412-b0f5-72998235b319'), datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:33:18 | INFO     | sqlalchemy.engine.Engine | SELECT count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.kind = $2::VARCHAR AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE AND child_activity_events.correct = true
2026-01-18 04:33:18 | INFO     | sqlalchemy.engine.Engine | [cached since 206.4s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), 'flashcard', datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:33:18 | INFO     | mybuddy.api | progress_today: child_id=767166ac-39ef-4412-b0f5-72998235b319 date=2026-01-17 counts={'affirmation': 2, 'flashcard': 50} flash_correct=40 totalPoints=430
2026-01-18 04:33:18 | INFO     | sqlalchemy.engine.Engine | SELECT coalesce(sum(child_activity_events.points), $1::INTEGER) AS coalesce_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $2::UUID AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE
2026-01-18 04:33:18 | INFO     | sqlalchemy.engine.Engine | [cached since 206.4s ago] (0, UUID('767166ac-39ef-4412-b0f5-72998235b319'), datetime.datetime(2026, 1, 11, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:33:18 | INFO     | sqlalchemy.engine.Engine | SELECT count(DISTINCT ((child_activity_events.created_at AT TIME ZONE 'America/New_York')::date)) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.created_at >= $2::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $3::TIMESTAMP WITH TIME ZONE
2026-01-18 04:33:18 | INFO     | sqlalchemy.engine.Engine | [cached since 204.7s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), datetime.datetime(2026, 1, 11, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:33:18 | INFO     | sqlalchemy.engine.Engine | SELECT child_activity_events.kind, count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.created_at >= $2::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $3::TIMESTAMP WITH TIME ZONE GROUP BY child_activity_events.kind
2026-01-18 04:33:18 | INFO     | sqlalchemy.engine.Engine | [cached since 206.4s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), datetime.datetime(2026, 1, 11, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:33:18 | INFO     | sqlalchemy.engine.Engine | SELECT count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.kind = $2::VARCHAR AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE AND child_activity_events.correct = true
2026-01-18 04:33:18 | INFO     | sqlalchemy.engine.Engine | [cached since 206.4s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), 'flashcard', datetime.datetime(2026, 1, 11, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:33:18 | INFO     | mybuddy.api | progress_week: child_id=767166ac-39ef-4412-b0f5-72998235b319 weekStart=2026-01-11 counts={'affirmation': 2, 'flashcard': 50} flash_correct=40 accuracyPct=80 totalPoints=430 daysActive=1
2026-01-18 04:33:18 | INFO     | sqlalchemy.engine.Engine | SELECT DISTINCT child_activity_events.chore_id 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.kind = $2::VARCHAR AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE AND child_activity_events.chore_id IS NOT NULL
2026-01-18 04:33:18 | INFO     | sqlalchemy.engine.Engine | [cached since 204.7s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), 'chore', datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:33:18 | INFO     | sqlalchemy.engine.Engine | SELECT DISTINCT child_activity_events.outdoor_activity_id 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.kind = $2::VARCHAR AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE AND child_activity_events.outdoor_activity_id IS NOT NULL
2026-01-18 04:33:18 | INFO     | sqlalchemy.engine.Engine | [cached since 204.7s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), 'outdoor', datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:33:18 | INFO     | sqlalchemy.engine.Engine | SELECT children.created_at, children.updated_at, children.id, children.owner_sub, children.name, children.birthday, children.interests, children.avatar_id 
FROM children 
WHERE children.id = $1::UUID
2026-01-18 04:33:18 | INFO     | sqlalchemy.engine.Engine | [cached since 206.5s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'),)
2026-01-18 04:33:18 | INFO     | sqlalchemy.engine.Engine | SELECT age_ranges.id, age_ranges.code, age_ranges.name, age_ranges.min_age, age_ranges.max_age, age_ranges.is_active 
FROM age_ranges 
WHERE age_ranges.min_age <= $1::INTEGER AND (age_ranges.max_age IS NULL OR age_ranges.max_age >= $2::INTEGER) AND age_ranges.is_active = true
2026-01-18 04:33:18 | INFO     | sqlalchemy.engine.Engine | [cached since 206.5s ago] (8, 8)
2026-01-18 04:33:18 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code 
FROM subjects JOIN subject_age_ranges ON subjects.id = subject_age_ranges.subject_id 
WHERE subject_age_ranges.age_range_id = $1::UUID ORDER BY subjects.code
2026-01-18 04:33:18 | INFO     | sqlalchemy.engine.Engine | [cached since 206.5s ago] (UUID('1aea8d41-8a9a-4631-a8d7-b8ef59d74bfc'),)
2026-01-18 04:33:18 | INFO     | sqlalchemy.engine.Engine | SELECT difficulty_thresholds.code, difficulty_thresholds.threshold 
FROM difficulty_thresholds 
WHERE difficulty_thresholds.is_active = true
2026-01-18 04:33:18 | INFO     | sqlalchemy.engine.Engine | [cached since 206.5s ago] ()
2026-01-18 04:33:18 | INFO     | mybuddy.api | difficulty_thresholds: child_id=767166ac-39ef-4412-b0f5-72998235b319 thresholds={'easy': 0, 'medium': 25, 'hard': 50, 'impossible': 100}
2026-01-18 04:33:18 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code AS subject_code, count(child_activity_events.id) AS completed, coalesce(sum(CASE WHEN (child_activity_events.correct = true) THEN $1::INTEGER ELSE $2::INTEGER END), $3::INTEGER) AS correct 
FROM child_activity_events JOIN subjects ON subjects.id = child_activity_events.subject_id 
WHERE child_activity_events.child_id = $4::UUID AND child_activity_events.kind = $5::VARCHAR GROUP BY subjects.code
2026-01-18 04:33:18 | INFO     | sqlalchemy.engine.Engine | [cached since 206.5s ago] (1, 0, 0, UUID('767166ac-39ef-4412-b0f5-72998235b319'), 'flashcard')
2026-01-18 04:33:18 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code, child_subject_streaks.current_streak, child_subject_streaks.longest_streak 
FROM child_subject_streaks JOIN subjects ON subjects.id = child_subject_streaks.subject_id 
WHERE child_subject_streaks.child_id = $1::UUID
2026-01-18 04:33:18 | INFO     | sqlalchemy.engine.Engine | [cached since 206.5s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'),)
2026-01-18 04:33:18 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code, child_subject_difficulty.difficulty_code 
FROM child_subject_difficulty JOIN subjects ON subjects.id = child_subject_difficulty.subject_id 
WHERE child_subject_difficulty.child_id = $1::UUID
2026-01-18 04:33:18 | INFO     | sqlalchemy.engine.Engine | [cached since 206.5s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'),)
2026-01-18 04:33:18 | INFO     | mybuddy.api | subject_difficulty_map: child_id=767166ac-39ef-4412-b0f5-72998235b319 diff_map={'math': 'easy', 'science': 'easy', 'reading': 'easy', 'history': 'easy'}
2026-01-18 04:33:18 | INFO     | mybuddy.api | dashboard_flashcards_by_subject: child_id=767166ac-39ef-4412-b0f5-72998235b319 by_subject={'history': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 12, 'longestStreak': 18}, 'math': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 0, 'longestStreak': 6}, 'reading': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 0, 'longestStreak': 0}, 'science': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 2, 'longestStreak': 4}}
2026-01-18 04:33:18 | INFO     | sqlalchemy.engine.Engine | SELECT DISTINCT ((child_activity_events.created_at AT TIME ZONE 'America/New_York')::date) AS d 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.created_at >= $2::TIMESTAMP WITH TIME ZONE ORDER BY d DESC
2026-01-18 04:33:18 | INFO     | sqlalchemy.engine.Engine | [cached since 206.5s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), datetime.datetime(2025, 7, 21, 4, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:33:18 | INFO     | sqlalchemy.engine.Engine | SELECT level_thresholds.id, level_thresholds.name, level_thresholds.threshold, level_thresholds.icon, level_thresholds.color, level_thresholds.is_active 
FROM level_thresholds 
WHERE level_thresholds.is_active = true
2026-01-18 04:33:18 | INFO     | sqlalchemy.engine.Engine | [cached since 206.6s ago] ()
2026-01-18 04:33:18 | INFO     | mybuddy.api | build_dashboard: loaded child_id=767166ac-39ef-4412-b0f5-72998235b319 core_subjects=['history', 'math', 'reading', 'science'] by_subject_keys=['history', 'math', 'reading', 'science'] totalPoints=430
2026-01-18 04:33:18 | INFO     | sqlalchemy.engine.Engine | SELECT child_balanced_progress_counters.id, child_balanced_progress_counters.child_id, child_balanced_progress_counters.subject_code, child_balanced_progress_counters.correct_count, child_balanced_progress_counters.updated_at 
FROM child_balanced_progress_counters 
WHERE child_balanced_progress_counters.child_id = $1::UUID
2026-01-18 04:33:18 | INFO     | sqlalchemy.engine.Engine | [cached since 204.7s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'),)
2026-01-18 04:33:18 | INFO     | sqlalchemy.engine.Engine | SELECT child_progress.child_id, child_progress.total_points, child_progress.total_flashcards, child_progress.total_chores, child_progress.total_outdoor, child_progress.total_affirmations, child_progress.current_streak, child_progress.longest_streak, child_progress.last_active_date, child_progress.last_seen_at, child_progress.current_level, child_progress.subject_counts 
FROM child_progress 
WHERE child_progress.child_id = $1::UUID
2026-01-18 04:33:18 | INFO     | sqlalchemy.engine.Engine | [cached since 206.6s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'),)
2026-01-18 04:33:18 | INFO     | sqlalchemy.engine.Engine | SELECT achievements.code, child_achievements.unlocked_at 
FROM achievements JOIN child_achievements ON child_achievements.achievement_id = achievements.id 
WHERE child_achievements.child_id = $1::UUID
2026-01-18 04:33:18 | INFO     | sqlalchemy.engine.Engine | [cached since 204.7s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'),)
2026-01-18 04:33:18 | INFO     | sqlalchemy.engine.Engine | SELECT achievements.created_at, achievements.updated_at, achievements.id, achievements.code, achievements.title, achievements.description, achievements.icon, achievements.achievement_type, achievements.points_threshold, achievements.streak_days_threshold, achievements.flashcards_count_threshold, achievements.chores_count_threshold, achievements.outdoor_count_threshold, achievements.is_active 
FROM achievements
2026-01-18 04:33:18 | INFO     | sqlalchemy.engine.Engine | [cached since 206.5s ago] ()
2026-01-18 04:33:18 | INFO     | mybuddy.api | build_dashboard: end child_id=767166ac-39ef-4412-b0f5-72998235b319 unlocked=4 locked=16
2026-01-18 04:33:18 | INFO     | uvicorn.access | 10.3.6.1:0 - "GET /v1/children/767166ac-39ef-4412-b0f5-72998235b319/dashboard HTTP/1.1" 200
2026-01-18 04:33:18 | INFO     | sqlalchemy.engine.Engine | ROLLBACK
2026-01-18 04:33:33 | INFO     | sqlalchemy.engine.Engine | BEGIN (implicit)
2026-01-18 04:33:33 | INFO     | sqlalchemy.engine.Engine | SELECT children.created_at, children.updated_at, children.id, children.owner_sub, children.name, children.birthday, children.interests, children.avatar_id 
FROM children 
WHERE children.id = $1::UUID AND children.owner_sub = $2::VARCHAR
2026-01-18 04:33:33 | INFO     | sqlalchemy.engine.Engine | [cached since 221.4s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), '3a26e22b-005d-4dc6-ac5f-bc66f95d8748')
2026-01-18 04:33:33 | INFO     | mybuddy.api | list_flashcards: child_id=767166ac-39ef-4412-b0f5-72998235b319 subjectCode=math difficultyCode=easy limit=5
2026-01-18 04:33:33 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.id 
FROM subjects 
 LIMIT $1::INTEGER
2026-01-18 04:33:33 | INFO     | sqlalchemy.engine.Engine | [generated in 0.00067s] (1,)
2026-01-18 04:33:33 | INFO     | sqlalchemy.engine.Engine | SELECT age_ranges.id, age_ranges.code, age_ranges.name, age_ranges.min_age, age_ranges.max_age, age_ranges.is_active 
FROM age_ranges 
WHERE age_ranges.min_age <= $1::INTEGER AND (age_ranges.max_age IS NULL OR age_ranges.max_age >= $2::INTEGER) AND age_ranges.is_active = true
2026-01-18 04:33:33 | INFO     | sqlalchemy.engine.Engine | [cached since 221.3s ago] (8, 8)
2026-01-18 04:33:33 | INFO     | mybuddy.api | list_flashcards: resolved age_range_id=1aea8d41-8a9a-4631-a8d7-b8ef59d74bfc child_id=767166ac-39ef-4412-b0f5-72998235b319
2026-01-18 04:33:33 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.id, subjects.code, subjects.name, subjects.icon, subjects.color 
FROM subjects 
WHERE subjects.code = $1::VARCHAR
2026-01-18 04:33:33 | INFO     | sqlalchemy.engine.Engine | [generated in 0.00065s] ('math',)
2026-01-18 04:33:33 | INFO     | sqlalchemy.engine.Engine | SELECT subject_age_ranges.subject_id, subject_age_ranges.age_range_id 
FROM subject_age_ranges 
WHERE subject_age_ranges.subject_id = $1::UUID AND subject_age_ranges.age_range_id = $2::UUID
2026-01-18 04:33:33 | INFO     | sqlalchemy.engine.Engine | [generated in 0.00084s] (UUID('73c23c39-1a46-4a0a-9f0d-6b8f44a61635'), UUID('1aea8d41-8a9a-4631-a8d7-b8ef59d74bfc'))
2026-01-18 04:33:33 | INFO     | sqlalchemy.engine.Engine | SELECT difficulty_thresholds.id 
FROM difficulty_thresholds 
WHERE difficulty_thresholds.code = $1::VARCHAR
2026-01-18 04:33:33 | INFO     | sqlalchemy.engine.Engine | [generated in 0.00064s] ('easy',)
2026-01-18 04:33:33 | INFO     | sqlalchemy.engine.Engine | SELECT flashcards.id, flashcards.subject_id, flashcards.question, flashcards.choices, flashcards.explanations, flashcards.correct_index, flashcards.difficulty_code, flashcards.tags, flashcards.age_range_id 
FROM flashcards JOIN (SELECT flashcards.id AS fc_id, child_flashcard_performance.incorrect_count AS wrong_cnt, child_flashcard_performance.correct_count AS correct_cnt, CASE WHEN (child_flashcard_performance.incorrect_count IS NULL) THEN $1::INTEGER ELSE child_flashcard_performance.incorrect_count END AS wrong_score, CASE WHEN (child_flashcard_performance.correct_count IS NULL) THEN $2::INTEGER ELSE child_flashcard_performance.correct_count END AS correct_score, random() AS rnd 
FROM flashcards LEFT OUTER JOIN child_flashcard_performance ON child_flashcard_performance.child_id = $3::UUID AND child_flashcard_performance.flashcard_id = flashcards.id 
WHERE flashcards.subject_id = $4::UUID AND flashcards.difficulty_code = $5::VARCHAR AND flashcards.age_range_id = $6::UUID ORDER BY CASE WHEN (child_flashcard_performance.incorrect_count IS NULL) THEN $1::INTEGER ELSE child_flashcard_performance.incorrect_count END DESC, CASE WHEN (child_flashcard_performance.correct_count IS NULL) THEN $2::INTEGER ELSE child_flashcard_performance.correct_count END ASC, random()) AS anon_1 ON flashcards.id = anon_1.fc_id ORDER BY anon_1.wrong_score DESC, anon_1.correct_score ASC, anon_1.rnd ASC 
 LIMIT $7::INTEGER
2026-01-18 04:33:33 | INFO     | sqlalchemy.engine.Engine | [generated in 0.00082s] (10000, 0, UUID('767166ac-39ef-4412-b0f5-72998235b319'), UUID('73c23c39-1a46-4a0a-9f0d-6b8f44a61635'), 'easy', UUID('1aea8d41-8a9a-4631-a8d7-b8ef59d74bfc'), 5)
2026-01-18 04:33:33 | INFO     | mybuddy.api | list_flashcards: returned count=5 child_id=767166ac-39ef-4412-b0f5-72998235b319 subjectCode=math difficultyCode=easy age_range_id=1aea8d41-8a9a-4631-a8d7-b8ef59d74bfc
2026-01-18 04:33:33 | INFO     | sqlalchemy.engine.Engine | SELECT flashcards.id, flashcards.tags, child_flashcard_performance.incorrect_count, child_flashcard_performance.correct_count 
FROM flashcards LEFT OUTER JOIN child_flashcard_performance ON child_flashcard_performance.child_id = $1::UUID AND child_flashcard_performance.flashcard_id = flashcards.id 
WHERE flashcards.id IN ($2::UUID, $3::UUID, $4::UUID, $5::UUID, $6::UUID)
2026-01-18 04:33:33 | INFO     | sqlalchemy.engine.Engine | [generated in 0.00094s] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), UUID('64a254a7-1c53-4189-bf14-0819550eddbb'), UUID('7ee372ba-9591-4d9d-be6a-a6aaa0d76a90'), UUID('6c3e3370-e875-4180-aaba-55c59aeb48a7'), UUID('a6bedbb5-85d9-46d0-b657-69df2fcbc7e6'), UUID('fcb38dbb-83e3-4c06-a134-3dafec0999cf'))
2026-01-18 04:33:33 | INFO     | mybuddy.api | list_flashcards: returned_debug child_id=767166ac-39ef-4412-b0f5-72998235b319 subjectCode=math difficultyCode=easy rows=[{'i': 0, 'id': '64a254a7-1c53-4189-bf14-0819550eddbb', 'wrong_cnt': 1, 'correct_cnt': 0, 'tags': ['rounding_whole_numbers_to_place']}, {'i': 1, 'id': '7ee372ba-9591-4d9d-be6a-a6aaa0d76a90', 'wrong_cnt': 1, 'correct_cnt': 0, 'tags': ['order_of_operations_no_parentheses']}, {'i': 2, 'id': '6c3e3370-e875-4180-aaba-55c59aeb48a7', 'wrong_cnt': 1, 'correct_cnt': 0, 'tags': ['lcm_of_two_numbers_under_20']}, {'i': 3, 'id': 'a6bedbb5-85d9-46d0-b657-69df2fcbc7e6', 'wrong_cnt': 1, 'correct_cnt': 0, 'tags': ['expanded_form_whole_numbers']}, {'i': 4, 'id': 'fcb38dbb-83e3-4c06-a134-3dafec0999cf', 'wrong_cnt': 1, 'correct_cnt': 0, 'tags': ['mean_average_of_small_data_set']}]
2026-01-18 04:33:33 | INFO     | uvicorn.access | 10.3.6.1:0 - "GET /v1/flashcards?subjectCode=math&difficultyCode=easy&childId=767166ac-39ef-4412-b0f5-72998235b319 HTTP/1.1" 200
2026-01-18 04:33:33 | INFO     | sqlalchemy.engine.Engine | ROLLBACK
2026-01-18 04:33:39 | INFO     | sqlalchemy.engine.Engine | BEGIN (implicit)
2026-01-18 04:33:39 | INFO     | sqlalchemy.engine.Engine | SELECT children.created_at, children.updated_at, children.id, children.owner_sub, children.name, children.birthday, children.interests, children.avatar_id 
FROM children 
WHERE children.id = $1::UUID AND children.owner_sub = $2::VARCHAR
2026-01-18 04:33:39 | INFO     | sqlalchemy.engine.Engine | [cached since 227.5s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), '3a26e22b-005d-4dc6-ac5f-bc66f95d8748')
2026-01-18 04:33:39 | INFO     | mybuddy.api | event_flashcard: start child_id=767166ac-39ef-4412-b0f5-72998235b319 flashcardId=64a254a7-1c53-4189-bf14-0819550eddbb correct=True
2026-01-18 04:33:39 | INFO     | sqlalchemy.engine.Engine | SELECT points_values.id, points_values.code, points_values.name, points_values.points, points_values.is_active 
FROM points_values 
WHERE points_values.is_active = true
2026-01-18 04:33:39 | INFO     | sqlalchemy.engine.Engine | [cached since 227.5s ago] ()
2026-01-18 04:33:39 | INFO     | sqlalchemy.engine.Engine | SELECT flashcards.id, flashcards.subject_id, flashcards.question, flashcards.choices, flashcards.explanations, flashcards.correct_index, flashcards.difficulty_code, flashcards.tags, flashcards.age_range_id 
FROM flashcards 
WHERE flashcards.id = $1::UUID
2026-01-18 04:33:39 | INFO     | sqlalchemy.engine.Engine | [cached since 227.5s ago] (UUID('64a254a7-1c53-4189-bf14-0819550eddbb'),)
2026-01-18 04:33:39 | INFO     | mybuddy.api | event_flashcard: validated child_id=767166ac-39ef-4412-b0f5-72998235b319 flashcardId=64a254a7-1c53-4189-bf14-0819550eddbb subject_id=73c23c39-1a46-4a0a-9f0d-6b8f44a61635 points=10
2026-01-18 04:33:39 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.id, subjects.code, subjects.name, subjects.icon, subjects.color 
FROM subjects 
WHERE subjects.id = $1::UUID
2026-01-18 04:33:39 | INFO     | sqlalchemy.engine.Engine | [cached since 227.5s ago] (UUID('73c23c39-1a46-4a0a-9f0d-6b8f44a61635'),)
2026-01-18 04:33:39 | INFO     | sqlalchemy.engine.Engine | SAVEPOINT sa_savepoint_1
2026-01-18 04:33:39 | INFO     | sqlalchemy.engine.Engine | [no key 0.00053s] ()
2026-01-18 04:33:39 | INFO     | sqlalchemy.engine.Engine | INSERT INTO child_activity_events (child_id, kind, subject_id, flashcard_id, chore_id, outdoor_activity_id, affirmation_id, points, correct, answer, meta) VALUES ($1::UUID, $2::VARCHAR, $3::UUID, $4::UUID, $5::UUID, $6::UUID, $7::UUID, $8::INTEGER, $9::BOOLEAN, $10::VARCHAR, $11::JSONB) RETURNING child_activity_events.id, child_activity_events.created_at
2026-01-18 04:33:39 | INFO     | sqlalchemy.engine.Engine | [cached since 227.5s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), 'flashcard', UUID('73c23c39-1a46-4a0a-9f0d-6b8f44a61635'), UUID('64a254a7-1c53-4189-bf14-0819550eddbb'), None, None, None, 10, True, '3,400', '{"dedupeKey": "flashcard:64a254a7-1c53-4189-bf14-0819550eddbb", "flashcardId": "64a254a7-1c53-4189-bf14-0819550eddbb", "subjectId": "73c23c39-1a46-4a0a-9f0d-6b8f44a61635", "correct": true, "answer": "3,400", "points": 10}')
2026-01-18 04:33:39 | INFO     | sqlalchemy.engine.Engine | ROLLBACK TO SAVEPOINT sa_savepoint_1
2026-01-18 04:33:39 | INFO     | sqlalchemy.engine.Engine | [no key 0.00061s] ()
2026-01-18 04:33:39 | INFO     | mybuddy.api | event_flashcard: deduped child_id=767166ac-39ef-4412-b0f5-72998235b319 flashcardId=64a254a7-1c53-4189-bf14-0819550eddbb (award_points=0, update_perf=1, update_streak=1)
2026-01-18 04:33:39 | INFO     | sqlalchemy.engine.Engine | SELECT difficulty_thresholds.id, difficulty_thresholds.code, difficulty_thresholds.name, difficulty_thresholds.label, difficulty_thresholds.icon, difficulty_thresholds.color, difficulty_thresholds.threshold, difficulty_thresholds.is_active 
FROM difficulty_thresholds 
WHERE difficulty_thresholds.is_active = true
2026-01-18 04:33:39 | INFO     | sqlalchemy.engine.Engine | [cached since 227.5s ago] ()
2026-01-18 04:33:39 | INFO     | sqlalchemy.engine.Engine | SELECT child_subject_difficulty.child_id, child_subject_difficulty.subject_id, child_subject_difficulty.difficulty_code, child_subject_difficulty.last_updated 
FROM child_subject_difficulty 
WHERE child_subject_difficulty.child_id = $1::UUID AND child_subject_difficulty.subject_id = $2::UUID
2026-01-18 04:33:39 | INFO     | sqlalchemy.engine.Engine | [cached since 227.5s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), UUID('73c23c39-1a46-4a0a-9f0d-6b8f44a61635'))
2026-01-18 04:33:39 | INFO     | sqlalchemy.engine.Engine | SELECT child_subject_streaks.child_id, child_subject_streaks.subject_id, child_subject_streaks.current_streak, child_subject_streaks.longest_streak, child_subject_streaks.last_updated 
FROM child_subject_streaks 
WHERE child_subject_streaks.child_id = $1::UUID AND child_subject_streaks.subject_id = $2::UUID
2026-01-18 04:33:39 | INFO     | sqlalchemy.engine.Engine | [cached since 227.5s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), UUID('73c23c39-1a46-4a0a-9f0d-6b8f44a61635'))
2026-01-18 04:33:39 | INFO     | sqlalchemy.engine.Engine | UPDATE child_subject_streaks SET current_streak=$1::INTEGER, last_updated=$2::TIMESTAMP WITH TIME ZONE WHERE child_subject_streaks.child_id = $3::UUID AND child_subject_streaks.subject_id = $4::UUID
2026-01-18 04:33:39 | INFO     | sqlalchemy.engine.Engine | [cached since 227.5s ago] (1, datetime.datetime(2026, 1, 18, 4, 33, 39, 520446, tzinfo=datetime.timezone.utc), UUID('767166ac-39ef-4412-b0f5-72998235b319'), UUID('73c23c39-1a46-4a0a-9f0d-6b8f44a61635'))
2026-01-18 04:33:39 | INFO     | sqlalchemy.engine.Engine | SELECT child_balanced_progress_counters.id, child_balanced_progress_counters.child_id, child_balanced_progress_counters.subject_code, child_balanced_progress_counters.correct_count, child_balanced_progress_counters.updated_at 
FROM child_balanced_progress_counters 
WHERE child_balanced_progress_counters.child_id = $1::UUID AND child_balanced_progress_counters.subject_code = $2::VARCHAR
2026-01-18 04:33:39 | INFO     | sqlalchemy.engine.Engine | [cached since 227.5s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), 'math')
2026-01-18 04:33:39 | INFO     | sqlalchemy.engine.Engine | UPDATE child_balanced_progress_counters SET correct_count=$1::INTEGER, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE child_balanced_progress_counters.id = $3::UUID
2026-01-18 04:33:39 | INFO     | sqlalchemy.engine.Engine | [cached since 227.5s ago] (19, datetime.datetime(2026, 1, 18, 4, 33, 39, 531589, tzinfo=datetime.timezone.utc), UUID('4cdd2f9d-ec9b-4704-8505-26aabc45a383'))
2026-01-18 04:33:39 | INFO     | sqlalchemy.engine.Engine | SELECT child_flashcard_performance.created_at, child_flashcard_performance.updated_at, child_flashcard_performance.child_id, child_flashcard_performance.flashcard_id, child_flashcard_performance.correct_count, child_flashcard_performance.incorrect_count, child_flashcard_performance.last_seen_at 
FROM child_flashcard_performance 
WHERE child_flashcard_performance.child_id = $1::UUID AND child_flashcard_performance.flashcard_id = $2::UUID
2026-01-18 04:33:39 | INFO     | sqlalchemy.engine.Engine | [cached since 227.5s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), UUID('64a254a7-1c53-4189-bf14-0819550eddbb'))
2026-01-18 04:33:39 | INFO     | mybuddy.api | event_flashcard: dedupe_update_perf child_id=767166ac-39ef-4412-b0f5-72998235b319 flashcardId=64a254a7-1c53-4189-bf14-0819550eddbb correct 0->1 incorrect 1->1
2026-01-18 04:33:39 | INFO     | sqlalchemy.engine.Engine | UPDATE child_flashcard_performance SET updated_at=timezone($1::VARCHAR, now()), correct_count=$2::INTEGER, last_seen_at=$3::TIMESTAMP WITH TIME ZONE WHERE child_flashcard_performance.child_id = $4::UUID AND child_flashcard_performance.flashcard_id = $5::UUID
2026-01-18 04:33:39 | INFO     | sqlalchemy.engine.Engine | [generated in 0.00074s] ('utc', 1, datetime.datetime(2026, 1, 18, 4, 33, 39, 541863, tzinfo=datetime.timezone.utc), UUID('767166ac-39ef-4412-b0f5-72998235b319'), UUID('64a254a7-1c53-4189-bf14-0819550eddbb'))
2026-01-18 04:33:39 | INFO     | sqlalchemy.engine.Engine | SAVEPOINT sa_savepoint_2
2026-01-18 04:33:39 | INFO     | sqlalchemy.engine.Engine | [no key 0.00053s] ()
2026-01-18 04:33:39 | INFO     | sqlalchemy.engine.Engine | INSERT INTO content_expansion_requests (child_id, subject_id, age_range_id, difficulty_code, trigger, status, dedupe_key, attempts, error, completed_at) VALUES ($1::UUID, $2::UUID, $3::UUID, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::INTEGER, $9::VARCHAR, $10::TIMESTAMP WITH TIME ZONE) RETURNING content_expansion_requests.id, content_expansion_requests.created_at, content_expansion_requests.updated_at
2026-01-18 04:33:39 | INFO     | sqlalchemy.engine.Engine | [generated in 0.00091s] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), UUID('73c23c39-1a46-4a0a-9f0d-6b8f44a61635'), UUID('1aea8d41-8a9a-4631-a8d7-b8ef59d74bfc'), 'easy', 'dedupe_repeat', 'pending', '2026-01-18T04:33:767166ac-39ef-4412-b0f5-72998235b319:73c23c39-1a46-4a0a-9f0d-6b8f44a61635:1aea8d41-8a9a-4631-a8d7-b8ef59d74bfc:easy:dedupe_repeat', 0, None, None)
2026-01-18 04:33:39 | INFO     | sqlalchemy.engine.Engine | RELEASE SAVEPOINT sa_savepoint_2
2026-01-18 04:33:39 | INFO     | sqlalchemy.engine.Engine | [no key 0.00058s] ()
2026-01-18 04:33:39 | INFO     | mybuddy.api | content_expansion_request: created id=91088a44-63df-41f2-8346-10768d47526b dedupe_key=2026-01-18T04:33:767166ac-39ef-4412-b0f5-72998235b319:73c23c39-1a46-4a0a-9f0d-6b8f44a61635:1aea8d41-8a9a-4631-a8d7-b8ef59d74bfc:easy:dedupe_repeat
2026-01-18 04:33:39 | INFO     | sqlalchemy.engine.Engine | SELECT children.created_at, children.updated_at, children.id, children.owner_sub, children.name, children.birthday, children.interests, children.avatar_id 
FROM children 
WHERE children.id = $1::UUID
2026-01-18 04:33:39 | INFO     | sqlalchemy.engine.Engine | [cached since 227.5s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'),)
2026-01-18 04:33:39 | INFO     | sqlalchemy.engine.Engine | SELECT age_ranges.id, age_ranges.code, age_ranges.name, age_ranges.min_age, age_ranges.max_age, age_ranges.is_active 
FROM age_ranges 
WHERE age_ranges.min_age <= $1::INTEGER AND (age_ranges.max_age IS NULL OR age_ranges.max_age >= $2::INTEGER) AND age_ranges.is_active = true
2026-01-18 04:33:39 | INFO     | sqlalchemy.engine.Engine | [cached since 227.5s ago] (8, 8)
2026-01-18 04:33:39 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code 
FROM subjects JOIN subject_age_ranges ON subjects.id = subject_age_ranges.subject_id 
WHERE subject_age_ranges.age_range_id = $1::UUID ORDER BY subjects.code
2026-01-18 04:33:39 | INFO     | sqlalchemy.engine.Engine | [cached since 227.5s ago] (UUID('1aea8d41-8a9a-4631-a8d7-b8ef59d74bfc'),)
2026-01-18 04:33:39 | INFO     | sqlalchemy.engine.Engine | SELECT child_progress.child_id, child_progress.total_points, child_progress.total_flashcards, child_progress.total_chores, child_progress.total_outdoor, child_progress.total_affirmations, child_progress.current_streak, child_progress.longest_streak, child_progress.last_active_date, child_progress.last_seen_at, child_progress.current_level, child_progress.subject_counts 
FROM child_progress 
WHERE child_progress.child_id = $1::UUID
2026-01-18 04:33:39 | INFO     | sqlalchemy.engine.Engine | [cached since 227.5s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'),)
2026-01-18 04:33:39 | INFO     | sqlalchemy.engine.Engine | SELECT level_thresholds.id, level_thresholds.name, level_thresholds.threshold, level_thresholds.icon, level_thresholds.color, level_thresholds.is_active 
FROM level_thresholds 
WHERE level_thresholds.is_active = true
2026-01-18 04:33:39 | INFO     | sqlalchemy.engine.Engine | [cached since 227.5s ago] ()
2026-01-18 04:33:39 | INFO     | sqlalchemy.engine.Engine | SELECT child_balanced_progress_counters.id, child_balanced_progress_counters.child_id, child_balanced_progress_counters.subject_code, child_balanced_progress_counters.correct_count, child_balanced_progress_counters.updated_at 
FROM child_balanced_progress_counters 
WHERE child_balanced_progress_counters.child_id = $1::UUID AND child_balanced_progress_counters.subject_code IN ($2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR)
2026-01-18 04:33:39 | INFO     | sqlalchemy.engine.Engine | [cached since 227.5s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), 'history', 'math', 'reading', 'science')
2026-01-18 04:33:39 | INFO     | sqlalchemy.engine.Engine | COMMIT
2026-01-18 04:33:39 | INFO     | uvicorn.access | 10.3.6.1:0 - "POST /v1/children/767166ac-39ef-4412-b0f5-72998235b319/events/flashcard HTTP/1.1" 200
2026-01-18 04:33:41 | INFO     | sqlalchemy.engine.Engine | BEGIN (implicit)
2026-01-18 04:33:41 | INFO     | sqlalchemy.engine.Engine | SELECT children.created_at, children.updated_at, children.id, children.owner_sub, children.name, children.birthday, children.interests, children.avatar_id 
FROM children 
WHERE children.id = $1::UUID AND children.owner_sub = $2::VARCHAR
2026-01-18 04:33:41 | INFO     | sqlalchemy.engine.Engine | [cached since 229.3s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), '3a26e22b-005d-4dc6-ac5f-bc66f95d8748')
2026-01-18 04:33:41 | INFO     | mybuddy.api | build_dashboard: start child_id=767166ac-39ef-4412-b0f5-72998235b319
2026-01-18 04:33:41 | INFO     | sqlalchemy.engine.Engine | SELECT child_activity_events.kind, count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID GROUP BY child_activity_events.kind
2026-01-18 04:33:41 | INFO     | sqlalchemy.engine.Engine | [cached since 229.1s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'),)
2026-01-18 04:33:41 | INFO     | sqlalchemy.engine.Engine | SELECT coalesce(sum(child_activity_events.points), $1::INTEGER) AS coalesce_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $2::UUID
2026-01-18 04:33:41 | INFO     | sqlalchemy.engine.Engine | [cached since 229.1s ago] (0, UUID('767166ac-39ef-4412-b0f5-72998235b319'))
2026-01-18 04:33:41 | INFO     | mybuddy.api | progress_totals: child_id=767166ac-39ef-4412-b0f5-72998235b319 totalPoints=430 counts={'affirmation': 2, 'flashcard': 50}
2026-01-18 04:33:41 | INFO     | sqlalchemy.engine.Engine | SELECT child_activity_events.kind, count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.created_at >= $2::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $3::TIMESTAMP WITH TIME ZONE GROUP BY child_activity_events.kind
2026-01-18 04:33:41 | INFO     | sqlalchemy.engine.Engine | [cached since 229.1s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:33:41 | INFO     | sqlalchemy.engine.Engine | SELECT coalesce(sum(child_activity_events.points), $1::INTEGER) AS coalesce_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $2::UUID AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE
2026-01-18 04:33:41 | INFO     | sqlalchemy.engine.Engine | [cached since 229.1s ago] (0, UUID('767166ac-39ef-4412-b0f5-72998235b319'), datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:33:41 | INFO     | sqlalchemy.engine.Engine | SELECT count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.kind = $2::VARCHAR AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE AND child_activity_events.correct = true
2026-01-18 04:33:41 | INFO     | sqlalchemy.engine.Engine | [cached since 229.1s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), 'flashcard', datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:33:41 | INFO     | mybuddy.api | progress_today: child_id=767166ac-39ef-4412-b0f5-72998235b319 date=2026-01-17 counts={'affirmation': 2, 'flashcard': 50} flash_correct=40 totalPoints=430
2026-01-18 04:33:41 | INFO     | sqlalchemy.engine.Engine | SELECT coalesce(sum(child_activity_events.points), $1::INTEGER) AS coalesce_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $2::UUID AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE
2026-01-18 04:33:41 | INFO     | sqlalchemy.engine.Engine | [cached since 229.1s ago] (0, UUID('767166ac-39ef-4412-b0f5-72998235b319'), datetime.datetime(2026, 1, 11, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:33:41 | INFO     | sqlalchemy.engine.Engine | SELECT count(DISTINCT ((child_activity_events.created_at AT TIME ZONE 'America/New_York')::date)) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.created_at >= $2::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $3::TIMESTAMP WITH TIME ZONE
2026-01-18 04:33:41 | INFO     | sqlalchemy.engine.Engine | [cached since 227.4s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), datetime.datetime(2026, 1, 11, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:33:41 | INFO     | sqlalchemy.engine.Engine | SELECT child_activity_events.kind, count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.created_at >= $2::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $3::TIMESTAMP WITH TIME ZONE GROUP BY child_activity_events.kind
2026-01-18 04:33:41 | INFO     | sqlalchemy.engine.Engine | [cached since 229.1s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), datetime.datetime(2026, 1, 11, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:33:41 | INFO     | sqlalchemy.engine.Engine | SELECT count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.kind = $2::VARCHAR AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE AND child_activity_events.correct = true
2026-01-18 04:33:41 | INFO     | sqlalchemy.engine.Engine | [cached since 229.1s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), 'flashcard', datetime.datetime(2026, 1, 11, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:33:41 | INFO     | mybuddy.api | progress_week: child_id=767166ac-39ef-4412-b0f5-72998235b319 weekStart=2026-01-11 counts={'affirmation': 2, 'flashcard': 50} flash_correct=40 accuracyPct=80 totalPoints=430 daysActive=1
2026-01-18 04:33:41 | INFO     | sqlalchemy.engine.Engine | SELECT DISTINCT child_activity_events.chore_id 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.kind = $2::VARCHAR AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE AND child_activity_events.chore_id IS NOT NULL
2026-01-18 04:33:41 | INFO     | sqlalchemy.engine.Engine | [cached since 227.4s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), 'chore', datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:33:41 | INFO     | sqlalchemy.engine.Engine | SELECT DISTINCT child_activity_events.outdoor_activity_id 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.kind = $2::VARCHAR AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE AND child_activity_events.outdoor_activity_id IS NOT NULL
2026-01-18 04:33:41 | INFO     | sqlalchemy.engine.Engine | [cached since 227.4s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), 'outdoor', datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:33:41 | INFO     | sqlalchemy.engine.Engine | SELECT children.created_at, children.updated_at, children.id, children.owner_sub, children.name, children.birthday, children.interests, children.avatar_id 
FROM children 
WHERE children.id = $1::UUID
2026-01-18 04:33:41 | INFO     | sqlalchemy.engine.Engine | [cached since 229.2s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'),)
2026-01-18 04:33:41 | INFO     | sqlalchemy.engine.Engine | SELECT age_ranges.id, age_ranges.code, age_ranges.name, age_ranges.min_age, age_ranges.max_age, age_ranges.is_active 
FROM age_ranges 
WHERE age_ranges.min_age <= $1::INTEGER AND (age_ranges.max_age IS NULL OR age_ranges.max_age >= $2::INTEGER) AND age_ranges.is_active = true
2026-01-18 04:33:41 | INFO     | sqlalchemy.engine.Engine | [cached since 229.2s ago] (8, 8)
2026-01-18 04:33:41 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code 
FROM subjects JOIN subject_age_ranges ON subjects.id = subject_age_ranges.subject_id 
WHERE subject_age_ranges.age_range_id = $1::UUID ORDER BY subjects.code
2026-01-18 04:33:41 | INFO     | sqlalchemy.engine.Engine | [cached since 229.2s ago] (UUID('1aea8d41-8a9a-4631-a8d7-b8ef59d74bfc'),)
2026-01-18 04:33:41 | INFO     | sqlalchemy.engine.Engine | SELECT difficulty_thresholds.code, difficulty_thresholds.threshold 
FROM difficulty_thresholds 
WHERE difficulty_thresholds.is_active = true
2026-01-18 04:33:41 | INFO     | sqlalchemy.engine.Engine | [cached since 229.1s ago] ()
2026-01-18 04:33:41 | INFO     | mybuddy.api | difficulty_thresholds: child_id=767166ac-39ef-4412-b0f5-72998235b319 thresholds={'easy': 0, 'medium': 25, 'hard': 50, 'impossible': 100}
2026-01-18 04:33:41 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code AS subject_code, count(child_activity_events.id) AS completed, coalesce(sum(CASE WHEN (child_activity_events.correct = true) THEN $1::INTEGER ELSE $2::INTEGER END), $3::INTEGER) AS correct 
FROM child_activity_events JOIN subjects ON subjects.id = child_activity_events.subject_id 
WHERE child_activity_events.child_id = $4::UUID AND child_activity_events.kind = $5::VARCHAR GROUP BY subjects.code
2026-01-18 04:33:41 | INFO     | sqlalchemy.engine.Engine | [cached since 229.1s ago] (1, 0, 0, UUID('767166ac-39ef-4412-b0f5-72998235b319'), 'flashcard')
2026-01-18 04:33:41 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code, child_subject_streaks.current_streak, child_subject_streaks.longest_streak 
FROM child_subject_streaks JOIN subjects ON subjects.id = child_subject_streaks.subject_id 
WHERE child_subject_streaks.child_id = $1::UUID
2026-01-18 04:33:41 | INFO     | sqlalchemy.engine.Engine | [cached since 229.1s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'),)
2026-01-18 04:33:41 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code, child_subject_difficulty.difficulty_code 
FROM child_subject_difficulty JOIN subjects ON subjects.id = child_subject_difficulty.subject_id 
WHERE child_subject_difficulty.child_id = $1::UUID
2026-01-18 04:33:41 | INFO     | sqlalchemy.engine.Engine | [cached since 229.1s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'),)
2026-01-18 04:33:41 | INFO     | mybuddy.api | subject_difficulty_map: child_id=767166ac-39ef-4412-b0f5-72998235b319 diff_map={'math': 'easy', 'science': 'easy', 'reading': 'easy', 'history': 'easy'}
2026-01-18 04:33:41 | INFO     | mybuddy.api | dashboard_flashcards_by_subject: child_id=767166ac-39ef-4412-b0f5-72998235b319 by_subject={'history': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 12, 'longestStreak': 18}, 'math': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 1, 'longestStreak': 6}, 'reading': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 0, 'longestStreak': 0}, 'science': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 2, 'longestStreak': 4}}
2026-01-18 04:33:41 | INFO     | sqlalchemy.engine.Engine | SELECT DISTINCT ((child_activity_events.created_at AT TIME ZONE 'America/New_York')::date) AS d 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.created_at >= $2::TIMESTAMP WITH TIME ZONE ORDER BY d DESC
2026-01-18 04:33:41 | INFO     | sqlalchemy.engine.Engine | [cached since 229.1s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'), datetime.datetime(2025, 7, 21, 4, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:33:41 | INFO     | sqlalchemy.engine.Engine | SELECT level_thresholds.id, level_thresholds.name, level_thresholds.threshold, level_thresholds.icon, level_thresholds.color, level_thresholds.is_active 
FROM level_thresholds 
WHERE level_thresholds.is_active = true
2026-01-18 04:33:41 | INFO     | sqlalchemy.engine.Engine | [cached since 229.2s ago] ()
2026-01-18 04:33:41 | INFO     | mybuddy.api | build_dashboard: loaded child_id=767166ac-39ef-4412-b0f5-72998235b319 core_subjects=['history', 'math', 'reading', 'science'] by_subject_keys=['history', 'math', 'reading', 'science'] totalPoints=430
2026-01-18 04:33:41 | INFO     | sqlalchemy.engine.Engine | SELECT child_balanced_progress_counters.id, child_balanced_progress_counters.child_id, child_balanced_progress_counters.subject_code, child_balanced_progress_counters.correct_count, child_balanced_progress_counters.updated_at 
FROM child_balanced_progress_counters 
WHERE child_balanced_progress_counters.child_id = $1::UUID
2026-01-18 04:33:41 | INFO     | sqlalchemy.engine.Engine | [cached since 227.4s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'),)
2026-01-18 04:33:41 | INFO     | sqlalchemy.engine.Engine | SELECT child_progress.child_id, child_progress.total_points, child_progress.total_flashcards, child_progress.total_chores, child_progress.total_outdoor, child_progress.total_affirmations, child_progress.current_streak, child_progress.longest_streak, child_progress.last_active_date, child_progress.last_seen_at, child_progress.current_level, child_progress.subject_counts 
FROM child_progress 
WHERE child_progress.child_id = $1::UUID
2026-01-18 04:33:41 | INFO     | sqlalchemy.engine.Engine | [cached since 229.2s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'),)
2026-01-18 04:33:41 | INFO     | sqlalchemy.engine.Engine | SELECT achievements.code, child_achievements.unlocked_at 
FROM achievements JOIN child_achievements ON child_achievements.achievement_id = achievements.id 
WHERE child_achievements.child_id = $1::UUID
2026-01-18 04:33:41 | INFO     | sqlalchemy.engine.Engine | [cached since 227.3s ago] (UUID('767166ac-39ef-4412-b0f5-72998235b319'),)
2026-01-18 04:33:41 | INFO     | sqlalchemy.engine.Engine | SELECT achievements.created_at, achievements.updated_at, achievements.id, achievements.code, achievements.title, achievements.description, achievements.icon, achievements.achievement_type, achievements.points_threshold, achievements.streak_days_threshold, achievements.flashcards_count_threshold, achievements.chores_count_threshold, achievements.outdoor_count_threshold, achievements.is_active 
FROM achievements
2026-01-18 04:33:41 | INFO     | sqlalchemy.engine.Engine | [cached since 229.1s ago] ()
2026-01-18 04:33:41 | INFO     | mybuddy.api | build_dashboard: end child_id=767166ac-39ef-4412-b0f5-72998235b319 unlocked=4 locked=16
2026-01-18 04:33:41 | INFO     | uvicorn.access | 10.3.6.1:0 - "GET /v1/children/767166ac-39ef-4412-b0f5-72998235b319/dashboard HTTP/1.1" 200
2026-01-18 04:33:41 | INFO     | sqlalchemy.engine.Engine | ROLLBACK
2026-01-18 04:34:34 | INFO     | sqlalchemy.engine.Engine | BEGIN (implicit)
2026-01-18 04:34:34 | INFO     | sqlalchemy.engine.Engine | SELECT avatars.id, avatars.name, avatars.image_path, avatars.is_active 
FROM avatars 
WHERE avatars.is_active = true
2026-01-18 04:34:34 | INFO     | sqlalchemy.engine.Engine | [cached since 113.1s ago] ()
2026-01-18 04:34:34 | INFO     | sqlalchemy.engine.Engine | BEGIN (implicit)
2026-01-18 04:34:34 | INFO     | sqlalchemy.engine.Engine | SELECT interests.id, interests.name, interests.label, interests.icon, interests.is_active 
FROM interests 
WHERE interests.is_active = true
2026-01-18 04:34:34 | INFO     | sqlalchemy.engine.Engine | [cached since 113.1s ago] ()
2026-01-18 04:34:34 | INFO     | sqlalchemy.engine.Engine | BEGIN (implicit)
2026-01-18 04:34:34 | INFO     | sqlalchemy.engine.Engine | SELECT children.created_at, children.updated_at, children.id, children.owner_sub, children.name, children.birthday, children.interests, children.avatar_id 
FROM children 
WHERE children.owner_sub = $1::VARCHAR ORDER BY children.created_at DESC
2026-01-18 04:34:34 | INFO     | sqlalchemy.engine.Engine | [cached since 112.9s ago] ('fb84a374-66ee-4698-b7ba-f1334bb61d0f',)
2026-01-18 04:34:34 | INFO     | sqlalchemy.engine.Engine | BEGIN (implicit)
2026-01-18 04:34:34 | INFO     | sqlalchemy.engine.Engine | SELECT children.created_at, children.updated_at, children.id, children.owner_sub, children.name, children.birthday, children.interests, children.avatar_id 
FROM children 
WHERE children.id = $1::UUID AND children.owner_sub = $2::VARCHAR
2026-01-18 04:34:34 | INFO     | sqlalchemy.engine.Engine | [cached since 282.5s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), 'fb84a374-66ee-4698-b7ba-f1334bb61d0f')
2026-01-18 04:34:34 | INFO     | uvicorn.access | 10.3.6.1:0 - "GET /v1/avatars HTTP/1.1" 200
2026-01-18 04:34:34 | INFO     | uvicorn.access | 10.3.6.1:0 - "GET /v1/interests HTTP/1.1" 200
2026-01-18 04:34:34 | INFO     | mybuddy.api | build_dashboard: start child_id=b65a73c4-8de3-404d-b875-90fd93cccb11
2026-01-18 04:34:34 | INFO     | sqlalchemy.engine.Engine | SELECT child_activity_events.kind, count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID GROUP BY child_activity_events.kind
2026-01-18 04:34:34 | INFO     | sqlalchemy.engine.Engine | [cached since 282.3s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'),)
2026-01-18 04:34:34 | INFO     | sqlalchemy.engine.Engine | ROLLBACK
2026-01-18 04:34:34 | INFO     | sqlalchemy.engine.Engine | ROLLBACK
2026-01-18 04:34:34 | INFO     | uvicorn.access | 10.3.6.1:0 - "GET /v1/children HTTP/1.1" 200
2026-01-18 04:34:34 | INFO     | sqlalchemy.engine.Engine | SELECT coalesce(sum(child_activity_events.points), $1::INTEGER) AS coalesce_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $2::UUID
2026-01-18 04:34:34 | INFO     | sqlalchemy.engine.Engine | [cached since 282.3s ago] (0, UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'))
2026-01-18 04:34:34 | INFO     | sqlalchemy.engine.Engine | ROLLBACK
2026-01-18 04:34:34 | INFO     | mybuddy.api | progress_totals: child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 totalPoints=75 counts={'affirmation': 8, 'chore': 1, 'outdoor': 1}
2026-01-18 04:34:34 | INFO     | sqlalchemy.engine.Engine | SELECT child_activity_events.kind, count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.created_at >= $2::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $3::TIMESTAMP WITH TIME ZONE GROUP BY child_activity_events.kind
2026-01-18 04:34:34 | INFO     | sqlalchemy.engine.Engine | [cached since 282.3s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:34:34 | INFO     | sqlalchemy.engine.Engine | SELECT coalesce(sum(child_activity_events.points), $1::INTEGER) AS coalesce_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $2::UUID AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE
2026-01-18 04:34:34 | INFO     | sqlalchemy.engine.Engine | [cached since 282.3s ago] (0, UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:34:34 | INFO     | sqlalchemy.engine.Engine | SELECT count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.kind = $2::VARCHAR AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE AND child_activity_events.correct = true
2026-01-18 04:34:34 | INFO     | sqlalchemy.engine.Engine | [cached since 282.3s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), 'flashcard', datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:34:34 | INFO     | mybuddy.api | progress_today: child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 date=2026-01-17 counts={'affirmation': 8, 'chore': 1, 'outdoor': 1} flash_correct=0 totalPoints=75
2026-01-18 04:34:34 | INFO     | sqlalchemy.engine.Engine | SELECT coalesce(sum(child_activity_events.points), $1::INTEGER) AS coalesce_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $2::UUID AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE
2026-01-18 04:34:34 | INFO     | sqlalchemy.engine.Engine | [cached since 282.3s ago] (0, UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), datetime.datetime(2026, 1, 11, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:34:34 | INFO     | sqlalchemy.engine.Engine | SELECT count(DISTINCT ((child_activity_events.created_at AT TIME ZONE 'America/New_York')::date)) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.created_at >= $2::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $3::TIMESTAMP WITH TIME ZONE
2026-01-18 04:34:34 | INFO     | sqlalchemy.engine.Engine | [cached since 280.5s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), datetime.datetime(2026, 1, 11, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:34:34 | INFO     | sqlalchemy.engine.Engine | SELECT child_activity_events.kind, count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.created_at >= $2::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $3::TIMESTAMP WITH TIME ZONE GROUP BY child_activity_events.kind
2026-01-18 04:34:34 | INFO     | sqlalchemy.engine.Engine | [cached since 282.3s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), datetime.datetime(2026, 1, 11, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:34:34 | INFO     | sqlalchemy.engine.Engine | SELECT count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.kind = $2::VARCHAR AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE AND child_activity_events.correct = true
2026-01-18 04:34:34 | INFO     | sqlalchemy.engine.Engine | [cached since 282.3s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), 'flashcard', datetime.datetime(2026, 1, 11, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:34:34 | INFO     | mybuddy.api | progress_week: child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 weekStart=2026-01-11 counts={'affirmation': 8, 'chore': 1, 'outdoor': 1} flash_correct=0 accuracyPct=0 totalPoints=75 daysActive=1
2026-01-18 04:34:34 | INFO     | sqlalchemy.engine.Engine | SELECT DISTINCT child_activity_events.chore_id 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.kind = $2::VARCHAR AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE AND child_activity_events.chore_id IS NOT NULL
2026-01-18 04:34:34 | INFO     | sqlalchemy.engine.Engine | [cached since 280.5s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), 'chore', datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:34:34 | INFO     | sqlalchemy.engine.Engine | SELECT DISTINCT child_activity_events.outdoor_activity_id 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.kind = $2::VARCHAR AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE AND child_activity_events.outdoor_activity_id IS NOT NULL
2026-01-18 04:34:34 | INFO     | sqlalchemy.engine.Engine | [cached since 280.5s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), 'outdoor', datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:34:34 | INFO     | sqlalchemy.engine.Engine | SELECT children.created_at, children.updated_at, children.id, children.owner_sub, children.name, children.birthday, children.interests, children.avatar_id 
FROM children 
WHERE children.id = $1::UUID
2026-01-18 04:34:34 | INFO     | sqlalchemy.engine.Engine | [cached since 282.4s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'),)
2026-01-18 04:34:34 | INFO     | sqlalchemy.engine.Engine | SELECT age_ranges.id, age_ranges.code, age_ranges.name, age_ranges.min_age, age_ranges.max_age, age_ranges.is_active 
FROM age_ranges 
WHERE age_ranges.min_age <= $1::INTEGER AND (age_ranges.max_age IS NULL OR age_ranges.max_age >= $2::INTEGER) AND age_ranges.is_active = true
2026-01-18 04:34:34 | INFO     | sqlalchemy.engine.Engine | [cached since 282.4s ago] (8, 8)
2026-01-18 04:34:34 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code 
FROM subjects JOIN subject_age_ranges ON subjects.id = subject_age_ranges.subject_id 
WHERE subject_age_ranges.age_range_id = $1::UUID ORDER BY subjects.code
2026-01-18 04:34:34 | INFO     | sqlalchemy.engine.Engine | [cached since 282.4s ago] (UUID('1aea8d41-8a9a-4631-a8d7-b8ef59d74bfc'),)
2026-01-18 04:34:34 | INFO     | sqlalchemy.engine.Engine | SELECT difficulty_thresholds.code, difficulty_thresholds.threshold 
FROM difficulty_thresholds 
WHERE difficulty_thresholds.is_active = true
2026-01-18 04:34:34 | INFO     | sqlalchemy.engine.Engine | [cached since 282.3s ago] ()
2026-01-18 04:34:34 | INFO     | mybuddy.api | difficulty_thresholds: child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 thresholds={'easy': 0, 'medium': 25, 'hard': 50, 'impossible': 100}
2026-01-18 04:34:34 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code AS subject_code, count(child_activity_events.id) AS completed, coalesce(sum(CASE WHEN (child_activity_events.correct = true) THEN $1::INTEGER ELSE $2::INTEGER END), $3::INTEGER) AS correct 
FROM child_activity_events JOIN subjects ON subjects.id = child_activity_events.subject_id 
WHERE child_activity_events.child_id = $4::UUID AND child_activity_events.kind = $5::VARCHAR GROUP BY subjects.code
2026-01-18 04:34:34 | INFO     | sqlalchemy.engine.Engine | [cached since 282.3s ago] (1, 0, 0, UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), 'flashcard')
2026-01-18 04:34:34 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code, child_subject_streaks.current_streak, child_subject_streaks.longest_streak 
FROM child_subject_streaks JOIN subjects ON subjects.id = child_subject_streaks.subject_id 
WHERE child_subject_streaks.child_id = $1::UUID
2026-01-18 04:34:34 | INFO     | sqlalchemy.engine.Engine | [cached since 282.3s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'),)
2026-01-18 04:34:34 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code, child_subject_difficulty.difficulty_code 
FROM child_subject_difficulty JOIN subjects ON subjects.id = child_subject_difficulty.subject_id 
WHERE child_subject_difficulty.child_id = $1::UUID
2026-01-18 04:34:34 | INFO     | sqlalchemy.engine.Engine | [cached since 282.3s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'),)
2026-01-18 04:34:34 | INFO     | mybuddy.api | subject_difficulty_map: child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 diff_map={'math': 'easy', 'science': 'easy', 'reading': 'easy', 'history': 'easy'}
2026-01-18 04:34:34 | INFO     | mybuddy.api | dashboard_flashcards_by_subject: child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 by_subject={'history': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 0, 'longestStreak': 0}, 'math': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 0, 'longestStreak': 0}, 'reading': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 0, 'longestStreak': 0}, 'science': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 0, 'longestStreak': 0}}
2026-01-18 04:34:34 | INFO     | sqlalchemy.engine.Engine | SELECT DISTINCT ((child_activity_events.created_at AT TIME ZONE 'America/New_York')::date) AS d 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.created_at >= $2::TIMESTAMP WITH TIME ZONE ORDER BY d DESC
2026-01-18 04:34:34 | INFO     | sqlalchemy.engine.Engine | [cached since 282.3s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), datetime.datetime(2025, 7, 21, 4, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:34:34 | INFO     | sqlalchemy.engine.Engine | SELECT level_thresholds.id, level_thresholds.name, level_thresholds.threshold, level_thresholds.icon, level_thresholds.color, level_thresholds.is_active 
FROM level_thresholds 
WHERE level_thresholds.is_active = true
2026-01-18 04:34:34 | INFO     | sqlalchemy.engine.Engine | [cached since 282.4s ago] ()
2026-01-18 04:34:34 | INFO     | mybuddy.api | build_dashboard: loaded child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 core_subjects=['history', 'math', 'reading', 'science'] by_subject_keys=['history', 'math', 'reading', 'science'] totalPoints=75
2026-01-18 04:34:34 | INFO     | sqlalchemy.engine.Engine | SELECT child_balanced_progress_counters.id, child_balanced_progress_counters.child_id, child_balanced_progress_counters.subject_code, child_balanced_progress_counters.correct_count, child_balanced_progress_counters.updated_at 
FROM child_balanced_progress_counters 
WHERE child_balanced_progress_counters.child_id = $1::UUID
2026-01-18 04:34:34 | INFO     | sqlalchemy.engine.Engine | [cached since 280.5s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'),)
2026-01-18 04:34:34 | INFO     | sqlalchemy.engine.Engine | SELECT child_progress.child_id, child_progress.total_points, child_progress.total_flashcards, child_progress.total_chores, child_progress.total_outdoor, child_progress.total_affirmations, child_progress.current_streak, child_progress.longest_streak, child_progress.last_active_date, child_progress.last_seen_at, child_progress.current_level, child_progress.subject_counts 
FROM child_progress 
WHERE child_progress.child_id = $1::UUID
2026-01-18 04:34:34 | INFO     | sqlalchemy.engine.Engine | [cached since 282.4s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'),)
2026-01-18 04:34:34 | INFO     | sqlalchemy.engine.Engine | SELECT achievements.code, child_achievements.unlocked_at 
FROM achievements JOIN child_achievements ON child_achievements.achievement_id = achievements.id 
WHERE child_achievements.child_id = $1::UUID
2026-01-18 04:34:34 | INFO     | sqlalchemy.engine.Engine | [cached since 280.5s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'),)
2026-01-18 04:34:34 | INFO     | sqlalchemy.engine.Engine | SELECT achievements.created_at, achievements.updated_at, achievements.id, achievements.code, achievements.title, achievements.description, achievements.icon, achievements.achievement_type, achievements.points_threshold, achievements.streak_days_threshold, achievements.flashcards_count_threshold, achievements.chores_count_threshold, achievements.outdoor_count_threshold, achievements.is_active 
FROM achievements
2026-01-18 04:34:34 | INFO     | sqlalchemy.engine.Engine | [cached since 282.3s ago] ()
2026-01-18 04:34:34 | INFO     | mybuddy.api | build_dashboard: end child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 unlocked=2 locked=18
2026-01-18 04:34:34 | INFO     | uvicorn.access | 10.3.6.1:0 - "GET /v1/children/b65a73c4-8de3-404d-b875-90fd93cccb11/dashboard HTTP/1.1" 200
2026-01-18 04:34:34 | INFO     | sqlalchemy.engine.Engine | ROLLBACK
2026-01-18 04:34:36 | INFO     | sqlalchemy.engine.Engine | BEGIN (implicit)
2026-01-18 04:34:36 | INFO     | sqlalchemy.engine.Engine | SELECT children.created_at, children.updated_at, children.id, children.owner_sub, children.name, children.birthday, children.interests, children.avatar_id 
FROM children 
WHERE children.id = $1::UUID AND children.owner_sub = $2::VARCHAR
2026-01-18 04:34:36 | INFO     | sqlalchemy.engine.Engine | [cached since 284.1s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), 'fb84a374-66ee-4698-b7ba-f1334bb61d0f')
2026-01-18 04:34:36 | INFO     | sqlalchemy.engine.Engine | SELECT age_ranges.id, age_ranges.code, age_ranges.name, age_ranges.min_age, age_ranges.max_age, age_ranges.is_active 
FROM age_ranges 
WHERE age_ranges.min_age <= $1::INTEGER AND (age_ranges.max_age IS NULL OR age_ranges.max_age >= $2::INTEGER) AND age_ranges.is_active = true
2026-01-18 04:34:36 | INFO     | sqlalchemy.engine.Engine | [cached since 283.9s ago] (8, 8)
2026-01-18 04:34:36 | INFO     | mybuddy.api | list_affirmations: child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 age_range_id=1aea8d41-8a9a-4631-a8d7-b8ef59d74bfc interests=['cef77ae5-6e4d-487e-8569-1cca10556c82']
2026-01-18 04:34:36 | INFO     | sqlalchemy.engine.Engine | SELECT affirmations.id, affirmations.text, affirmations.image, affirmations.gradient_0, affirmations.gradient_1, affirmations.tags, affirmations.age_range_id 
FROM affirmations 
WHERE affirmations.age_range_id = $1::UUID ORDER BY CASE WHEN (coalesce(affirmations.tags, '[]'::jsonb) ? $2::VARCHAR) THEN $3::INTEGER WHEN $4::BOOLEAN THEN $5::INTEGER END, random()
2026-01-18 04:34:36 | INFO     | sqlalchemy.engine.Engine | [cached since 112.7s ago] (UUID('1aea8d41-8a9a-4631-a8d7-b8ef59d74bfc'), 'cef77ae5-6e4d-487e-8569-1cca10556c82', 0, True, 1)
2026-01-18 04:34:36 | INFO     | uvicorn.access | 10.3.6.1:0 - "GET /v1/affirmations?childId=b65a73c4-8de3-404d-b875-90fd93cccb11 HTTP/1.1" 200
2026-01-18 04:34:36 | INFO     | sqlalchemy.engine.Engine | ROLLBACK
2026-01-18 04:34:36 | INFO     | sqlalchemy.engine.Engine | BEGIN (implicit)
2026-01-18 04:34:36 | INFO     | sqlalchemy.engine.Engine | SELECT children.created_at, children.updated_at, children.id, children.owner_sub, children.name, children.birthday, children.interests, children.avatar_id 
FROM children 
WHERE children.id = $1::UUID AND children.owner_sub = $2::VARCHAR
2026-01-18 04:34:36 | INFO     | sqlalchemy.engine.Engine | [cached since 284.4s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), 'fb84a374-66ee-4698-b7ba-f1334bb61d0f')
2026-01-18 04:34:36 | INFO     | mybuddy.api | event_affirmation: start child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 affirmationId=7fbb3fee-cdac-4d98-93a1-24ce868e2520
2026-01-18 04:34:36 | INFO     | sqlalchemy.engine.Engine | SELECT points_values.id, points_values.code, points_values.name, points_values.points, points_values.is_active 
FROM points_values 
WHERE points_values.is_active = true
2026-01-18 04:34:36 | INFO     | sqlalchemy.engine.Engine | [cached since 284.4s ago] ()
2026-01-18 04:34:36 | INFO     | sqlalchemy.engine.Engine | SAVEPOINT sa_savepoint_1
2026-01-18 04:34:36 | INFO     | sqlalchemy.engine.Engine | [no key 0.00056s] ()
2026-01-18 04:34:36 | INFO     | sqlalchemy.engine.Engine | INSERT INTO child_activity_events (child_id, kind, subject_id, flashcard_id, chore_id, outdoor_activity_id, affirmation_id, points, correct, answer, meta) VALUES ($1::UUID, $2::VARCHAR, $3::UUID, $4::UUID, $5::UUID, $6::UUID, $7::UUID, $8::INTEGER, $9::BOOLEAN, $10::VARCHAR, $11::JSONB) RETURNING child_activity_events.id, child_activity_events.created_at
2026-01-18 04:34:36 | INFO     | sqlalchemy.engine.Engine | [cached since 284.4s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), 'affirmation', None, None, None, None, UUID('7fbb3fee-cdac-4d98-93a1-24ce868e2520'), 5, None, None, '{"dedupeKey": "affirmation:7fbb3fee-cdac-4d98-93a1-24ce868e2520", "affirmationId": "7fbb3fee-cdac-4d98-93a1-24ce868e2520", "points": 5}')
2026-01-18 04:34:36 | INFO     | sqlalchemy.engine.Engine | ROLLBACK TO SAVEPOINT sa_savepoint_1
2026-01-18 04:34:36 | INFO     | sqlalchemy.engine.Engine | [no key 0.00051s] ()
2026-01-18 04:34:36 | INFO     | mybuddy.api | event_affirmation: deduped child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 affirmationId=7fbb3fee-cdac-4d98-93a1-24ce868e2520
2026-01-18 04:34:36 | INFO     | uvicorn.access | 10.3.6.1:0 - "POST /v1/children/b65a73c4-8de3-404d-b875-90fd93cccb11/events/affirmation HTTP/1.1" 200
2026-01-18 04:34:36 | INFO     | sqlalchemy.engine.Engine | ROLLBACK
2026-01-18 04:34:37 | INFO     | sqlalchemy.engine.Engine | BEGIN (implicit)
2026-01-18 04:34:37 | INFO     | sqlalchemy.engine.Engine | SELECT children.created_at, children.updated_at, children.id, children.owner_sub, children.name, children.birthday, children.interests, children.avatar_id 
FROM children 
WHERE children.id = $1::UUID AND children.owner_sub = $2::VARCHAR
2026-01-18 04:34:37 | INFO     | sqlalchemy.engine.Engine | [cached since 286s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), 'fb84a374-66ee-4698-b7ba-f1334bb61d0f')
2026-01-18 04:34:37 | INFO     | mybuddy.api | build_dashboard: start child_id=b65a73c4-8de3-404d-b875-90fd93cccb11
2026-01-18 04:34:37 | INFO     | sqlalchemy.engine.Engine | SELECT child_activity_events.kind, count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID GROUP BY child_activity_events.kind
2026-01-18 04:34:37 | INFO     | sqlalchemy.engine.Engine | [cached since 285.8s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'),)
2026-01-18 04:34:37 | INFO     | sqlalchemy.engine.Engine | SELECT coalesce(sum(child_activity_events.points), $1::INTEGER) AS coalesce_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $2::UUID
2026-01-18 04:34:37 | INFO     | sqlalchemy.engine.Engine | [cached since 285.8s ago] (0, UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'))
2026-01-18 04:34:37 | INFO     | mybuddy.api | progress_totals: child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 totalPoints=75 counts={'affirmation': 8, 'chore': 1, 'outdoor': 1}
2026-01-18 04:34:37 | INFO     | sqlalchemy.engine.Engine | SELECT child_activity_events.kind, count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.created_at >= $2::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $3::TIMESTAMP WITH TIME ZONE GROUP BY child_activity_events.kind
2026-01-18 04:34:37 | INFO     | sqlalchemy.engine.Engine | [cached since 285.8s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:34:37 | INFO     | sqlalchemy.engine.Engine | SELECT coalesce(sum(child_activity_events.points), $1::INTEGER) AS coalesce_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $2::UUID AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE
2026-01-18 04:34:37 | INFO     | sqlalchemy.engine.Engine | [cached since 285.8s ago] (0, UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:34:37 | INFO     | sqlalchemy.engine.Engine | SELECT count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.kind = $2::VARCHAR AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE AND child_activity_events.correct = true
2026-01-18 04:34:37 | INFO     | sqlalchemy.engine.Engine | [cached since 285.8s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), 'flashcard', datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:34:37 | INFO     | mybuddy.api | progress_today: child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 date=2026-01-17 counts={'affirmation': 8, 'chore': 1, 'outdoor': 1} flash_correct=0 totalPoints=75
2026-01-18 04:34:37 | INFO     | sqlalchemy.engine.Engine | SELECT coalesce(sum(child_activity_events.points), $1::INTEGER) AS coalesce_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $2::UUID AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE
2026-01-18 04:34:37 | INFO     | sqlalchemy.engine.Engine | [cached since 285.8s ago] (0, UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), datetime.datetime(2026, 1, 11, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:34:37 | INFO     | sqlalchemy.engine.Engine | SELECT count(DISTINCT ((child_activity_events.created_at AT TIME ZONE 'America/New_York')::date)) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.created_at >= $2::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $3::TIMESTAMP WITH TIME ZONE
2026-01-18 04:34:37 | INFO     | sqlalchemy.engine.Engine | [cached since 284s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), datetime.datetime(2026, 1, 11, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:34:37 | INFO     | sqlalchemy.engine.Engine | SELECT child_activity_events.kind, count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.created_at >= $2::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $3::TIMESTAMP WITH TIME ZONE GROUP BY child_activity_events.kind
2026-01-18 04:34:37 | INFO     | sqlalchemy.engine.Engine | [cached since 285.8s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), datetime.datetime(2026, 1, 11, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:34:37 | INFO     | sqlalchemy.engine.Engine | SELECT count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.kind = $2::VARCHAR AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE AND child_activity_events.correct = true
2026-01-18 04:34:37 | INFO     | sqlalchemy.engine.Engine | [cached since 285.8s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), 'flashcard', datetime.datetime(2026, 1, 11, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:34:37 | INFO     | mybuddy.api | progress_week: child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 weekStart=2026-01-11 counts={'affirmation': 8, 'chore': 1, 'outdoor': 1} flash_correct=0 accuracyPct=0 totalPoints=75 daysActive=1
2026-01-18 04:34:37 | INFO     | sqlalchemy.engine.Engine | SELECT DISTINCT child_activity_events.chore_id 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.kind = $2::VARCHAR AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE AND child_activity_events.chore_id IS NOT NULL
2026-01-18 04:34:37 | INFO     | sqlalchemy.engine.Engine | [cached since 284s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), 'chore', datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:34:37 | INFO     | sqlalchemy.engine.Engine | SELECT DISTINCT child_activity_events.outdoor_activity_id 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.kind = $2::VARCHAR AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE AND child_activity_events.outdoor_activity_id IS NOT NULL
2026-01-18 04:34:37 | INFO     | sqlalchemy.engine.Engine | [cached since 284s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), 'outdoor', datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:34:37 | INFO     | sqlalchemy.engine.Engine | SELECT children.created_at, children.updated_at, children.id, children.owner_sub, children.name, children.birthday, children.interests, children.avatar_id 
FROM children 
WHERE children.id = $1::UUID
2026-01-18 04:34:37 | INFO     | sqlalchemy.engine.Engine | [cached since 285.9s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'),)
2026-01-18 04:34:37 | INFO     | sqlalchemy.engine.Engine | SELECT age_ranges.id, age_ranges.code, age_ranges.name, age_ranges.min_age, age_ranges.max_age, age_ranges.is_active 
FROM age_ranges 
WHERE age_ranges.min_age <= $1::INTEGER AND (age_ranges.max_age IS NULL OR age_ranges.max_age >= $2::INTEGER) AND age_ranges.is_active = true
2026-01-18 04:34:37 | INFO     | sqlalchemy.engine.Engine | [cached since 285.9s ago] (8, 8)
2026-01-18 04:34:37 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code 
FROM subjects JOIN subject_age_ranges ON subjects.id = subject_age_ranges.subject_id 
WHERE subject_age_ranges.age_range_id = $1::UUID ORDER BY subjects.code
2026-01-18 04:34:37 | INFO     | sqlalchemy.engine.Engine | [cached since 285.9s ago] (UUID('1aea8d41-8a9a-4631-a8d7-b8ef59d74bfc'),)
2026-01-18 04:34:37 | INFO     | sqlalchemy.engine.Engine | SELECT difficulty_thresholds.code, difficulty_thresholds.threshold 
FROM difficulty_thresholds 
WHERE difficulty_thresholds.is_active = true
2026-01-18 04:34:37 | INFO     | sqlalchemy.engine.Engine | [cached since 285.8s ago] ()
2026-01-18 04:34:37 | INFO     | mybuddy.api | difficulty_thresholds: child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 thresholds={'easy': 0, 'medium': 25, 'hard': 50, 'impossible': 100}
2026-01-18 04:34:37 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code AS subject_code, count(child_activity_events.id) AS completed, coalesce(sum(CASE WHEN (child_activity_events.correct = true) THEN $1::INTEGER ELSE $2::INTEGER END), $3::INTEGER) AS correct 
FROM child_activity_events JOIN subjects ON subjects.id = child_activity_events.subject_id 
WHERE child_activity_events.child_id = $4::UUID AND child_activity_events.kind = $5::VARCHAR GROUP BY subjects.code
2026-01-18 04:34:37 | INFO     | sqlalchemy.engine.Engine | [cached since 285.8s ago] (1, 0, 0, UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), 'flashcard')
2026-01-18 04:34:37 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code, child_subject_streaks.current_streak, child_subject_streaks.longest_streak 
FROM child_subject_streaks JOIN subjects ON subjects.id = child_subject_streaks.subject_id 
WHERE child_subject_streaks.child_id = $1::UUID
2026-01-18 04:34:37 | INFO     | sqlalchemy.engine.Engine | [cached since 285.8s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'),)
2026-01-18 04:34:37 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code, child_subject_difficulty.difficulty_code 
FROM child_subject_difficulty JOIN subjects ON subjects.id = child_subject_difficulty.subject_id 
WHERE child_subject_difficulty.child_id = $1::UUID
2026-01-18 04:34:37 | INFO     | sqlalchemy.engine.Engine | [cached since 285.8s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'),)
2026-01-18 04:34:37 | INFO     | mybuddy.api | subject_difficulty_map: child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 diff_map={'math': 'easy', 'science': 'easy', 'reading': 'easy', 'history': 'easy'}
2026-01-18 04:34:37 | INFO     | mybuddy.api | dashboard_flashcards_by_subject: child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 by_subject={'history': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 0, 'longestStreak': 0}, 'math': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 0, 'longestStreak': 0}, 'reading': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 0, 'longestStreak': 0}, 'science': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 0, 'longestStreak': 0}}
2026-01-18 04:34:37 | INFO     | sqlalchemy.engine.Engine | SELECT DISTINCT ((child_activity_events.created_at AT TIME ZONE 'America/New_York')::date) AS d 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.created_at >= $2::TIMESTAMP WITH TIME ZONE ORDER BY d DESC
2026-01-18 04:34:37 | INFO     | sqlalchemy.engine.Engine | [cached since 285.8s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), datetime.datetime(2025, 7, 21, 4, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:34:37 | INFO     | sqlalchemy.engine.Engine | SELECT level_thresholds.id, level_thresholds.name, level_thresholds.threshold, level_thresholds.icon, level_thresholds.color, level_thresholds.is_active 
FROM level_thresholds 
WHERE level_thresholds.is_active = true
2026-01-18 04:34:37 | INFO     | sqlalchemy.engine.Engine | [cached since 285.9s ago] ()
2026-01-18 04:34:37 | INFO     | mybuddy.api | build_dashboard: loaded child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 core_subjects=['history', 'math', 'reading', 'science'] by_subject_keys=['history', 'math', 'reading', 'science'] totalPoints=75
2026-01-18 04:34:37 | INFO     | sqlalchemy.engine.Engine | SELECT child_balanced_progress_counters.id, child_balanced_progress_counters.child_id, child_balanced_progress_counters.subject_code, child_balanced_progress_counters.correct_count, child_balanced_progress_counters.updated_at 
FROM child_balanced_progress_counters 
WHERE child_balanced_progress_counters.child_id = $1::UUID
2026-01-18 04:34:37 | INFO     | sqlalchemy.engine.Engine | [cached since 284s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'),)
2026-01-18 04:34:37 | INFO     | sqlalchemy.engine.Engine | SELECT child_progress.child_id, child_progress.total_points, child_progress.total_flashcards, child_progress.total_chores, child_progress.total_outdoor, child_progress.total_affirmations, child_progress.current_streak, child_progress.longest_streak, child_progress.last_active_date, child_progress.last_seen_at, child_progress.current_level, child_progress.subject_counts 
FROM child_progress 
WHERE child_progress.child_id = $1::UUID
2026-01-18 04:34:37 | INFO     | sqlalchemy.engine.Engine | [cached since 285.9s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'),)
2026-01-18 04:34:37 | INFO     | sqlalchemy.engine.Engine | SELECT achievements.code, child_achievements.unlocked_at 
FROM achievements JOIN child_achievements ON child_achievements.achievement_id = achievements.id 
WHERE child_achievements.child_id = $1::UUID
2026-01-18 04:34:37 | INFO     | sqlalchemy.engine.Engine | [cached since 284s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'),)
2026-01-18 04:34:38 | INFO     | sqlalchemy.engine.Engine | SELECT achievements.created_at, achievements.updated_at, achievements.id, achievements.code, achievements.title, achievements.description, achievements.icon, achievements.achievement_type, achievements.points_threshold, achievements.streak_days_threshold, achievements.flashcards_count_threshold, achievements.chores_count_threshold, achievements.outdoor_count_threshold, achievements.is_active 
FROM achievements
2026-01-18 04:34:38 | INFO     | sqlalchemy.engine.Engine | [cached since 285.8s ago] ()
2026-01-18 04:34:38 | INFO     | mybuddy.api | build_dashboard: end child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 unlocked=2 locked=18
2026-01-18 04:34:38 | INFO     | uvicorn.access | 10.3.6.1:0 - "GET /v1/children/b65a73c4-8de3-404d-b875-90fd93cccb11/dashboard HTTP/1.1" 200
2026-01-18 04:34:38 | INFO     | sqlalchemy.engine.Engine | ROLLBACK
2026-01-18 04:34:40 | INFO     | uvicorn.access | 10.3.6.1:0 - "OPTIONS /v1/avatars HTTP/1.1" 200
2026-01-18 04:34:40 | INFO     | sqlalchemy.engine.Engine | BEGIN (implicit)
2026-01-18 04:34:40 | INFO     | sqlalchemy.engine.Engine | SELECT difficulty_thresholds.id, difficulty_thresholds.code, difficulty_thresholds.name, difficulty_thresholds.label, difficulty_thresholds.icon, difficulty_thresholds.color, difficulty_thresholds.threshold, difficulty_thresholds.is_active 
FROM difficulty_thresholds 
WHERE difficulty_thresholds.is_active = true
2026-01-18 04:34:40 | INFO     | sqlalchemy.engine.Engine | [cached since 113s ago] ()
2026-01-18 04:34:40 | INFO     | sqlalchemy.engine.Engine | BEGIN (implicit)
2026-01-18 04:34:40 | INFO     | sqlalchemy.engine.Engine | SELECT children.created_at, children.updated_at, children.id, children.owner_sub, children.name, children.birthday, children.interests, children.avatar_id 
FROM children 
WHERE children.id = $1::UUID AND children.owner_sub = $2::VARCHAR
2026-01-18 04:34:40 | INFO     | sqlalchemy.engine.Engine | [cached since 288.2s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), 'fb84a374-66ee-4698-b7ba-f1334bb61d0f')
2026-01-18 04:34:40 | INFO     | sqlalchemy.engine.Engine | BEGIN (implicit)
2026-01-18 04:34:40 | INFO     | sqlalchemy.engine.Engine | SELECT children.created_at, children.updated_at, children.id, children.owner_sub, children.name, children.birthday, children.interests, children.avatar_id 
FROM children 
WHERE children.id = $1::UUID AND children.owner_sub = $2::VARCHAR
2026-01-18 04:34:40 | INFO     | sqlalchemy.engine.Engine | [cached since 288.2s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), 'fb84a374-66ee-4698-b7ba-f1334bb61d0f')
2026-01-18 04:34:40 | INFO     | sqlalchemy.engine.Engine | BEGIN (implicit)
2026-01-18 04:34:40 | INFO     | sqlalchemy.engine.Engine | SELECT children.created_at, children.updated_at, children.id, children.owner_sub, children.name, children.birthday, children.interests, children.avatar_id 
FROM children 
WHERE children.id = $1::UUID AND children.owner_sub = $2::VARCHAR
2026-01-18 04:34:40 | INFO     | sqlalchemy.engine.Engine | [cached since 288.2s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), 'fb84a374-66ee-4698-b7ba-f1334bb61d0f')
2026-01-18 04:34:40 | INFO     | mybuddy.api | list_subjects: child_id=b65a73c4-8de3-404d-b875-90fd93cccb11
2026-01-18 04:34:40 | INFO     | sqlalchemy.engine.Engine | SELECT age_ranges.id, age_ranges.code, age_ranges.name, age_ranges.min_age, age_ranges.max_age, age_ranges.is_active 
FROM age_ranges 
WHERE age_ranges.min_age <= $1::INTEGER AND (age_ranges.max_age IS NULL OR age_ranges.max_age >= $2::INTEGER) AND age_ranges.is_active = true
2026-01-18 04:34:40 | INFO     | sqlalchemy.engine.Engine | [cached since 288s ago] (8, 8)
2026-01-18 04:34:40 | INFO     | uvicorn.access | 10.3.6.1:0 - "GET /v1/difficulties HTTP/1.1" 200
2026-01-18 04:34:40 | INFO     | mybuddy.api | build_dashboard: start child_id=b65a73c4-8de3-404d-b875-90fd93cccb11
2026-01-18 04:34:40 | INFO     | sqlalchemy.engine.Engine | SELECT child_activity_events.kind, count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID GROUP BY child_activity_events.kind
2026-01-18 04:34:40 | INFO     | sqlalchemy.engine.Engine | [cached since 288s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'),)
2026-01-18 04:34:40 | INFO     | uvicorn.access | 10.3.6.1:0 - "GET /v1/children/b65a73c4-8de3-404d-b875-90fd93cccb11 HTTP/1.1" 200
2026-01-18 04:34:40 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.id, subjects.code, subjects.name, subjects.icon, subjects.color 
FROM subjects JOIN subject_age_ranges ON subjects.id = subject_age_ranges.subject_id 
WHERE subject_age_ranges.age_range_id = $1::UUID ORDER BY subjects.name ASC
2026-01-18 04:34:40 | INFO     | sqlalchemy.engine.Engine | [cached since 112.9s ago] (UUID('1aea8d41-8a9a-4631-a8d7-b8ef59d74bfc'),)
2026-01-18 04:34:40 | INFO     | sqlalchemy.engine.Engine | SELECT coalesce(sum(child_activity_events.points), $1::INTEGER) AS coalesce_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $2::UUID
2026-01-18 04:34:40 | INFO     | sqlalchemy.engine.Engine | [cached since 288s ago] (0, UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'))
2026-01-18 04:34:40 | INFO     | sqlalchemy.engine.Engine | ROLLBACK
2026-01-18 04:34:40 | INFO     | mybuddy.api | list_subjects: returned count=4 child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 age_range_id=1aea8d41-8a9a-4631-a8d7-b8ef59d74bfc
2026-01-18 04:34:40 | INFO     | sqlalchemy.engine.Engine | ROLLBACK
2026-01-18 04:34:40 | INFO     | mybuddy.api | progress_totals: child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 totalPoints=75 counts={'affirmation': 8, 'chore': 1, 'outdoor': 1}
2026-01-18 04:34:40 | INFO     | sqlalchemy.engine.Engine | SELECT child_activity_events.kind, count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.created_at >= $2::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $3::TIMESTAMP WITH TIME ZONE GROUP BY child_activity_events.kind
2026-01-18 04:34:40 | INFO     | sqlalchemy.engine.Engine | [cached since 288s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:34:40 | INFO     | uvicorn.access | 10.3.6.1:0 - "GET /v1/subjects?childId=b65a73c4-8de3-404d-b875-90fd93cccb11 HTTP/1.1" 200
2026-01-18 04:34:40 | INFO     | sqlalchemy.engine.Engine | SELECT coalesce(sum(child_activity_events.points), $1::INTEGER) AS coalesce_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $2::UUID AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE
2026-01-18 04:34:40 | INFO     | sqlalchemy.engine.Engine | [cached since 288s ago] (0, UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:34:40 | INFO     | sqlalchemy.engine.Engine | ROLLBACK
2026-01-18 04:34:40 | INFO     | sqlalchemy.engine.Engine | SELECT count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.kind = $2::VARCHAR AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE AND child_activity_events.correct = true
2026-01-18 04:34:40 | INFO     | sqlalchemy.engine.Engine | [cached since 288s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), 'flashcard', datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:34:40 | INFO     | mybuddy.api | progress_today: child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 date=2026-01-17 counts={'affirmation': 8, 'chore': 1, 'outdoor': 1} flash_correct=0 totalPoints=75
2026-01-18 04:34:40 | INFO     | sqlalchemy.engine.Engine | SELECT coalesce(sum(child_activity_events.points), $1::INTEGER) AS coalesce_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $2::UUID AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE
2026-01-18 04:34:40 | INFO     | sqlalchemy.engine.Engine | [cached since 288s ago] (0, UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), datetime.datetime(2026, 1, 11, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:34:40 | INFO     | sqlalchemy.engine.Engine | SELECT count(DISTINCT ((child_activity_events.created_at AT TIME ZONE 'America/New_York')::date)) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.created_at >= $2::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $3::TIMESTAMP WITH TIME ZONE
2026-01-18 04:34:40 | INFO     | sqlalchemy.engine.Engine | [cached since 286.3s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), datetime.datetime(2026, 1, 11, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:34:40 | INFO     | sqlalchemy.engine.Engine | BEGIN (implicit)
2026-01-18 04:34:40 | INFO     | sqlalchemy.engine.Engine | SELECT avatars.id, avatars.name, avatars.image_path, avatars.is_active 
FROM avatars 
WHERE avatars.is_active = true
2026-01-18 04:34:40 | INFO     | sqlalchemy.engine.Engine | [cached since 118.9s ago] ()
2026-01-18 04:34:40 | INFO     | sqlalchemy.engine.Engine | SELECT child_activity_events.kind, count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.created_at >= $2::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $3::TIMESTAMP WITH TIME ZONE GROUP BY child_activity_events.kind
2026-01-18 04:34:40 | INFO     | sqlalchemy.engine.Engine | [cached since 288s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), datetime.datetime(2026, 1, 11, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:34:40 | INFO     | sqlalchemy.engine.Engine | SELECT count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.kind = $2::VARCHAR AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE AND child_activity_events.correct = true
2026-01-18 04:34:40 | INFO     | sqlalchemy.engine.Engine | [cached since 288s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), 'flashcard', datetime.datetime(2026, 1, 11, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:34:40 | INFO     | uvicorn.access | 10.3.6.1:0 - "GET /v1/avatars HTTP/1.1" 200
2026-01-18 04:34:40 | INFO     | sqlalchemy.engine.Engine | ROLLBACK
2026-01-18 04:34:40 | INFO     | mybuddy.api | progress_week: child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 weekStart=2026-01-11 counts={'affirmation': 8, 'chore': 1, 'outdoor': 1} flash_correct=0 accuracyPct=0 totalPoints=75 daysActive=1
2026-01-18 04:34:40 | INFO     | sqlalchemy.engine.Engine | SELECT DISTINCT child_activity_events.chore_id 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.kind = $2::VARCHAR AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE AND child_activity_events.chore_id IS NOT NULL
2026-01-18 04:34:40 | INFO     | sqlalchemy.engine.Engine | [cached since 286.3s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), 'chore', datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:34:40 | INFO     | sqlalchemy.engine.Engine | SELECT DISTINCT child_activity_events.outdoor_activity_id 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.kind = $2::VARCHAR AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE AND child_activity_events.outdoor_activity_id IS NOT NULL
2026-01-18 04:34:40 | INFO     | sqlalchemy.engine.Engine | [cached since 286.3s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), 'outdoor', datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:34:40 | INFO     | sqlalchemy.engine.Engine | SELECT children.created_at, children.updated_at, children.id, children.owner_sub, children.name, children.birthday, children.interests, children.avatar_id 
FROM children 
WHERE children.id = $1::UUID
2026-01-18 04:34:40 | INFO     | sqlalchemy.engine.Engine | [cached since 288.1s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'),)
2026-01-18 04:34:40 | INFO     | sqlalchemy.engine.Engine | SELECT age_ranges.id, age_ranges.code, age_ranges.name, age_ranges.min_age, age_ranges.max_age, age_ranges.is_active 
FROM age_ranges 
WHERE age_ranges.min_age <= $1::INTEGER AND (age_ranges.max_age IS NULL OR age_ranges.max_age >= $2::INTEGER) AND age_ranges.is_active = true
2026-01-18 04:34:40 | INFO     | sqlalchemy.engine.Engine | [cached since 288.1s ago] (8, 8)
2026-01-18 04:34:40 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code 
FROM subjects JOIN subject_age_ranges ON subjects.id = subject_age_ranges.subject_id 
WHERE subject_age_ranges.age_range_id = $1::UUID ORDER BY subjects.code
2026-01-18 04:34:40 | INFO     | sqlalchemy.engine.Engine | [cached since 288.1s ago] (UUID('1aea8d41-8a9a-4631-a8d7-b8ef59d74bfc'),)
2026-01-18 04:34:40 | INFO     | sqlalchemy.engine.Engine | SELECT difficulty_thresholds.code, difficulty_thresholds.threshold 
FROM difficulty_thresholds 
WHERE difficulty_thresholds.is_active = true
2026-01-18 04:34:40 | INFO     | sqlalchemy.engine.Engine | [cached since 288s ago] ()
2026-01-18 04:34:40 | INFO     | mybuddy.api | difficulty_thresholds: child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 thresholds={'easy': 0, 'medium': 25, 'hard': 50, 'impossible': 100}
2026-01-18 04:34:40 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code AS subject_code, count(child_activity_events.id) AS completed, coalesce(sum(CASE WHEN (child_activity_events.correct = true) THEN $1::INTEGER ELSE $2::INTEGER END), $3::INTEGER) AS correct 
FROM child_activity_events JOIN subjects ON subjects.id = child_activity_events.subject_id 
WHERE child_activity_events.child_id = $4::UUID AND child_activity_events.kind = $5::VARCHAR GROUP BY subjects.code
2026-01-18 04:34:40 | INFO     | sqlalchemy.engine.Engine | [cached since 288s ago] (1, 0, 0, UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), 'flashcard')
2026-01-18 04:34:40 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code, child_subject_streaks.current_streak, child_subject_streaks.longest_streak 
FROM child_subject_streaks JOIN subjects ON subjects.id = child_subject_streaks.subject_id 
WHERE child_subject_streaks.child_id = $1::UUID
2026-01-18 04:34:40 | INFO     | sqlalchemy.engine.Engine | [cached since 288s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'),)
2026-01-18 04:34:40 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code, child_subject_difficulty.difficulty_code 
FROM child_subject_difficulty JOIN subjects ON subjects.id = child_subject_difficulty.subject_id 
WHERE child_subject_difficulty.child_id = $1::UUID
2026-01-18 04:34:40 | INFO     | sqlalchemy.engine.Engine | [cached since 288s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'),)
2026-01-18 04:34:40 | INFO     | mybuddy.api | subject_difficulty_map: child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 diff_map={'math': 'easy', 'science': 'easy', 'reading': 'easy', 'history': 'easy'}
2026-01-18 04:34:40 | INFO     | mybuddy.api | dashboard_flashcards_by_subject: child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 by_subject={'history': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 0, 'longestStreak': 0}, 'math': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 0, 'longestStreak': 0}, 'reading': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 0, 'longestStreak': 0}, 'science': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 0, 'longestStreak': 0}}
2026-01-18 04:34:40 | INFO     | sqlalchemy.engine.Engine | SELECT DISTINCT ((child_activity_events.created_at AT TIME ZONE 'America/New_York')::date) AS d 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.created_at >= $2::TIMESTAMP WITH TIME ZONE ORDER BY d DESC
2026-01-18 04:34:40 | INFO     | sqlalchemy.engine.Engine | [cached since 288s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), datetime.datetime(2025, 7, 21, 4, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:34:40 | INFO     | sqlalchemy.engine.Engine | SELECT level_thresholds.id, level_thresholds.name, level_thresholds.threshold, level_thresholds.icon, level_thresholds.color, level_thresholds.is_active 
FROM level_thresholds 
WHERE level_thresholds.is_active = true
2026-01-18 04:34:40 | INFO     | sqlalchemy.engine.Engine | [cached since 288.1s ago] ()
2026-01-18 04:34:40 | INFO     | mybuddy.api | build_dashboard: loaded child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 core_subjects=['history', 'math', 'reading', 'science'] by_subject_keys=['history', 'math', 'reading', 'science'] totalPoints=75
2026-01-18 04:34:40 | INFO     | sqlalchemy.engine.Engine | SELECT child_balanced_progress_counters.id, child_balanced_progress_counters.child_id, child_balanced_progress_counters.subject_code, child_balanced_progress_counters.correct_count, child_balanced_progress_counters.updated_at 
FROM child_balanced_progress_counters 
WHERE child_balanced_progress_counters.child_id = $1::UUID
2026-01-18 04:34:40 | INFO     | sqlalchemy.engine.Engine | [cached since 286.3s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'),)
2026-01-18 04:34:40 | INFO     | sqlalchemy.engine.Engine | SELECT child_progress.child_id, child_progress.total_points, child_progress.total_flashcards, child_progress.total_chores, child_progress.total_outdoor, child_progress.total_affirmations, child_progress.current_streak, child_progress.longest_streak, child_progress.last_active_date, child_progress.last_seen_at, child_progress.current_level, child_progress.subject_counts 
FROM child_progress 
WHERE child_progress.child_id = $1::UUID
2026-01-18 04:34:40 | INFO     | sqlalchemy.engine.Engine | [cached since 288.1s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'),)
2026-01-18 04:34:40 | INFO     | sqlalchemy.engine.Engine | SELECT achievements.code, child_achievements.unlocked_at 
FROM achievements JOIN child_achievements ON child_achievements.achievement_id = achievements.id 
WHERE child_achievements.child_id = $1::UUID
2026-01-18 04:34:40 | INFO     | sqlalchemy.engine.Engine | [cached since 286.3s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'),)
2026-01-18 04:34:40 | INFO     | sqlalchemy.engine.Engine | SELECT achievements.created_at, achievements.updated_at, achievements.id, achievements.code, achievements.title, achievements.description, achievements.icon, achievements.achievement_type, achievements.points_threshold, achievements.streak_days_threshold, achievements.flashcards_count_threshold, achievements.chores_count_threshold, achievements.outdoor_count_threshold, achievements.is_active 
FROM achievements
2026-01-18 04:34:40 | INFO     | sqlalchemy.engine.Engine | [cached since 288s ago] ()
2026-01-18 04:34:40 | INFO     | mybuddy.api | build_dashboard: end child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 unlocked=2 locked=18
2026-01-18 04:34:40 | INFO     | uvicorn.access | 10.3.6.1:0 - "GET /v1/children/b65a73c4-8de3-404d-b875-90fd93cccb11/dashboard HTTP/1.1" 200
2026-01-18 04:34:40 | INFO     | sqlalchemy.engine.Engine | ROLLBACK
2026-01-18 04:40:07 | INFO     | sqlalchemy.pool.impl.AsyncAdaptedQueuePool | Connection <AdaptedConnection <asyncpg.connection.Connection object at 0x7881499c7200>> exceeded timeout; recycling
2026-01-18 04:40:07 | INFO     | uvicorn.access | 10.3.6.1:0 - "OPTIONS /v1/interests HTTP/1.1" 200
2026-01-18 04:40:07 | WARNING  | mybuddy.api | Request potential issue
2026-01-18 04:40:07 | INFO     | uvicorn.access | 10.3.6.1:0 - "GET /v1/children HTTP/1.1" 401
2026-01-18 04:40:07 | WARNING  | mybuddy.api | Request potential issue
2026-01-18 04:40:07 | INFO     | uvicorn.access | 10.3.6.1:0 - "GET /v1/children/b65a73c4-8de3-404d-b875-90fd93cccb11/dashboard HTTP/1.1" 401
2026-01-18 04:40:07 | INFO     | sqlalchemy.pool.impl.AsyncAdaptedQueuePool | Connection <AdaptedConnection <asyncpg.connection.Connection object at 0x78814a29b980>> exceeded timeout; recycling
2026-01-18 04:40:07 | INFO     | sqlalchemy.engine.Engine | BEGIN (implicit)
2026-01-18 04:40:07 | INFO     | sqlalchemy.engine.Engine | SELECT avatars.id, avatars.name, avatars.image_path, avatars.is_active 
FROM avatars 
WHERE avatars.is_active = true
2026-01-18 04:40:07 | INFO     | sqlalchemy.engine.Engine | [cached since 446.5s ago] ()
2026-01-18 04:40:07 | INFO     | uvicorn.access | 10.3.6.1:0 - "GET /v1/avatars HTTP/1.1" 200
2026-01-18 04:40:07 | INFO     | sqlalchemy.engine.Engine | ROLLBACK
2026-01-18 04:40:07 | INFO     | sqlalchemy.engine.Engine | BEGIN (implicit)
2026-01-18 04:40:07 | INFO     | sqlalchemy.engine.Engine | SELECT interests.id, interests.name, interests.label, interests.icon, interests.is_active 
FROM interests 
WHERE interests.is_active = true
2026-01-18 04:40:07 | INFO     | sqlalchemy.engine.Engine | [cached since 446.6s ago] ()
2026-01-18 04:40:07 | INFO     | uvicorn.access | 10.3.6.1:0 - "GET /v1/interests HTTP/1.1" 200
2026-01-18 04:40:07 | INFO     | sqlalchemy.engine.Engine | ROLLBACK
2026-01-18 04:40:07 | INFO     | sqlalchemy.pool.impl.AsyncAdaptedQueuePool | Connection <AdaptedConnection <asyncpg.connection.Connection object at 0x7881499c6e40>> exceeded timeout; recycling
2026-01-18 04:40:07 | INFO     | sqlalchemy.pool.impl.AsyncAdaptedQueuePool | Connection <AdaptedConnection <asyncpg.connection.Connection object at 0x78814a533890>> exceeded timeout; recycling
2026-01-18 04:40:08 | INFO     | sqlalchemy.engine.Engine | BEGIN (implicit)
2026-01-18 04:40:08 | INFO     | sqlalchemy.engine.Engine | SELECT children.created_at, children.updated_at, children.id, children.owner_sub, children.name, children.birthday, children.interests, children.avatar_id 
FROM children 
WHERE children.owner_sub = $1::VARCHAR ORDER BY children.created_at DESC
2026-01-18 04:40:08 | INFO     | sqlalchemy.engine.Engine | [cached since 446.5s ago] ('fb84a374-66ee-4698-b7ba-f1334bb61d0f',)
2026-01-18 04:40:08 | INFO     | sqlalchemy.engine.Engine | BEGIN (implicit)
2026-01-18 04:40:08 | INFO     | sqlalchemy.engine.Engine | SELECT children.created_at, children.updated_at, children.id, children.owner_sub, children.name, children.birthday, children.interests, children.avatar_id 
FROM children 
WHERE children.id = $1::UUID AND children.owner_sub = $2::VARCHAR
2026-01-18 04:40:08 | INFO     | sqlalchemy.engine.Engine | [cached since 616.1s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), 'fb84a374-66ee-4698-b7ba-f1334bb61d0f')
2026-01-18 04:40:08 | INFO     | uvicorn.access | 10.3.6.1:0 - "GET /v1/children HTTP/1.1" 200
2026-01-18 04:40:08 | INFO     | mybuddy.api | build_dashboard: start child_id=b65a73c4-8de3-404d-b875-90fd93cccb11
2026-01-18 04:40:08 | INFO     | sqlalchemy.engine.Engine | SELECT child_activity_events.kind, count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID GROUP BY child_activity_events.kind
2026-01-18 04:40:08 | INFO     | sqlalchemy.engine.Engine | [cached since 615.9s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'),)
2026-01-18 04:40:08 | INFO     | sqlalchemy.engine.Engine | ROLLBACK
2026-01-18 04:40:08 | INFO     | sqlalchemy.engine.Engine | SELECT coalesce(sum(child_activity_events.points), $1::INTEGER) AS coalesce_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $2::UUID
2026-01-18 04:40:08 | INFO     | sqlalchemy.engine.Engine | [cached since 615.9s ago] (0, UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'))
2026-01-18 04:40:08 | INFO     | mybuddy.api | progress_totals: child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 totalPoints=75 counts={'affirmation': 8, 'chore': 1, 'outdoor': 1}
2026-01-18 04:40:08 | INFO     | sqlalchemy.engine.Engine | SELECT child_activity_events.kind, count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.created_at >= $2::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $3::TIMESTAMP WITH TIME ZONE GROUP BY child_activity_events.kind
2026-01-18 04:40:08 | INFO     | sqlalchemy.engine.Engine | [cached since 615.9s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:40:08 | INFO     | sqlalchemy.engine.Engine | SELECT coalesce(sum(child_activity_events.points), $1::INTEGER) AS coalesce_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $2::UUID AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE
2026-01-18 04:40:08 | INFO     | sqlalchemy.engine.Engine | [cached since 615.9s ago] (0, UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:40:08 | INFO     | sqlalchemy.engine.Engine | SELECT count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.kind = $2::VARCHAR AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE AND child_activity_events.correct = true
2026-01-18 04:40:08 | INFO     | sqlalchemy.engine.Engine | [cached since 615.9s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), 'flashcard', datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:40:08 | INFO     | mybuddy.api | progress_today: child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 date=2026-01-17 counts={'affirmation': 8, 'chore': 1, 'outdoor': 1} flash_correct=0 totalPoints=75
2026-01-18 04:40:08 | INFO     | sqlalchemy.engine.Engine | SELECT coalesce(sum(child_activity_events.points), $1::INTEGER) AS coalesce_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $2::UUID AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE
2026-01-18 04:40:08 | INFO     | sqlalchemy.engine.Engine | [cached since 615.9s ago] (0, UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), datetime.datetime(2026, 1, 11, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:40:08 | INFO     | sqlalchemy.engine.Engine | SELECT count(DISTINCT ((child_activity_events.created_at AT TIME ZONE 'America/New_York')::date)) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.created_at >= $2::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $3::TIMESTAMP WITH TIME ZONE
2026-01-18 04:40:08 | INFO     | sqlalchemy.engine.Engine | [cached since 614.2s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), datetime.datetime(2026, 1, 11, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:40:08 | INFO     | sqlalchemy.engine.Engine | SELECT child_activity_events.kind, count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.created_at >= $2::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $3::TIMESTAMP WITH TIME ZONE GROUP BY child_activity_events.kind
2026-01-18 04:40:08 | INFO     | sqlalchemy.engine.Engine | [cached since 615.9s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), datetime.datetime(2026, 1, 11, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:40:08 | INFO     | sqlalchemy.engine.Engine | SELECT count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.kind = $2::VARCHAR AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE AND child_activity_events.correct = true
2026-01-18 04:40:08 | INFO     | sqlalchemy.engine.Engine | [cached since 615.9s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), 'flashcard', datetime.datetime(2026, 1, 11, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:40:08 | INFO     | mybuddy.api | progress_week: child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 weekStart=2026-01-11 counts={'affirmation': 8, 'chore': 1, 'outdoor': 1} flash_correct=0 accuracyPct=0 totalPoints=75 daysActive=1
2026-01-18 04:40:08 | INFO     | sqlalchemy.engine.Engine | SELECT DISTINCT child_activity_events.chore_id 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.kind = $2::VARCHAR AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE AND child_activity_events.chore_id IS NOT NULL
2026-01-18 04:40:08 | INFO     | sqlalchemy.engine.Engine | [cached since 614.1s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), 'chore', datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:40:08 | INFO     | sqlalchemy.engine.Engine | SELECT DISTINCT child_activity_events.outdoor_activity_id 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.kind = $2::VARCHAR AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE AND child_activity_events.outdoor_activity_id IS NOT NULL
2026-01-18 04:40:08 | INFO     | sqlalchemy.engine.Engine | [cached since 614.1s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), 'outdoor', datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:40:08 | INFO     | sqlalchemy.engine.Engine | SELECT children.created_at, children.updated_at, children.id, children.owner_sub, children.name, children.birthday, children.interests, children.avatar_id 
FROM children 
WHERE children.id = $1::UUID
2026-01-18 04:40:08 | INFO     | sqlalchemy.engine.Engine | [cached since 616s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'),)
2026-01-18 04:40:08 | INFO     | sqlalchemy.engine.Engine | SELECT age_ranges.id, age_ranges.code, age_ranges.name, age_ranges.min_age, age_ranges.max_age, age_ranges.is_active 
FROM age_ranges 
WHERE age_ranges.min_age <= $1::INTEGER AND (age_ranges.max_age IS NULL OR age_ranges.max_age >= $2::INTEGER) AND age_ranges.is_active = true
2026-01-18 04:40:08 | INFO     | sqlalchemy.engine.Engine | [cached since 616s ago] (8, 8)
2026-01-18 04:40:08 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code 
FROM subjects JOIN subject_age_ranges ON subjects.id = subject_age_ranges.subject_id 
WHERE subject_age_ranges.age_range_id = $1::UUID ORDER BY subjects.code
2026-01-18 04:40:08 | INFO     | sqlalchemy.engine.Engine | [cached since 616s ago] (UUID('1aea8d41-8a9a-4631-a8d7-b8ef59d74bfc'),)
2026-01-18 04:40:08 | INFO     | sqlalchemy.engine.Engine | SELECT difficulty_thresholds.code, difficulty_thresholds.threshold 
FROM difficulty_thresholds 
WHERE difficulty_thresholds.is_active = true
2026-01-18 04:40:08 | INFO     | sqlalchemy.engine.Engine | [cached since 615.9s ago] ()
2026-01-18 04:40:08 | INFO     | mybuddy.api | difficulty_thresholds: child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 thresholds={'easy': 0, 'medium': 25, 'hard': 50, 'impossible': 100}
2026-01-18 04:40:08 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code AS subject_code, count(child_activity_events.id) AS completed, coalesce(sum(CASE WHEN (child_activity_events.correct = true) THEN $1::INTEGER ELSE $2::INTEGER END), $3::INTEGER) AS correct 
FROM child_activity_events JOIN subjects ON subjects.id = child_activity_events.subject_id 
WHERE child_activity_events.child_id = $4::UUID AND child_activity_events.kind = $5::VARCHAR GROUP BY subjects.code
2026-01-18 04:40:08 | INFO     | sqlalchemy.engine.Engine | [cached since 615.9s ago] (1, 0, 0, UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), 'flashcard')
2026-01-18 04:40:08 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code, child_subject_streaks.current_streak, child_subject_streaks.longest_streak 
FROM child_subject_streaks JOIN subjects ON subjects.id = child_subject_streaks.subject_id 
WHERE child_subject_streaks.child_id = $1::UUID
2026-01-18 04:40:08 | INFO     | sqlalchemy.engine.Engine | [cached since 615.9s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'),)
2026-01-18 04:40:08 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code, child_subject_difficulty.difficulty_code 
FROM child_subject_difficulty JOIN subjects ON subjects.id = child_subject_difficulty.subject_id 
WHERE child_subject_difficulty.child_id = $1::UUID
2026-01-18 04:40:08 | INFO     | sqlalchemy.engine.Engine | [cached since 615.9s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'),)
2026-01-18 04:40:08 | INFO     | mybuddy.api | subject_difficulty_map: child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 diff_map={'math': 'easy', 'science': 'easy', 'reading': 'easy', 'history': 'easy'}
2026-01-18 04:40:08 | INFO     | mybuddy.api | dashboard_flashcards_by_subject: child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 by_subject={'history': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 0, 'longestStreak': 0}, 'math': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 0, 'longestStreak': 0}, 'reading': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 0, 'longestStreak': 0}, 'science': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 0, 'longestStreak': 0}}
2026-01-18 04:40:08 | INFO     | sqlalchemy.engine.Engine | SELECT DISTINCT ((child_activity_events.created_at AT TIME ZONE 'America/New_York')::date) AS d 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.created_at >= $2::TIMESTAMP WITH TIME ZONE ORDER BY d DESC
2026-01-18 04:40:08 | INFO     | sqlalchemy.engine.Engine | [cached since 615.9s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), datetime.datetime(2025, 7, 21, 4, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:40:08 | INFO     | sqlalchemy.engine.Engine | SELECT level_thresholds.id, level_thresholds.name, level_thresholds.threshold, level_thresholds.icon, level_thresholds.color, level_thresholds.is_active 
FROM level_thresholds 
WHERE level_thresholds.is_active = true
2026-01-18 04:40:08 | INFO     | sqlalchemy.engine.Engine | [cached since 616s ago] ()
2026-01-18 04:40:08 | INFO     | mybuddy.api | build_dashboard: loaded child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 core_subjects=['history', 'math', 'reading', 'science'] by_subject_keys=['history', 'math', 'reading', 'science'] totalPoints=75
2026-01-18 04:40:08 | INFO     | sqlalchemy.engine.Engine | SELECT child_balanced_progress_counters.id, child_balanced_progress_counters.child_id, child_balanced_progress_counters.subject_code, child_balanced_progress_counters.correct_count, child_balanced_progress_counters.updated_at 
FROM child_balanced_progress_counters 
WHERE child_balanced_progress_counters.child_id = $1::UUID
2026-01-18 04:40:08 | INFO     | sqlalchemy.engine.Engine | [cached since 614.1s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'),)
2026-01-18 04:40:08 | INFO     | sqlalchemy.engine.Engine | SELECT child_progress.child_id, child_progress.total_points, child_progress.total_flashcards, child_progress.total_chores, child_progress.total_outdoor, child_progress.total_affirmations, child_progress.current_streak, child_progress.longest_streak, child_progress.last_active_date, child_progress.last_seen_at, child_progress.current_level, child_progress.subject_counts 
FROM child_progress 
WHERE child_progress.child_id = $1::UUID
2026-01-18 04:40:08 | INFO     | sqlalchemy.engine.Engine | [cached since 616s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'),)
2026-01-18 04:40:08 | INFO     | sqlalchemy.engine.Engine | SELECT achievements.code, child_achievements.unlocked_at 
FROM achievements JOIN child_achievements ON child_achievements.achievement_id = achievements.id 
WHERE child_achievements.child_id = $1::UUID
2026-01-18 04:40:08 | INFO     | sqlalchemy.engine.Engine | [cached since 614.1s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'),)
2026-01-18 04:40:08 | INFO     | sqlalchemy.engine.Engine | SELECT achievements.created_at, achievements.updated_at, achievements.id, achievements.code, achievements.title, achievements.description, achievements.icon, achievements.achievement_type, achievements.points_threshold, achievements.streak_days_threshold, achievements.flashcards_count_threshold, achievements.chores_count_threshold, achievements.outdoor_count_threshold, achievements.is_active 
FROM achievements
2026-01-18 04:40:08 | INFO     | sqlalchemy.engine.Engine | [cached since 615.9s ago] ()
2026-01-18 04:40:08 | INFO     | mybuddy.api | build_dashboard: end child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 unlocked=2 locked=18
2026-01-18 04:40:08 | INFO     | uvicorn.access | 10.3.6.1:0 - "GET /v1/children/b65a73c4-8de3-404d-b875-90fd93cccb11/dashboard HTTP/1.1" 200
2026-01-18 04:40:08 | INFO     | sqlalchemy.engine.Engine | ROLLBACK
2026-01-18 04:40:12 | INFO     | uvicorn.access | 10.3.6.1:0 - "OPTIONS /v1/affirmations?childId=b65a73c4-8de3-404d-b875-90fd93cccb11 HTTP/1.1" 200
2026-01-18 04:40:12 | INFO     | sqlalchemy.engine.Engine | BEGIN (implicit)
2026-01-18 04:40:12 | INFO     | sqlalchemy.engine.Engine | SELECT children.created_at, children.updated_at, children.id, children.owner_sub, children.name, children.birthday, children.interests, children.avatar_id 
FROM children 
WHERE children.id = $1::UUID AND children.owner_sub = $2::VARCHAR
2026-01-18 04:40:12 | INFO     | sqlalchemy.engine.Engine | [cached since 620.4s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), 'fb84a374-66ee-4698-b7ba-f1334bb61d0f')
2026-01-18 04:40:12 | INFO     | sqlalchemy.engine.Engine | SELECT age_ranges.id, age_ranges.code, age_ranges.name, age_ranges.min_age, age_ranges.max_age, age_ranges.is_active 
FROM age_ranges 
WHERE age_ranges.min_age <= $1::INTEGER AND (age_ranges.max_age IS NULL OR age_ranges.max_age >= $2::INTEGER) AND age_ranges.is_active = true
2026-01-18 04:40:12 | INFO     | sqlalchemy.engine.Engine | [cached since 620.2s ago] (8, 8)
2026-01-18 04:40:12 | INFO     | mybuddy.api | list_affirmations: child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 age_range_id=1aea8d41-8a9a-4631-a8d7-b8ef59d74bfc interests=['cef77ae5-6e4d-487e-8569-1cca10556c82']
2026-01-18 04:40:12 | INFO     | sqlalchemy.engine.Engine | SELECT affirmations.id, affirmations.text, affirmations.image, affirmations.gradient_0, affirmations.gradient_1, affirmations.tags, affirmations.age_range_id 
FROM affirmations 
WHERE affirmations.age_range_id = $1::UUID ORDER BY CASE WHEN (coalesce(affirmations.tags, '[]'::jsonb) ? $2::VARCHAR) THEN $3::INTEGER WHEN $4::BOOLEAN THEN $5::INTEGER END, random()
2026-01-18 04:40:12 | INFO     | sqlalchemy.engine.Engine | [cached since 449s ago] (UUID('1aea8d41-8a9a-4631-a8d7-b8ef59d74bfc'), 'cef77ae5-6e4d-487e-8569-1cca10556c82', 0, True, 1)
2026-01-18 04:40:12 | INFO     | uvicorn.access | 10.3.6.1:0 - "GET /v1/affirmations?childId=b65a73c4-8de3-404d-b875-90fd93cccb11 HTTP/1.1" 200
2026-01-18 04:40:12 | INFO     | sqlalchemy.engine.Engine | ROLLBACK
2026-01-18 04:40:12 | INFO     | uvicorn.access | 10.3.6.1:0 - "OPTIONS /v1/children/b65a73c4-8de3-404d-b875-90fd93cccb11/events/affirmation HTTP/1.1" 200
2026-01-18 04:40:12 | INFO     | sqlalchemy.engine.Engine | BEGIN (implicit)
2026-01-18 04:40:12 | INFO     | sqlalchemy.engine.Engine | SELECT children.created_at, children.updated_at, children.id, children.owner_sub, children.name, children.birthday, children.interests, children.avatar_id 
FROM children 
WHERE children.id = $1::UUID AND children.owner_sub = $2::VARCHAR
2026-01-18 04:40:12 | INFO     | sqlalchemy.engine.Engine | [cached since 620.7s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), 'fb84a374-66ee-4698-b7ba-f1334bb61d0f')
2026-01-18 04:40:12 | INFO     | mybuddy.api | event_affirmation: start child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 affirmationId=11cdcdd3-58c0-46ff-aebe-3f144e0895b9
2026-01-18 04:40:12 | INFO     | sqlalchemy.engine.Engine | SELECT points_values.id, points_values.code, points_values.name, points_values.points, points_values.is_active 
FROM points_values 
WHERE points_values.is_active = true
2026-01-18 04:40:12 | INFO     | sqlalchemy.engine.Engine | [cached since 620.7s ago] ()
2026-01-18 04:40:12 | INFO     | sqlalchemy.engine.Engine | SAVEPOINT sa_savepoint_1
2026-01-18 04:40:12 | INFO     | sqlalchemy.engine.Engine | [no key 0.00058s] ()
2026-01-18 04:40:12 | INFO     | sqlalchemy.engine.Engine | INSERT INTO child_activity_events (child_id, kind, subject_id, flashcard_id, chore_id, outdoor_activity_id, affirmation_id, points, correct, answer, meta) VALUES ($1::UUID, $2::VARCHAR, $3::UUID, $4::UUID, $5::UUID, $6::UUID, $7::UUID, $8::INTEGER, $9::BOOLEAN, $10::VARCHAR, $11::JSONB) RETURNING child_activity_events.id, child_activity_events.created_at
2026-01-18 04:40:12 | INFO     | sqlalchemy.engine.Engine | [cached since 620.7s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), 'affirmation', None, None, None, None, UUID('11cdcdd3-58c0-46ff-aebe-3f144e0895b9'), 5, None, None, '{"dedupeKey": "affirmation:11cdcdd3-58c0-46ff-aebe-3f144e0895b9", "affirmationId": "11cdcdd3-58c0-46ff-aebe-3f144e0895b9", "points": 5}')
2026-01-18 04:40:12 | INFO     | sqlalchemy.engine.Engine | ROLLBACK TO SAVEPOINT sa_savepoint_1
2026-01-18 04:40:12 | INFO     | sqlalchemy.engine.Engine | [no key 0.00059s] ()
2026-01-18 04:40:12 | INFO     | mybuddy.api | event_affirmation: deduped child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 affirmationId=11cdcdd3-58c0-46ff-aebe-3f144e0895b9
2026-01-18 04:40:12 | INFO     | uvicorn.access | 10.3.6.1:0 - "POST /v1/children/b65a73c4-8de3-404d-b875-90fd93cccb11/events/affirmation HTTP/1.1" 200
2026-01-18 04:40:12 | INFO     | sqlalchemy.engine.Engine | ROLLBACK
2026-01-18 04:40:14 | INFO     | sqlalchemy.engine.Engine | BEGIN (implicit)
2026-01-18 04:40:14 | INFO     | sqlalchemy.engine.Engine | SELECT children.created_at, children.updated_at, children.id, children.owner_sub, children.name, children.birthday, children.interests, children.avatar_id 
FROM children 
WHERE children.id = $1::UUID AND children.owner_sub = $2::VARCHAR
2026-01-18 04:40:14 | INFO     | sqlalchemy.engine.Engine | [cached since 622.3s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), 'fb84a374-66ee-4698-b7ba-f1334bb61d0f')
2026-01-18 04:40:14 | INFO     | mybuddy.api | build_dashboard: start child_id=b65a73c4-8de3-404d-b875-90fd93cccb11
2026-01-18 04:40:14 | INFO     | sqlalchemy.engine.Engine | SELECT child_activity_events.kind, count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID GROUP BY child_activity_events.kind
2026-01-18 04:40:14 | INFO     | sqlalchemy.engine.Engine | [cached since 622.1s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'),)
2026-01-18 04:40:14 | INFO     | sqlalchemy.engine.Engine | SELECT coalesce(sum(child_activity_events.points), $1::INTEGER) AS coalesce_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $2::UUID
2026-01-18 04:40:14 | INFO     | sqlalchemy.engine.Engine | [cached since 622.1s ago] (0, UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'))
2026-01-18 04:40:14 | INFO     | mybuddy.api | progress_totals: child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 totalPoints=75 counts={'affirmation': 8, 'chore': 1, 'outdoor': 1}
2026-01-18 04:40:14 | INFO     | sqlalchemy.engine.Engine | SELECT child_activity_events.kind, count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.created_at >= $2::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $3::TIMESTAMP WITH TIME ZONE GROUP BY child_activity_events.kind
2026-01-18 04:40:14 | INFO     | sqlalchemy.engine.Engine | [cached since 622.1s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:40:14 | INFO     | sqlalchemy.engine.Engine | SELECT coalesce(sum(child_activity_events.points), $1::INTEGER) AS coalesce_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $2::UUID AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE
2026-01-18 04:40:14 | INFO     | sqlalchemy.engine.Engine | [cached since 622.1s ago] (0, UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:40:14 | INFO     | sqlalchemy.engine.Engine | SELECT count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.kind = $2::VARCHAR AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE AND child_activity_events.correct = true
2026-01-18 04:40:14 | INFO     | sqlalchemy.engine.Engine | [cached since 622.1s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), 'flashcard', datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:40:14 | INFO     | mybuddy.api | progress_today: child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 date=2026-01-17 counts={'affirmation': 8, 'chore': 1, 'outdoor': 1} flash_correct=0 totalPoints=75
2026-01-18 04:40:14 | INFO     | sqlalchemy.engine.Engine | SELECT coalesce(sum(child_activity_events.points), $1::INTEGER) AS coalesce_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $2::UUID AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE
2026-01-18 04:40:14 | INFO     | sqlalchemy.engine.Engine | [cached since 622.1s ago] (0, UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), datetime.datetime(2026, 1, 11, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:40:14 | INFO     | sqlalchemy.engine.Engine | SELECT count(DISTINCT ((child_activity_events.created_at AT TIME ZONE 'America/New_York')::date)) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.created_at >= $2::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $3::TIMESTAMP WITH TIME ZONE
2026-01-18 04:40:14 | INFO     | sqlalchemy.engine.Engine | [cached since 620.4s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), datetime.datetime(2026, 1, 11, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:40:14 | INFO     | sqlalchemy.engine.Engine | SELECT child_activity_events.kind, count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.created_at >= $2::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $3::TIMESTAMP WITH TIME ZONE GROUP BY child_activity_events.kind
2026-01-18 04:40:14 | INFO     | sqlalchemy.engine.Engine | [cached since 622.1s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), datetime.datetime(2026, 1, 11, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:40:14 | INFO     | sqlalchemy.engine.Engine | SELECT count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.kind = $2::VARCHAR AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE AND child_activity_events.correct = true
2026-01-18 04:40:14 | INFO     | sqlalchemy.engine.Engine | [cached since 622.1s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), 'flashcard', datetime.datetime(2026, 1, 11, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:40:14 | INFO     | mybuddy.api | progress_week: child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 weekStart=2026-01-11 counts={'affirmation': 8, 'chore': 1, 'outdoor': 1} flash_correct=0 accuracyPct=0 totalPoints=75 daysActive=1
2026-01-18 04:40:14 | INFO     | sqlalchemy.engine.Engine | SELECT DISTINCT child_activity_events.chore_id 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.kind = $2::VARCHAR AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE AND child_activity_events.chore_id IS NOT NULL
2026-01-18 04:40:14 | INFO     | sqlalchemy.engine.Engine | [cached since 620.4s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), 'chore', datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:40:14 | INFO     | sqlalchemy.engine.Engine | SELECT DISTINCT child_activity_events.outdoor_activity_id 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.kind = $2::VARCHAR AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE AND child_activity_events.outdoor_activity_id IS NOT NULL
2026-01-18 04:40:14 | INFO     | sqlalchemy.engine.Engine | [cached since 620.4s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), 'outdoor', datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:40:14 | INFO     | sqlalchemy.engine.Engine | SELECT children.created_at, children.updated_at, children.id, children.owner_sub, children.name, children.birthday, children.interests, children.avatar_id 
FROM children 
WHERE children.id = $1::UUID
2026-01-18 04:40:14 | INFO     | sqlalchemy.engine.Engine | [cached since 622.2s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'),)
2026-01-18 04:40:14 | INFO     | sqlalchemy.engine.Engine | SELECT age_ranges.id, age_ranges.code, age_ranges.name, age_ranges.min_age, age_ranges.max_age, age_ranges.is_active 
FROM age_ranges 
WHERE age_ranges.min_age <= $1::INTEGER AND (age_ranges.max_age IS NULL OR age_ranges.max_age >= $2::INTEGER) AND age_ranges.is_active = true
2026-01-18 04:40:14 | INFO     | sqlalchemy.engine.Engine | [cached since 622.2s ago] (8, 8)
2026-01-18 04:40:14 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code 
FROM subjects JOIN subject_age_ranges ON subjects.id = subject_age_ranges.subject_id 
WHERE subject_age_ranges.age_range_id = $1::UUID ORDER BY subjects.code
2026-01-18 04:40:14 | INFO     | sqlalchemy.engine.Engine | [cached since 622.2s ago] (UUID('1aea8d41-8a9a-4631-a8d7-b8ef59d74bfc'),)
2026-01-18 04:40:14 | INFO     | sqlalchemy.engine.Engine | SELECT difficulty_thresholds.code, difficulty_thresholds.threshold 
FROM difficulty_thresholds 
WHERE difficulty_thresholds.is_active = true
2026-01-18 04:40:14 | INFO     | sqlalchemy.engine.Engine | [cached since 622.1s ago] ()
2026-01-18 04:40:14 | INFO     | mybuddy.api | difficulty_thresholds: child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 thresholds={'easy': 0, 'medium': 25, 'hard': 50, 'impossible': 100}
2026-01-18 04:40:14 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code AS subject_code, count(child_activity_events.id) AS completed, coalesce(sum(CASE WHEN (child_activity_events.correct = true) THEN $1::INTEGER ELSE $2::INTEGER END), $3::INTEGER) AS correct 
FROM child_activity_events JOIN subjects ON subjects.id = child_activity_events.subject_id 
WHERE child_activity_events.child_id = $4::UUID AND child_activity_events.kind = $5::VARCHAR GROUP BY subjects.code
2026-01-18 04:40:14 | INFO     | sqlalchemy.engine.Engine | [cached since 622.1s ago] (1, 0, 0, UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), 'flashcard')
2026-01-18 04:40:14 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code, child_subject_streaks.current_streak, child_subject_streaks.longest_streak 
FROM child_subject_streaks JOIN subjects ON subjects.id = child_subject_streaks.subject_id 
WHERE child_subject_streaks.child_id = $1::UUID
2026-01-18 04:40:14 | INFO     | sqlalchemy.engine.Engine | [cached since 622.1s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'),)
2026-01-18 04:40:14 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code, child_subject_difficulty.difficulty_code 
FROM child_subject_difficulty JOIN subjects ON subjects.id = child_subject_difficulty.subject_id 
WHERE child_subject_difficulty.child_id = $1::UUID
2026-01-18 04:40:14 | INFO     | sqlalchemy.engine.Engine | [cached since 622.1s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'),)
2026-01-18 04:40:14 | INFO     | mybuddy.api | subject_difficulty_map: child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 diff_map={'math': 'easy', 'science': 'easy', 'reading': 'easy', 'history': 'easy'}
2026-01-18 04:40:14 | INFO     | mybuddy.api | dashboard_flashcards_by_subject: child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 by_subject={'history': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 0, 'longestStreak': 0}, 'math': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 0, 'longestStreak': 0}, 'reading': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 0, 'longestStreak': 0}, 'science': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 0, 'longestStreak': 0}}
2026-01-18 04:40:14 | INFO     | sqlalchemy.engine.Engine | SELECT DISTINCT ((child_activity_events.created_at AT TIME ZONE 'America/New_York')::date) AS d 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.created_at >= $2::TIMESTAMP WITH TIME ZONE ORDER BY d DESC
2026-01-18 04:40:14 | INFO     | sqlalchemy.engine.Engine | [cached since 622.1s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), datetime.datetime(2025, 7, 21, 4, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:40:14 | INFO     | sqlalchemy.engine.Engine | SELECT level_thresholds.id, level_thresholds.name, level_thresholds.threshold, level_thresholds.icon, level_thresholds.color, level_thresholds.is_active 
FROM level_thresholds 
WHERE level_thresholds.is_active = true
2026-01-18 04:40:14 | INFO     | sqlalchemy.engine.Engine | [cached since 622.2s ago] ()
2026-01-18 04:40:14 | INFO     | mybuddy.api | build_dashboard: loaded child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 core_subjects=['history', 'math', 'reading', 'science'] by_subject_keys=['history', 'math', 'reading', 'science'] totalPoints=75
2026-01-18 04:40:14 | INFO     | sqlalchemy.engine.Engine | SELECT child_balanced_progress_counters.id, child_balanced_progress_counters.child_id, child_balanced_progress_counters.subject_code, child_balanced_progress_counters.correct_count, child_balanced_progress_counters.updated_at 
FROM child_balanced_progress_counters 
WHERE child_balanced_progress_counters.child_id = $1::UUID
2026-01-18 04:40:14 | INFO     | sqlalchemy.engine.Engine | [cached since 620.4s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'),)
2026-01-18 04:40:14 | INFO     | sqlalchemy.engine.Engine | SELECT child_progress.child_id, child_progress.total_points, child_progress.total_flashcards, child_progress.total_chores, child_progress.total_outdoor, child_progress.total_affirmations, child_progress.current_streak, child_progress.longest_streak, child_progress.last_active_date, child_progress.last_seen_at, child_progress.current_level, child_progress.subject_counts 
FROM child_progress 
WHERE child_progress.child_id = $1::UUID
2026-01-18 04:40:14 | INFO     | sqlalchemy.engine.Engine | [cached since 622.3s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'),)
2026-01-18 04:40:14 | INFO     | sqlalchemy.engine.Engine | SELECT achievements.code, child_achievements.unlocked_at 
FROM achievements JOIN child_achievements ON child_achievements.achievement_id = achievements.id 
WHERE child_achievements.child_id = $1::UUID
2026-01-18 04:40:14 | INFO     | sqlalchemy.engine.Engine | [cached since 620.4s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'),)
2026-01-18 04:40:14 | INFO     | sqlalchemy.engine.Engine | SELECT achievements.created_at, achievements.updated_at, achievements.id, achievements.code, achievements.title, achievements.description, achievements.icon, achievements.achievement_type, achievements.points_threshold, achievements.streak_days_threshold, achievements.flashcards_count_threshold, achievements.chores_count_threshold, achievements.outdoor_count_threshold, achievements.is_active 
FROM achievements
2026-01-18 04:40:14 | INFO     | sqlalchemy.engine.Engine | [cached since 622.2s ago] ()
2026-01-18 04:40:14 | INFO     | mybuddy.api | build_dashboard: end child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 unlocked=2 locked=18
2026-01-18 04:40:14 | INFO     | uvicorn.access | 10.3.6.1:0 - "GET /v1/children/b65a73c4-8de3-404d-b875-90fd93cccb11/dashboard HTTP/1.1" 200
2026-01-18 04:40:14 | INFO     | sqlalchemy.engine.Engine | ROLLBACK
2026-01-18 04:41:13 | INFO     | sqlalchemy.engine.Engine | BEGIN (implicit)
2026-01-18 04:41:13 | INFO     | sqlalchemy.engine.Engine | SELECT avatars.id, avatars.name, avatars.image_path, avatars.is_active 
FROM avatars 
WHERE avatars.is_active = true
2026-01-18 04:41:13 | INFO     | sqlalchemy.engine.Engine | [cached since 512.6s ago] ()
2026-01-18 04:41:13 | INFO     | sqlalchemy.engine.Engine | BEGIN (implicit)
2026-01-18 04:41:13 | INFO     | sqlalchemy.engine.Engine | SELECT interests.id, interests.name, interests.label, interests.icon, interests.is_active 
FROM interests 
WHERE interests.is_active = true
2026-01-18 04:41:13 | INFO     | sqlalchemy.engine.Engine | [cached since 512.6s ago] ()
2026-01-18 04:41:13 | INFO     | sqlalchemy.engine.Engine | BEGIN (implicit)
2026-01-18 04:41:13 | INFO     | sqlalchemy.engine.Engine | SELECT children.created_at, children.updated_at, children.id, children.owner_sub, children.name, children.birthday, children.interests, children.avatar_id 
FROM children 
WHERE children.owner_sub = $1::VARCHAR ORDER BY children.created_at DESC
2026-01-18 04:41:13 | INFO     | sqlalchemy.engine.Engine | [cached since 512.4s ago] ('fb84a374-66ee-4698-b7ba-f1334bb61d0f',)
2026-01-18 04:41:13 | INFO     | uvicorn.access | 10.3.6.1:0 - "GET /v1/avatars HTTP/1.1" 200
2026-01-18 04:41:13 | INFO     | sqlalchemy.engine.Engine | BEGIN (implicit)
2026-01-18 04:41:13 | INFO     | sqlalchemy.engine.Engine | SELECT children.created_at, children.updated_at, children.id, children.owner_sub, children.name, children.birthday, children.interests, children.avatar_id 
FROM children 
WHERE children.id = $1::UUID AND children.owner_sub = $2::VARCHAR
2026-01-18 04:41:13 | INFO     | sqlalchemy.engine.Engine | [cached since 682s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), 'fb84a374-66ee-4698-b7ba-f1334bb61d0f')
2026-01-18 04:41:13 | INFO     | sqlalchemy.engine.Engine | ROLLBACK
2026-01-18 04:41:13 | INFO     | mybuddy.api | build_dashboard: start child_id=b65a73c4-8de3-404d-b875-90fd93cccb11
2026-01-18 04:41:13 | INFO     | sqlalchemy.engine.Engine | SELECT child_activity_events.kind, count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID GROUP BY child_activity_events.kind
2026-01-18 04:41:13 | INFO     | sqlalchemy.engine.Engine | [cached since 681.8s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'),)
2026-01-18 04:41:13 | INFO     | uvicorn.access | 10.3.6.1:0 - "GET /v1/interests HTTP/1.1" 200
2026-01-18 04:41:13 | INFO     | sqlalchemy.engine.Engine | SELECT coalesce(sum(child_activity_events.points), $1::INTEGER) AS coalesce_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $2::UUID
2026-01-18 04:41:13 | INFO     | sqlalchemy.engine.Engine | [cached since 681.8s ago] (0, UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'))
2026-01-18 04:41:13 | INFO     | uvicorn.access | 10.3.6.1:0 - "GET /v1/children HTTP/1.1" 200
2026-01-18 04:41:13 | INFO     | mybuddy.api | progress_totals: child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 totalPoints=75 counts={'affirmation': 8, 'chore': 1, 'outdoor': 1}
2026-01-18 04:41:13 | INFO     | sqlalchemy.engine.Engine | SELECT child_activity_events.kind, count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.created_at >= $2::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $3::TIMESTAMP WITH TIME ZONE GROUP BY child_activity_events.kind
2026-01-18 04:41:13 | INFO     | sqlalchemy.engine.Engine | [cached since 681.8s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:41:13 | INFO     | sqlalchemy.engine.Engine | ROLLBACK
2026-01-18 04:41:13 | INFO     | sqlalchemy.engine.Engine | ROLLBACK
2026-01-18 04:41:13 | INFO     | sqlalchemy.engine.Engine | SELECT coalesce(sum(child_activity_events.points), $1::INTEGER) AS coalesce_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $2::UUID AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE
2026-01-18 04:41:13 | INFO     | sqlalchemy.engine.Engine | [cached since 681.8s ago] (0, UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:41:13 | INFO     | sqlalchemy.engine.Engine | SELECT count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.kind = $2::VARCHAR AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE AND child_activity_events.correct = true
2026-01-18 04:41:13 | INFO     | sqlalchemy.engine.Engine | [cached since 681.8s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), 'flashcard', datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:41:13 | INFO     | mybuddy.api | progress_today: child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 date=2026-01-17 counts={'affirmation': 8, 'chore': 1, 'outdoor': 1} flash_correct=0 totalPoints=75
2026-01-18 04:41:13 | INFO     | sqlalchemy.engine.Engine | SELECT coalesce(sum(child_activity_events.points), $1::INTEGER) AS coalesce_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $2::UUID AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE
2026-01-18 04:41:13 | INFO     | sqlalchemy.engine.Engine | [cached since 681.8s ago] (0, UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), datetime.datetime(2026, 1, 11, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:41:13 | INFO     | sqlalchemy.engine.Engine | SELECT count(DISTINCT ((child_activity_events.created_at AT TIME ZONE 'America/New_York')::date)) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.created_at >= $2::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $3::TIMESTAMP WITH TIME ZONE
2026-01-18 04:41:13 | INFO     | sqlalchemy.engine.Engine | [cached since 680s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), datetime.datetime(2026, 1, 11, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:41:13 | INFO     | sqlalchemy.engine.Engine | SELECT child_activity_events.kind, count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.created_at >= $2::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $3::TIMESTAMP WITH TIME ZONE GROUP BY child_activity_events.kind
2026-01-18 04:41:13 | INFO     | sqlalchemy.engine.Engine | [cached since 681.8s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), datetime.datetime(2026, 1, 11, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:41:13 | INFO     | sqlalchemy.engine.Engine | SELECT count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.kind = $2::VARCHAR AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE AND child_activity_events.correct = true
2026-01-18 04:41:13 | INFO     | sqlalchemy.engine.Engine | [cached since 681.8s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), 'flashcard', datetime.datetime(2026, 1, 11, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:41:13 | INFO     | mybuddy.api | progress_week: child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 weekStart=2026-01-11 counts={'affirmation': 8, 'chore': 1, 'outdoor': 1} flash_correct=0 accuracyPct=0 totalPoints=75 daysActive=1
2026-01-18 04:41:13 | INFO     | sqlalchemy.engine.Engine | SELECT DISTINCT child_activity_events.chore_id 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.kind = $2::VARCHAR AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE AND child_activity_events.chore_id IS NOT NULL
2026-01-18 04:41:13 | INFO     | sqlalchemy.engine.Engine | [cached since 680s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), 'chore', datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:41:13 | INFO     | sqlalchemy.engine.Engine | SELECT DISTINCT child_activity_events.outdoor_activity_id 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.kind = $2::VARCHAR AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE AND child_activity_events.outdoor_activity_id IS NOT NULL
2026-01-18 04:41:13 | INFO     | sqlalchemy.engine.Engine | [cached since 680s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), 'outdoor', datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:41:13 | INFO     | sqlalchemy.engine.Engine | SELECT children.created_at, children.updated_at, children.id, children.owner_sub, children.name, children.birthday, children.interests, children.avatar_id 
FROM children 
WHERE children.id = $1::UUID
2026-01-18 04:41:13 | INFO     | sqlalchemy.engine.Engine | [cached since 681.9s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'),)
2026-01-18 04:41:13 | INFO     | sqlalchemy.engine.Engine | SELECT age_ranges.id, age_ranges.code, age_ranges.name, age_ranges.min_age, age_ranges.max_age, age_ranges.is_active 
FROM age_ranges 
WHERE age_ranges.min_age <= $1::INTEGER AND (age_ranges.max_age IS NULL OR age_ranges.max_age >= $2::INTEGER) AND age_ranges.is_active = true
2026-01-18 04:41:13 | INFO     | sqlalchemy.engine.Engine | [cached since 681.9s ago] (8, 8)
2026-01-18 04:41:13 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code 
FROM subjects JOIN subject_age_ranges ON subjects.id = subject_age_ranges.subject_id 
WHERE subject_age_ranges.age_range_id = $1::UUID ORDER BY subjects.code
2026-01-18 04:41:13 | INFO     | sqlalchemy.engine.Engine | [cached since 681.9s ago] (UUID('1aea8d41-8a9a-4631-a8d7-b8ef59d74bfc'),)
2026-01-18 04:41:13 | INFO     | sqlalchemy.engine.Engine | SELECT difficulty_thresholds.code, difficulty_thresholds.threshold 
FROM difficulty_thresholds 
WHERE difficulty_thresholds.is_active = true
2026-01-18 04:41:13 | INFO     | sqlalchemy.engine.Engine | [cached since 681.8s ago] ()
2026-01-18 04:41:13 | INFO     | mybuddy.api | difficulty_thresholds: child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 thresholds={'easy': 0, 'medium': 25, 'hard': 50, 'impossible': 100}
2026-01-18 04:41:13 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code AS subject_code, count(child_activity_events.id) AS completed, coalesce(sum(CASE WHEN (child_activity_events.correct = true) THEN $1::INTEGER ELSE $2::INTEGER END), $3::INTEGER) AS correct 
FROM child_activity_events JOIN subjects ON subjects.id = child_activity_events.subject_id 
WHERE child_activity_events.child_id = $4::UUID AND child_activity_events.kind = $5::VARCHAR GROUP BY subjects.code
2026-01-18 04:41:13 | INFO     | sqlalchemy.engine.Engine | [cached since 681.8s ago] (1, 0, 0, UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), 'flashcard')
2026-01-18 04:41:13 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code, child_subject_streaks.current_streak, child_subject_streaks.longest_streak 
FROM child_subject_streaks JOIN subjects ON subjects.id = child_subject_streaks.subject_id 
WHERE child_subject_streaks.child_id = $1::UUID
2026-01-18 04:41:13 | INFO     | sqlalchemy.engine.Engine | [cached since 681.8s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'),)
2026-01-18 04:41:13 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code, child_subject_difficulty.difficulty_code 
FROM child_subject_difficulty JOIN subjects ON subjects.id = child_subject_difficulty.subject_id 
WHERE child_subject_difficulty.child_id = $1::UUID
2026-01-18 04:41:13 | INFO     | sqlalchemy.engine.Engine | [cached since 681.8s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'),)
2026-01-18 04:41:13 | INFO     | mybuddy.api | subject_difficulty_map: child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 diff_map={'math': 'easy', 'science': 'easy', 'reading': 'easy', 'history': 'easy'}
2026-01-18 04:41:13 | INFO     | mybuddy.api | dashboard_flashcards_by_subject: child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 by_subject={'history': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 0, 'longestStreak': 0}, 'math': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 0, 'longestStreak': 0}, 'reading': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 0, 'longestStreak': 0}, 'science': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 0, 'longestStreak': 0}}
2026-01-18 04:41:13 | INFO     | sqlalchemy.engine.Engine | SELECT DISTINCT ((child_activity_events.created_at AT TIME ZONE 'America/New_York')::date) AS d 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.created_at >= $2::TIMESTAMP WITH TIME ZONE ORDER BY d DESC
2026-01-18 04:41:13 | INFO     | sqlalchemy.engine.Engine | [cached since 681.8s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), datetime.datetime(2025, 7, 21, 4, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:41:13 | INFO     | sqlalchemy.engine.Engine | SELECT level_thresholds.id, level_thresholds.name, level_thresholds.threshold, level_thresholds.icon, level_thresholds.color, level_thresholds.is_active 
FROM level_thresholds 
WHERE level_thresholds.is_active = true
2026-01-18 04:41:13 | INFO     | sqlalchemy.engine.Engine | [cached since 681.9s ago] ()
2026-01-18 04:41:13 | INFO     | mybuddy.api | build_dashboard: loaded child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 core_subjects=['history', 'math', 'reading', 'science'] by_subject_keys=['history', 'math', 'reading', 'science'] totalPoints=75
2026-01-18 04:41:13 | INFO     | sqlalchemy.engine.Engine | SELECT child_balanced_progress_counters.id, child_balanced_progress_counters.child_id, child_balanced_progress_counters.subject_code, child_balanced_progress_counters.correct_count, child_balanced_progress_counters.updated_at 
FROM child_balanced_progress_counters 
WHERE child_balanced_progress_counters.child_id = $1::UUID
2026-01-18 04:41:13 | INFO     | sqlalchemy.engine.Engine | [cached since 680s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'),)
2026-01-18 04:41:13 | INFO     | sqlalchemy.engine.Engine | SELECT child_progress.child_id, child_progress.total_points, child_progress.total_flashcards, child_progress.total_chores, child_progress.total_outdoor, child_progress.total_affirmations, child_progress.current_streak, child_progress.longest_streak, child_progress.last_active_date, child_progress.last_seen_at, child_progress.current_level, child_progress.subject_counts 
FROM child_progress 
WHERE child_progress.child_id = $1::UUID
2026-01-18 04:41:13 | INFO     | sqlalchemy.engine.Engine | [cached since 681.9s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'),)
2026-01-18 04:41:13 | INFO     | sqlalchemy.engine.Engine | SELECT achievements.code, child_achievements.unlocked_at 
FROM achievements JOIN child_achievements ON child_achievements.achievement_id = achievements.id 
WHERE child_achievements.child_id = $1::UUID
2026-01-18 04:41:13 | INFO     | sqlalchemy.engine.Engine | [cached since 680s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'),)
2026-01-18 04:41:13 | INFO     | sqlalchemy.engine.Engine | SELECT achievements.created_at, achievements.updated_at, achievements.id, achievements.code, achievements.title, achievements.description, achievements.icon, achievements.achievement_type, achievements.points_threshold, achievements.streak_days_threshold, achievements.flashcards_count_threshold, achievements.chores_count_threshold, achievements.outdoor_count_threshold, achievements.is_active 
FROM achievements
2026-01-18 04:41:13 | INFO     | sqlalchemy.engine.Engine | [cached since 681.8s ago] ()
2026-01-18 04:41:13 | INFO     | mybuddy.api | build_dashboard: end child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 unlocked=2 locked=18
2026-01-18 04:41:13 | INFO     | uvicorn.access | 10.3.6.1:0 - "GET /v1/children/b65a73c4-8de3-404d-b875-90fd93cccb11/dashboard HTTP/1.1" 200
2026-01-18 04:41:13 | INFO     | sqlalchemy.engine.Engine | ROLLBACK
2026-01-18 04:41:14 | INFO     | sqlalchemy.engine.Engine | BEGIN (implicit)
2026-01-18 04:41:14 | INFO     | sqlalchemy.engine.Engine | SELECT children.created_at, children.updated_at, children.id, children.owner_sub, children.name, children.birthday, children.interests, children.avatar_id 
FROM children 
WHERE children.id = $1::UUID AND children.owner_sub = $2::VARCHAR
2026-01-18 04:41:14 | INFO     | sqlalchemy.engine.Engine | [cached since 682.9s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), 'fb84a374-66ee-4698-b7ba-f1334bb61d0f')
2026-01-18 04:41:14 | INFO     | sqlalchemy.engine.Engine | SELECT age_ranges.id, age_ranges.code, age_ranges.name, age_ranges.min_age, age_ranges.max_age, age_ranges.is_active 
FROM age_ranges 
WHERE age_ranges.min_age <= $1::INTEGER AND (age_ranges.max_age IS NULL OR age_ranges.max_age >= $2::INTEGER) AND age_ranges.is_active = true
2026-01-18 04:41:14 | INFO     | sqlalchemy.engine.Engine | [cached since 682.7s ago] (8, 8)
2026-01-18 04:41:14 | INFO     | mybuddy.api | list_affirmations: child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 age_range_id=1aea8d41-8a9a-4631-a8d7-b8ef59d74bfc interests=['cef77ae5-6e4d-487e-8569-1cca10556c82']
2026-01-18 04:41:14 | INFO     | sqlalchemy.engine.Engine | SELECT affirmations.id, affirmations.text, affirmations.image, affirmations.gradient_0, affirmations.gradient_1, affirmations.tags, affirmations.age_range_id 
FROM affirmations 
WHERE affirmations.age_range_id = $1::UUID ORDER BY CASE WHEN (coalesce(affirmations.tags, '[]'::jsonb) ? $2::VARCHAR) THEN $3::INTEGER WHEN $4::BOOLEAN THEN $5::INTEGER END, random()
2026-01-18 04:41:14 | INFO     | sqlalchemy.engine.Engine | [cached since 511.6s ago] (UUID('1aea8d41-8a9a-4631-a8d7-b8ef59d74bfc'), 'cef77ae5-6e4d-487e-8569-1cca10556c82', 0, True, 1)
2026-01-18 04:41:14 | INFO     | uvicorn.access | 10.3.6.1:0 - "GET /v1/affirmations?childId=b65a73c4-8de3-404d-b875-90fd93cccb11 HTTP/1.1" 200
2026-01-18 04:41:14 | INFO     | sqlalchemy.engine.Engine | ROLLBACK
2026-01-18 04:41:15 | INFO     | sqlalchemy.engine.Engine | BEGIN (implicit)
2026-01-18 04:41:15 | INFO     | sqlalchemy.engine.Engine | SELECT children.created_at, children.updated_at, children.id, children.owner_sub, children.name, children.birthday, children.interests, children.avatar_id 
FROM children 
WHERE children.id = $1::UUID AND children.owner_sub = $2::VARCHAR
2026-01-18 04:41:15 | INFO     | sqlalchemy.engine.Engine | [cached since 683.2s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), 'fb84a374-66ee-4698-b7ba-f1334bb61d0f')
2026-01-18 04:41:15 | INFO     | mybuddy.api | event_affirmation: start child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 affirmationId=3af0a2c9-c531-4a30-b536-a86b0c5554c2
2026-01-18 04:41:15 | INFO     | sqlalchemy.engine.Engine | SELECT points_values.id, points_values.code, points_values.name, points_values.points, points_values.is_active 
FROM points_values 
WHERE points_values.is_active = true
2026-01-18 04:41:15 | INFO     | sqlalchemy.engine.Engine | [cached since 683.2s ago] ()
2026-01-18 04:41:15 | INFO     | sqlalchemy.engine.Engine | SAVEPOINT sa_savepoint_1
2026-01-18 04:41:15 | INFO     | sqlalchemy.engine.Engine | [no key 0.00056s] ()
2026-01-18 04:41:15 | INFO     | sqlalchemy.engine.Engine | INSERT INTO child_activity_events (child_id, kind, subject_id, flashcard_id, chore_id, outdoor_activity_id, affirmation_id, points, correct, answer, meta) VALUES ($1::UUID, $2::VARCHAR, $3::UUID, $4::UUID, $5::UUID, $6::UUID, $7::UUID, $8::INTEGER, $9::BOOLEAN, $10::VARCHAR, $11::JSONB) RETURNING child_activity_events.id, child_activity_events.created_at
2026-01-18 04:41:15 | INFO     | sqlalchemy.engine.Engine | [cached since 683.2s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), 'affirmation', None, None, None, None, UUID('3af0a2c9-c531-4a30-b536-a86b0c5554c2'), 5, None, None, '{"dedupeKey": "affirmation:3af0a2c9-c531-4a30-b536-a86b0c5554c2", "affirmationId": "3af0a2c9-c531-4a30-b536-a86b0c5554c2", "points": 5}')
2026-01-18 04:41:15 | INFO     | sqlalchemy.engine.Engine | ROLLBACK TO SAVEPOINT sa_savepoint_1
2026-01-18 04:41:15 | INFO     | sqlalchemy.engine.Engine | [no key 0.00055s] ()
2026-01-18 04:41:15 | INFO     | mybuddy.api | event_affirmation: deduped child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 affirmationId=3af0a2c9-c531-4a30-b536-a86b0c5554c2
2026-01-18 04:41:15 | INFO     | uvicorn.access | 10.3.6.1:0 - "POST /v1/children/b65a73c4-8de3-404d-b875-90fd93cccb11/events/affirmation HTTP/1.1" 200
2026-01-18 04:41:15 | INFO     | sqlalchemy.engine.Engine | ROLLBACK
2026-01-18 04:41:16 | INFO     | sqlalchemy.engine.Engine | BEGIN (implicit)
2026-01-18 04:41:16 | INFO     | sqlalchemy.engine.Engine | SELECT children.created_at, children.updated_at, children.id, children.owner_sub, children.name, children.birthday, children.interests, children.avatar_id 
FROM children 
WHERE children.id = $1::UUID AND children.owner_sub = $2::VARCHAR
2026-01-18 04:41:16 | INFO     | sqlalchemy.engine.Engine | [cached since 684.8s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), 'fb84a374-66ee-4698-b7ba-f1334bb61d0f')
2026-01-18 04:41:16 | INFO     | mybuddy.api | build_dashboard: start child_id=b65a73c4-8de3-404d-b875-90fd93cccb11
2026-01-18 04:41:16 | INFO     | sqlalchemy.engine.Engine | SELECT child_activity_events.kind, count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID GROUP BY child_activity_events.kind
2026-01-18 04:41:16 | INFO     | sqlalchemy.engine.Engine | [cached since 684.6s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'),)
2026-01-18 04:41:16 | INFO     | sqlalchemy.engine.Engine | SELECT coalesce(sum(child_activity_events.points), $1::INTEGER) AS coalesce_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $2::UUID
2026-01-18 04:41:16 | INFO     | sqlalchemy.engine.Engine | [cached since 684.6s ago] (0, UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'))
2026-01-18 04:41:16 | INFO     | mybuddy.api | progress_totals: child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 totalPoints=75 counts={'affirmation': 8, 'chore': 1, 'outdoor': 1}
2026-01-18 04:41:16 | INFO     | sqlalchemy.engine.Engine | SELECT child_activity_events.kind, count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.created_at >= $2::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $3::TIMESTAMP WITH TIME ZONE GROUP BY child_activity_events.kind
2026-01-18 04:41:16 | INFO     | sqlalchemy.engine.Engine | [cached since 684.6s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:41:16 | INFO     | sqlalchemy.engine.Engine | SELECT coalesce(sum(child_activity_events.points), $1::INTEGER) AS coalesce_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $2::UUID AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE
2026-01-18 04:41:16 | INFO     | sqlalchemy.engine.Engine | [cached since 684.6s ago] (0, UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:41:16 | INFO     | sqlalchemy.engine.Engine | SELECT count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.kind = $2::VARCHAR AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE AND child_activity_events.correct = true
2026-01-18 04:41:16 | INFO     | sqlalchemy.engine.Engine | [cached since 684.6s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), 'flashcard', datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:41:16 | INFO     | mybuddy.api | progress_today: child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 date=2026-01-17 counts={'affirmation': 8, 'chore': 1, 'outdoor': 1} flash_correct=0 totalPoints=75
2026-01-18 04:41:16 | INFO     | sqlalchemy.engine.Engine | SELECT coalesce(sum(child_activity_events.points), $1::INTEGER) AS coalesce_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $2::UUID AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE
2026-01-18 04:41:16 | INFO     | sqlalchemy.engine.Engine | [cached since 684.6s ago] (0, UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), datetime.datetime(2026, 1, 11, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:41:16 | INFO     | sqlalchemy.engine.Engine | SELECT count(DISTINCT ((child_activity_events.created_at AT TIME ZONE 'America/New_York')::date)) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.created_at >= $2::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $3::TIMESTAMP WITH TIME ZONE
2026-01-18 04:41:16 | INFO     | sqlalchemy.engine.Engine | [cached since 682.9s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), datetime.datetime(2026, 1, 11, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:41:16 | INFO     | sqlalchemy.engine.Engine | SELECT child_activity_events.kind, count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.created_at >= $2::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $3::TIMESTAMP WITH TIME ZONE GROUP BY child_activity_events.kind
2026-01-18 04:41:16 | INFO     | sqlalchemy.engine.Engine | [cached since 684.7s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), datetime.datetime(2026, 1, 11, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:41:16 | INFO     | sqlalchemy.engine.Engine | SELECT count(child_activity_events.id) AS count_1 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.kind = $2::VARCHAR AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE AND child_activity_events.correct = true
2026-01-18 04:41:16 | INFO     | sqlalchemy.engine.Engine | [cached since 684.6s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), 'flashcard', datetime.datetime(2026, 1, 11, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:41:16 | INFO     | mybuddy.api | progress_week: child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 weekStart=2026-01-11 counts={'affirmation': 8, 'chore': 1, 'outdoor': 1} flash_correct=0 accuracyPct=0 totalPoints=75 daysActive=1
2026-01-18 04:41:16 | INFO     | sqlalchemy.engine.Engine | SELECT DISTINCT child_activity_events.chore_id 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.kind = $2::VARCHAR AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE AND child_activity_events.chore_id IS NOT NULL
2026-01-18 04:41:16 | INFO     | sqlalchemy.engine.Engine | [cached since 682.9s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), 'chore', datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:41:16 | INFO     | sqlalchemy.engine.Engine | SELECT DISTINCT child_activity_events.outdoor_activity_id 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.kind = $2::VARCHAR AND child_activity_events.created_at >= $3::TIMESTAMP WITH TIME ZONE AND child_activity_events.created_at < $4::TIMESTAMP WITH TIME ZONE AND child_activity_events.outdoor_activity_id IS NOT NULL
2026-01-18 04:41:16 | INFO     | sqlalchemy.engine.Engine | [cached since 682.9s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), 'outdoor', datetime.datetime(2026, 1, 17, 5, 0, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 18, 5, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:41:16 | INFO     | sqlalchemy.engine.Engine | SELECT children.created_at, children.updated_at, children.id, children.owner_sub, children.name, children.birthday, children.interests, children.avatar_id 
FROM children 
WHERE children.id = $1::UUID
2026-01-18 04:41:16 | INFO     | sqlalchemy.engine.Engine | [cached since 684.7s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'),)
2026-01-18 04:41:16 | INFO     | sqlalchemy.engine.Engine | SELECT age_ranges.id, age_ranges.code, age_ranges.name, age_ranges.min_age, age_ranges.max_age, age_ranges.is_active 
FROM age_ranges 
WHERE age_ranges.min_age <= $1::INTEGER AND (age_ranges.max_age IS NULL OR age_ranges.max_age >= $2::INTEGER) AND age_ranges.is_active = true
2026-01-18 04:41:16 | INFO     | sqlalchemy.engine.Engine | [cached since 684.7s ago] (8, 8)
2026-01-18 04:41:16 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code 
FROM subjects JOIN subject_age_ranges ON subjects.id = subject_age_ranges.subject_id 
WHERE subject_age_ranges.age_range_id = $1::UUID ORDER BY subjects.code
2026-01-18 04:41:16 | INFO     | sqlalchemy.engine.Engine | [cached since 684.7s ago] (UUID('1aea8d41-8a9a-4631-a8d7-b8ef59d74bfc'),)
2026-01-18 04:41:16 | INFO     | sqlalchemy.engine.Engine | SELECT difficulty_thresholds.code, difficulty_thresholds.threshold 
FROM difficulty_thresholds 
WHERE difficulty_thresholds.is_active = true
2026-01-18 04:41:16 | INFO     | sqlalchemy.engine.Engine | [cached since 684.7s ago] ()
2026-01-18 04:41:16 | INFO     | mybuddy.api | difficulty_thresholds: child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 thresholds={'easy': 0, 'medium': 25, 'hard': 50, 'impossible': 100}
2026-01-18 04:41:16 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code AS subject_code, count(child_activity_events.id) AS completed, coalesce(sum(CASE WHEN (child_activity_events.correct = true) THEN $1::INTEGER ELSE $2::INTEGER END), $3::INTEGER) AS correct 
FROM child_activity_events JOIN subjects ON subjects.id = child_activity_events.subject_id 
WHERE child_activity_events.child_id = $4::UUID AND child_activity_events.kind = $5::VARCHAR GROUP BY subjects.code
2026-01-18 04:41:16 | INFO     | sqlalchemy.engine.Engine | [cached since 684.7s ago] (1, 0, 0, UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), 'flashcard')
2026-01-18 04:41:16 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code, child_subject_streaks.current_streak, child_subject_streaks.longest_streak 
FROM child_subject_streaks JOIN subjects ON subjects.id = child_subject_streaks.subject_id 
WHERE child_subject_streaks.child_id = $1::UUID
2026-01-18 04:41:16 | INFO     | sqlalchemy.engine.Engine | [cached since 684.7s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'),)
2026-01-18 04:41:16 | INFO     | sqlalchemy.engine.Engine | SELECT subjects.code, child_subject_difficulty.difficulty_code 
FROM child_subject_difficulty JOIN subjects ON subjects.id = child_subject_difficulty.subject_id 
WHERE child_subject_difficulty.child_id = $1::UUID
2026-01-18 04:41:16 | INFO     | sqlalchemy.engine.Engine | [cached since 684.7s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'),)
2026-01-18 04:41:16 | INFO     | mybuddy.api | subject_difficulty_map: child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 diff_map={'math': 'easy', 'science': 'easy', 'reading': 'easy', 'history': 'easy'}
2026-01-18 04:41:16 | INFO     | mybuddy.api | dashboard_flashcards_by_subject: child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 by_subject={'history': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 0, 'longestStreak': 0}, 'math': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 0, 'longestStreak': 0}, 'reading': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 0, 'longestStreak': 0}, 'science': {'difficultyCode': 'easy', 'nextDifficultyAtStreak': 25, 'correctStreak': 0, 'longestStreak': 0}}
2026-01-18 04:41:16 | INFO     | sqlalchemy.engine.Engine | SELECT DISTINCT ((child_activity_events.created_at AT TIME ZONE 'America/New_York')::date) AS d 
FROM child_activity_events 
WHERE child_activity_events.child_id = $1::UUID AND child_activity_events.created_at >= $2::TIMESTAMP WITH TIME ZONE ORDER BY d DESC
2026-01-18 04:41:16 | INFO     | sqlalchemy.engine.Engine | [cached since 684.7s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'), datetime.datetime(2025, 7, 21, 4, 0, tzinfo=datetime.timezone.utc))
2026-01-18 04:41:16 | INFO     | sqlalchemy.engine.Engine | SELECT level_thresholds.id, level_thresholds.name, level_thresholds.threshold, level_thresholds.icon, level_thresholds.color, level_thresholds.is_active 
FROM level_thresholds 
WHERE level_thresholds.is_active = true
2026-01-18 04:41:16 | INFO     | sqlalchemy.engine.Engine | [cached since 684.8s ago] ()
2026-01-18 04:41:16 | INFO     | mybuddy.api | build_dashboard: loaded child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 core_subjects=['history', 'math', 'reading', 'science'] by_subject_keys=['history', 'math', 'reading', 'science'] totalPoints=75
2026-01-18 04:41:16 | INFO     | sqlalchemy.engine.Engine | SELECT child_balanced_progress_counters.id, child_balanced_progress_counters.child_id, child_balanced_progress_counters.subject_code, child_balanced_progress_counters.correct_count, child_balanced_progress_counters.updated_at 
FROM child_balanced_progress_counters 
WHERE child_balanced_progress_counters.child_id = $1::UUID
2026-01-18 04:41:16 | INFO     | sqlalchemy.engine.Engine | [cached since 682.9s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'),)
2026-01-18 04:41:16 | INFO     | sqlalchemy.engine.Engine | SELECT child_progress.child_id, child_progress.total_points, child_progress.total_flashcards, child_progress.total_chores, child_progress.total_outdoor, child_progress.total_affirmations, child_progress.current_streak, child_progress.longest_streak, child_progress.last_active_date, child_progress.last_seen_at, child_progress.current_level, child_progress.subject_counts 
FROM child_progress 
WHERE child_progress.child_id = $1::UUID
2026-01-18 04:41:16 | INFO     | sqlalchemy.engine.Engine | [cached since 684.8s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'),)
2026-01-18 04:41:16 | INFO     | sqlalchemy.engine.Engine | SELECT achievements.code, child_achievements.unlocked_at 
FROM achievements JOIN child_achievements ON child_achievements.achievement_id = achievements.id 
WHERE child_achievements.child_id = $1::UUID
2026-01-18 04:41:16 | INFO     | sqlalchemy.engine.Engine | [cached since 682.9s ago] (UUID('b65a73c4-8de3-404d-b875-90fd93cccb11'),)
2026-01-18 04:41:16 | INFO     | sqlalchemy.engine.Engine | SELECT achievements.created_at, achievements.updated_at, achievements.id, achievements.code, achievements.title, achievements.description, achievements.icon, achievements.achievement_type, achievements.points_threshold, achievements.streak_days_threshold, achievements.flashcards_count_threshold, achievements.chores_count_threshold, achievements.outdoor_count_threshold, achievements.is_active 
FROM achievements
2026-01-18 04:41:16 | INFO     | sqlalchemy.engine.Engine | [cached since 684.7s ago] ()
2026-01-18 04:41:16 | INFO     | mybuddy.api | build_dashboard: end child_id=b65a73c4-8de3-404d-b875-90fd93cccb11 unlocked=2 locked=18
2026-01-18 04:41:16 | INFO     | uvicorn.access | 10.3.6.1:0 - "GET /v1/children/b65a73c4-8de3-404d-b875-90fd93cccb11/dashboard HTTP/1.1" 200
2026-01-18 04:41:16 | INFO     | sqlalchemy.engine.Engine | ROLLBACK
